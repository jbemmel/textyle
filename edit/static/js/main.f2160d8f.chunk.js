(this.webpackJsonptextyle=this.webpackJsonptextyle||[]).push([[1],{77:function(e,t,r){},78:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(1),c=r.n(a),i=r(21),s=r.n(i),o=r(5),l="[TILESET] Add one",u="[TILESET] Load existing textures",d="[TILESET] Texture loading complete",h="[TILESET] Select",b="[TILESET] Delete",f="[TILE] Select",v="[TOOL] Select",x="[LAYER] Add one",j="[LAYER] Delete",p="[LAYER] Select",m="[LAYER] Move",g="[LAYER] Toggle Visibility",O=function(e){return{type:h,payload:{name:e}}},y=function(e){return{type:v,payload:{tool:e}}},w=function(e,t,r,n,a){return{type:x,payload:{name:e,x:t,y:r,width:n,height:a}}},L=function(e){return{type:p,payload:{name:e}}},T=r(32),E=r(12),I=r.n(E),C="DEFAULT_TOOL",k="PLACEMENT_TOOL",N="ERASER_TOOL",S="FILL_TOOL",A="PAN_TOOL",R="MAGNIFY_TOOL",M="tiles",z="map",P="import",_="save",U="settings",F="help",D=new Map;D.set(C,"default tool"),D.set(k,"placement tool"),D.set(N,"erase tool"),D.set(S,"fill tool"),D.set(A,"pan tool"),D.set(R,"zoom"),D.set(M,"tab tiles"),D.set(z,"tab map"),D.set(P,"tab import"),D.set(_,"tab export"),D.set(U,"settings tab"),D.set(F,"help tab");var Z=D,B="lastSelectedTileset",V=function(e){var t=e.iconPath,r=e.tool,a=Object(o.c)(),c=Object(o.d)((function(e){return e.canvas.selectedTool})),i=r===c?"text-green-400 hover:text-green-500":"hover:text-green-500 cursor-pointer";return Object(n.jsxs)("button",{className:"px-3 py-2 cursor-default",role:"button","data-testid":r===c?"selected-tool":"",children:[Object(n.jsx)("div",{className:i,onClick:function(){a(y(r))},"data-tip":!0,"data-for":r,"data-testid":r,children:Object(n.jsx)(I.a,{path:t,size:.68})}),Object(n.jsx)(T.a,{id:r,place:"bottom",effect:"solid",delayShow:600,children:Z.get(r)})]})},X="border-gray-600",Y="h-7",H=r(7),W=function(){return Object(n.jsx)("nav",{className:"flex flex-row items-stretch border-b border-r bg-almost-black ".concat(X," ").concat("h-7"),children:Object(n.jsxs)("div",{className:"flex flex-row justify-start items-center flex-grow",children:[Object(n.jsx)(V,{iconPath:H.c,tool:C}),Object(n.jsx)(V,{iconPath:H.o,tool:k}),Object(n.jsx)(V,{iconPath:H.e,tool:N}),Object(n.jsx)(V,{iconPath:H.n,tool:S}),Object(n.jsx)(V,{iconPath:H.h,tool:A}),Object(n.jsx)(V,{iconPath:H.j,tool:R})]})})},G=r(18),K=r(10),q=r(16),J=r(20),Q=r(4),$={tilesetNames:[],selectedTileset:"",selectedTile:-1,hasLoadedTextures:!1},ee={selectedTool:C},te=r(47),re=r(46),ne=r(27),ae={selected:"",names:[],layers:{},lastIdx:0},ce=Object(q.c)({tileset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u:var r=t.payload.names;return Object(Q.a)(Object(Q.a)({},e),{},{tilesetNames:r});case d:return Object(Q.a)(Object(Q.a)({},e),{},{hasLoadedTextures:!0});case l:var n=t.payload.name;return Object(Q.a)(Object(Q.a)({},e),{},{tilesetNames:[].concat(Object(J.a)(e.tilesetNames),[n]),selectedTileset:n});case h:var a=t.payload.name;return Object(Q.a)(Object(Q.a)({},e),{},{selectedTileset:a});case b:var c=t.payload.name,i=e.tilesetNames.filter((function(e){return e!==c})),s=e.selectedTileset;if(s===c&&i.length>0){var o=Math.max(e.tilesetNames.indexOf(c)-1,0);s=i[o]}else 0==i.length&&(s="");return Object(Q.a)(Object(Q.a)({},e),{},{selectedTileset:s,tilesetNames:i});case f:var v=t.payload.value;return Object(Q.a)(Object(Q.a)({},e),{},{selectedTile:v});default:return e}},canvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:var r=t.payload.tool;return Object(Q.a)(Object(Q.a)({},e),{},{selectedTool:r});default:return e}},layers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:var r=t.payload.name;return r||(r="Layer ".concat(e.lastIdx+1)),Object(Q.a)(Object(Q.a)({},e),{},{names:[].concat(Object(J.a)(e.names),[r]),layers:Object(Q.a)(Object(Q.a)({},e.layers),{},Object(ne.a)({},r,{id:e.lastIdx,visible:!0})),selected:r,lastIdx:e.lastIdx+1});case j:var n=t.payload.name,a=e.layers,c=(a[n],Object(te.a)(a,[n].map(re.a))),i=e.names.filter((function(e){return e!==n})),s=e.selected;if(s===n&&i.length>0){var o=Math.max(e.names.indexOf(n)-1,0);s=i[o]}else 0===i.length&&(s="");return Object(Q.a)(Object(Q.a)({},e),{},{names:i,layers:c,selected:s});case p:var l=t.payload.name;return Object(Q.a)(Object(Q.a)({},e),{},{selected:l});case m:var u=t.payload,d=u.name,h=u.to,b=e.names.indexOf(d),f=e.names;return-1!==b&&(f.splice(b,1),f.splice(h,0,d)),Object(Q.a)(Object(Q.a)({},e),{},{names:f});case g:var v=t.payload.name;return Object(Q.a)(Object(Q.a)({},e),{},{layers:Object(Q.a)(Object(Q.a)({},e.layers),{},Object(ne.a)({},v,Object(Q.a)(Object(Q.a)({},e.layers[v]),{},{visible:!e.layers[v].visible})))});default:return e}}}),ie=r(6),se=r.n(ie),oe=r(9),le="json",ue=r(19),de=new ue.a("textures-store","textures"),he=function(){var e=Object(oe.a)(se.a.mark((function e(){var t;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(ue.d)(de);case 3:return t=e.sent,e.abrupt("return",t);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),be=function(){var e=Object(oe.a)(se.a.mark((function e(t){var r;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(ue.c)(t,de);case 3:return r=e.sent,e.abrupt("return",r);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=Object(oe.a)(se.a.mark((function e(t,r){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(ue.e)(t,{file:r,tilesetIndex:Oe.lastId},de);case 3:return e.next=5,Oe.addTiles(t,[32,32]);case 5:localStorage.setItem(B,t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,r){return e.apply(this,arguments)}}(),ve=function(){var e=Object(oe.a)(se.a.mark((function e(t){return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(ue.b)(t,de);case 3:localStorage.getItem(B)===t&&localStorage.removeItem(B),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),xe=function(){var e=Object(oe.a)(se.a.mark((function e(t){var r;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(ue.d)(de);case 3:return r=e.sent,e.abrupt("return",r.includes(t));case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),je=function(){var e=Object(oe.a)(se.a.mark((function e(t){var r,n,a,c,i;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Oe.lastId>0)){e.next=2;break}return e.abrupt("return");case 2:r=Object(G.a)(t),e.prev=3,r.s();case 5:if((n=r.n()).done){e.next=29;break}return a=n.value,e.prev=7,e.next=10,xe(a);case 10:if(e.sent){e.next=13;break}return e.abrupt("continue",27);case 13:return e.next=15,Oe.addTiles(a,[32,32]);case 15:return c=e.sent,e.next=18,Object(ue.c)(a,de);case 18:return(i=e.sent).tilesetIndex=c,e.next=22,Object(ue.e)(a,i,de);case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(7),console.error(e.t0);case 27:e.next=5;break;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(3),r.e(e.t1);case 34:return e.prev=34,r.f(),e.finish(34);case 37:Ee.dispatch({type:d,payload:{}});case 38:case"end":return e.stop()}}),e,null,[[3,31,34,37],[7,24]])})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=Object(oe.a)(se.a.mark((function e(t){var r;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be(t);case 3:if((r=e.sent).file){e.next=6;break}return e.abrupt("return",null);case 6:return e.abrupt("return",createImageBitmap(r.file));case 9:return e.prev=9,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),me=function(e,t,r){r=r||[0,0];var n=e.target.getBoundingClientRect();Math.floor(e.target.width/t[0]);return[Math.floor((e.pageX+r[0]-n.left)/t[0]),Math.floor((e.pageY+r[1]-n.top)/t[1])]},ge=function(e,t,r){if(t[0]>=r[0]||t[1]>=r[1])return[[0,0],[0,0],[0,0],[0,0]];var n=1*t[0]/r[0],a=1*t[1]/r[1],c=Math.floor(r[0]/t[0]),i=Math.floor(r[1]/t[1]),s=c*i,o=Math.floor(e%c),l=Math.floor(e%s/c),u=o*(r[0]/c)*1/r[0],d=l*(r[1]/i)/r[1];return[[u,d],[u+n,d],[u+n,d+a],[u,d+a]]},Oe=new function e(){var t=this;Object(K.a)(this,e),this.addTiles=function(){var e=Object(oe.a)(se.a.mark((function e(r,n){var a,c,i,s,o,l,u;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe(r);case 2:for(a=e.sent,c=Math.floor(a.width/n[0]),i=Math.floor(a.height/n[1]),s=t.lastId,o=0;o<i;o++)for(l=0;l<c;l++)u=ge(o*c+l,n,[a.width,a.height]),t.tiles[t.lastId]={size:n,tileset:r,uv:u},++t.lastId;return e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),this.get=function(e){return e<0||e>=t.tiles.length?null:t.tiles[e]},this.tiles=[],this.lastId=0},ye=function(){var e=Object(oe.a)(se.a.mark((function e(){var t,r,n,a,c,i,s,o,l,u,d,h,b,f,v,x,j,p;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t={}).map={},(r=Ee.getState()).layers&&r.layers.layers){e.next=6;break}return console.error("There are no layers in the current project."),e.abrupt("return",JSON.stringify(t));case 6:n=r.layers.names,a=r.layers.layers,t.map.layers=[],c=Object(G.a)(n);try{for(c.s();!(i=c.n()).done;){for(s=i.value,o=a[s],10,10,0,0,(l={}).name=s,l.width=Le.layerWidth(o.id),l.height=Le.layerHeight(o.id),l.x=Le.layerX(o.id),l.y=Le.layerY(o.id),l.data=[],u=0;u<10;u++)for(d=0;d<10;d++)h=Le.get(d,u,o.id),l.data.push(h);t.map.layers.push(l)}}catch(m){c.e(m)}finally{c.f()}b=r.tileset.tilesetNames,t.tilesets=[],f=Object(G.a)(b),e.prev=14,f.s();case 16:if((v=f.n()).done){e.next=27;break}return x=v.value,(j={}).name=x,e.next=22,be(x);case 22:p=e.sent,j.tileIndex=p.tilesetIndex,t.tilesets.push(j);case 25:e.next=16;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(14),f.e(e.t0);case 32:return e.prev=32,f.f(),e.finish(32);case 35:return t.tiles=Oe.tiles,e.abrupt("return",JSON.stringify(t));case 37:case"end":return e.stop()}}),e,null,[[14,29,32,35]])})));return function(){return e.apply(this,arguments)}}(),we=new function e(){var t=this;Object(K.a)(this,e),this.init=function(){var e=Object(oe.a)(se.a.mark((function e(n,a){var c,i;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([r.e(0),r.e(4)]).then(r.bind(null,82));case 3:return t.wasm=e.sent,e.next=6,r.e(0).then(r.bind(null,80));case 6:c=e.sent,i=c.memory,t.map=t.wasm.Tilemap.new(),t.memory=i,t.hasInitialized=!0,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("[x] Error loading grid: ".concat(e.t0.message));case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,r){return e.apply(this,arguments)}}(),this.width=function(){return t.map.width()},this.height=function(){return t.map.height()},this.addLayer=function(e,r,n,a){e&&r||(e=0,r=0),n&&a||(n=we.width(),a=we.height()),t.map.add_layer(e,r,n,a)},this.get=function(e,r,n){return t.map.get(e,r,n)},this.set=function(e,r,n,a){t.map.set(e,r,n,a)},this.fill=function(e,r,n,a){t.map.fill(e,r,n,a)},this.layerWidth=function(e){return t.map.layer_width(e)},this.layerHeight=function(e){return t.map.layer_height(e)},this.layerX=function(e){return t.map.layer_x(e)},this.layerY=function(e){return t.map.layer_y(e)},this.export=function(e){switch(e){case le:return ye();default:return null}},this.hasInitialized=!1},Le=we,Te=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||q.d,Ee=Object(q.e)(ce,Te(Object(q.a)((function(e){return function(e){return function(t){switch(t.type){case x:var r=t.payload||{},n=r.x,a=r.y,c=r.width,i=r.height;Le.addLayer(n,a,c,i)}return e(t)}}}),(function(e){return function(e){return function(t){switch(t.type){case l:var r=t.payload||{},n=r.name,a=r.data;fe(n,a);break;case u:var c=(t.payload||{}).names;je(c);break;case b:var i=(t.payload||{}).name;ve(i)}return e(t)}}})))),Ie=function e(t,r,n){var a=this;Object(K.a)(this,e),this.init=function(){var e=a.createShader(a.vertexSource,a.gl.VERTEX_SHADER),t=a.createShader(a.fragmentSource,a.gl.FRAGMENT_SHADER);a.id=a.gl.createProgram(),a.gl.attachShader(a.id,e),a.gl.attachShader(a.id,t),a.gl.linkProgram(a.id),a.gl.getProgramParameter(a.id,a.gl.LINK_STATUS)||console.error("Unable to initialize the shader program: "+a.gl.getProgramInfoLog(a.id))},this.createShader=function(e,t){var r=a.gl.createShader(t);if(a.gl.shaderSource(r,e),a.gl.compileShader(r),!a.gl.getShaderParameter(r,a.gl.COMPILE_STATUS)){var n=a.gl.getShaderInfoLog(r);console.error("Could not compile shader: "+n)}return r},this.use=function(){a.gl.useProgram(a.id)},this.setMat4=function(e,t){a.gl.uniformMatrix4fv(a.gl.getUniformLocation(a.id,e),!1,t)},this.setInt=function(e,t){a.gl.uniform1i(a.gl.getUniformLocation(a.id,e),t)},this.gl=t,this.vertexSource=r,this.fragmentSource=n,this.init()},Ce=r(30),ke=function e(t,r){var n=this;Object(K.a)(this,e),this.init=function(e){n.id=e.createTexture(),e.bindTexture(e.TEXTURE_2D,n.id),n.width=1,n.height=1;var t=new Uint8Array([0,0,0,0]);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,t),pe(n.idbKey).then((function(t){t&&(n.width=t.width,n.height=t.height,e.bindTexture(e.TEXTURE_2D,n.id),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST))}))},this.bind=function(e){e.bindTexture(e.TEXTURE_2D,n.id)},this.idbKey=r,this.id=null,this.width=0,this.height=0,this.init(t)},Ne=function(){function e(){var t=this;Object(K.a)(this,e),this.add=function(e,r){t.indexMap.set(r,t.map.size),t.map.set(r,new ke(e,r))},this.map=new Map,this.indexMap=new Map}return Object(Ce.a)(e,[{key:"get",value:function(e){return this.map.get(e)}},{key:"getIndex",value:function(e){return this.indexMap.get(e)}},{key:"has",value:function(e){return this.map.has(e)}},{key:"remove",value:function(e){this.map.delete(e)}}]),e}(),Se="uMVP",Ae="uSamplers",Re="aPosition",Me="aTextureCoord",ze="aTextureIdx",Pe="aColor",_e="#version 300 es\n\n      in vec2 ".concat(Re,";\n      in float ").concat(ze,";\n      in vec2 ").concat(Me,";\n      in vec4 ").concat(Pe,";\n\n      out vec2 vTextureCoord;\n      out float vTextureIdx;\n      out vec4 vColor;\n\n      uniform mat4 ").concat(Se,";\n\n      void main() {\n        gl_Position = ").concat(Se," * vec4(aPosition, 0.0, 1.0);\n        vTextureCoord = ").concat(Me,";\n        vTextureIdx = ").concat(ze,";\n        vColor = ").concat(Pe,";\n      }\n      "),Ue="#version 300 es\n\n      precision mediump float;\n\n      in vec2 vTextureCoord;\n      in float vTextureIdx;\n      in vec4 vColor;\n\n      out vec4 oColor;\n\n      uniform sampler2D ".concat(Ae,"[11];\n\n      void main() {\n        vec4 finalColor = vec4(0.0);\n        int tid = int(vTextureIdx + 0.5);\n\n        switch (tid)\n        {\n          case 0:\n            finalColor = texture(").concat(Ae,"[0], vTextureCoord);\n            break;\n          case 1:\n            finalColor = texture(").concat(Ae,"[1], vTextureCoord);\n            break;\n          case 2:\n            finalColor = texture(").concat(Ae,"[2], vTextureCoord);\n            break;\n          case 3:\n            finalColor = texture(").concat(Ae,"[3], vTextureCoord);\n            break;\n          case 4:\n            finalColor = texture(").concat(Ae,"[4], vTextureCoord);\n            break;\n          case 5:\n            finalColor = texture(").concat(Ae,"[5], vTextureCoord);\n            break;\n          case 6:\n            finalColor = texture(").concat(Ae,"[6], vTextureCoord);\n            break;\n          case 7:\n            finalColor = texture(").concat(Ae,"[7], vTextureCoord);\n            break;\n          case 8:\n            finalColor = texture(").concat(Ae,"[8], vTextureCoord);\n            break;\n          case 9:\n            finalColor = texture(").concat(Ae,"[9], vTextureCoord);\n            break;\n          case 10:\n            finalColor = texture(").concat(Ae,"[10], vTextureCoord);\n            break;\n        }\n\n        oColor = finalColor;\n      }\n      "),Fe=function e(t,r){var n=this;Object(K.a)(this,e),this.initialize=function(){n.vertices=new Float32Array(36e4),n.indices=function(e){for(var t=0,r=new Uint16Array(e),n=0;n<e;n+=6)r[n]=t,r[n+1]=t+1,r[n+2]=t+2,r[n+3]=t,r[n+4]=t+2,r[n+5]=t+3,t+=4;return r}(6e4),n.VAO=n.gl.createVertexArray(),n.VBO=n.gl.createBuffer(),n.EBO=n.gl.createBuffer(),n.gl.bindVertexArray(n.VAO),n.gl.bindBuffer(n.gl.ARRAY_BUFFER,n.VBO),n.gl.bufferData(n.gl.ARRAY_BUFFER,n.vertices,n.gl.DYNAMIC_DRAW);var e=n.gl.getAttribLocation(n.shaderProgram.id,Re);n.gl.vertexAttribPointer(e,2,n.gl.FLOAT,!1,36,0),n.gl.enableVertexAttribArray(e);var t=n.gl.getAttribLocation(n.shaderProgram.id,Me);n.gl.vertexAttribPointer(t,2,n.gl.FLOAT,!1,36,8),n.gl.enableVertexAttribArray(t);var r=n.gl.getAttribLocation(n.shaderProgram.id,ze);n.gl.vertexAttribPointer(r,1,n.gl.FLOAT,!1,36,16),n.gl.enableVertexAttribArray(r);var a=n.gl.getAttribLocation(n.shaderProgram.id,Pe);n.gl.vertexAttribPointer(a,4,n.gl.FLOAT,!1,36,20),n.gl.enableVertexAttribArray(a),n.gl.bindBuffer(n.gl.ELEMENT_ARRAY_BUFFER,n.EBO),n.gl.bufferData(n.gl.ELEMENT_ARRAY_BUFFER,n.indices,n.gl.STATIC_DRAW),n.vertexIndex=0,n.indexCount=0},this.begin=function(){n.gl.bindBuffer(n.gl.ARRAY_BUFFER,n.VBO)},this.emplace=function(e,t,r){var a=Oe.get(e);if(a){var c=0,i=0,s=0,o=0;r&&(c=r.r,i=r.g,s=r.b,o=r.a);var l=0;n.textureManager.has(a.tileset)||n.textureManager.add(n.gl,a.tileset),l=n.textureManager.getIndex(a.tileset),n.vertices[n.vertexIndex++]=t[0],n.vertices[n.vertexIndex++]=t[1],n.vertices[n.vertexIndex++]=a.uv[0][0],n.vertices[n.vertexIndex++]=a.uv[0][1],n.vertices[n.vertexIndex++]=l,n.vertices[n.vertexIndex++]=c,n.vertices[n.vertexIndex++]=i,n.vertices[n.vertexIndex++]=s,n.vertices[n.vertexIndex++]=o,n.vertices[n.vertexIndex++]=t[0]+a.size[0],n.vertices[n.vertexIndex++]=t[1],n.vertices[n.vertexIndex++]=a.uv[1][0],n.vertices[n.vertexIndex++]=a.uv[1][1],n.vertices[n.vertexIndex++]=l,n.vertices[n.vertexIndex++]=c,n.vertices[n.vertexIndex++]=i,n.vertices[n.vertexIndex++]=s,n.vertices[n.vertexIndex++]=o,n.vertices[n.vertexIndex++]=t[0]+a.size[0],n.vertices[n.vertexIndex++]=t[1]+a.size[1],n.vertices[n.vertexIndex++]=a.uv[2][0],n.vertices[n.vertexIndex++]=a.uv[2][1],n.vertices[n.vertexIndex++]=l,n.vertices[n.vertexIndex++]=c,n.vertices[n.vertexIndex++]=i,n.vertices[n.vertexIndex++]=s,n.vertices[n.vertexIndex++]=o,n.vertices[n.vertexIndex++]=t[0],n.vertices[n.vertexIndex++]=t[1]+a.size[1],n.vertices[n.vertexIndex++]=a.uv[3][0],n.vertices[n.vertexIndex++]=a.uv[3][1],n.vertices[n.vertexIndex++]=l,n.vertices[n.vertexIndex++]=c,n.vertices[n.vertexIndex++]=i,n.vertices[n.vertexIndex++]=s,n.vertices[n.vertexIndex++]=o,n.indexCount+=6}else console.error("Could not get tile data for tile ".concat(a))},this.flush=function(){n.gl.bufferSubData(n.gl.ARRAY_BUFFER,0,n.vertices.subarray(0,n.vertexIndex)),n.vertexIndex=0},this.render=function(){if(0!==n.indexCount){var e=0;n.textureManager.map.forEach((function(t){n.gl.activeTexture(n.gl.TEXTURE0+e),t.bind(n.gl),n.shaderProgram.setInt("".concat(Ae,"[").concat(e,"]"),e),++e})),n.gl.activeTexture(n.gl.TEXTURE0),n.gl.bindVertexArray(n.VAO),n.gl.drawElements(n.gl.TRIANGLES,n.indexCount,n.gl.UNSIGNED_SHORT,0),n.indexCount=0}},this.gl=t,this.shaderProgram=r,this.textureManager=new Ne,this.initialize()},De=r(22),Ze=[.25,.5,.75,1,1.25,1.5,1.75],Be=function e(t,r){var n=this;Object(K.a)(this,e),this.setOrigin=function(e,t){n.origin=[n.position[0],n.position[1]],n.clientOrigin=[e,t]},this.moveTo=function(e,t){n.position=[n.origin[0]+(n.clientOrigin[0]-e),n.origin[1]+(n.clientOrigin[1]-t),n.cameraZ],n.calculateMvp()},this.setZoom=function(e){n.zoom=n.clampZoom(e),n.calculateMvp()},this.applyZoom=function(e){n.zoom+=e,Math.abs(n.zoom)<10||(n.zoom<0?n.zoomLevel=Math.max(0,n.zoomLevel-1):n.zoom>0&&(n.zoomLevel=Math.min(Ze.length-1,n.zoomLevel+1)),n.perceivedWidth=n.width/Ze[n.zoomLevel],n.perceivedHeight=n.height/Ze[n.zoomLevel],n.zoom=0,n.calculateMvp())},this.incrementZoom=function(){n.zoomLevel=Math.min(Ze.length-1,n.zoomLevel+1),n.perceivedWidth=n.width/Ze[n.zoomLevel],n.perceivedHeight=n.height/Ze[n.zoomLevel],n.calculateMvp()},this.decrementZoom=function(){n.zoomLevel=Math.max(0,n.zoomLevel-1),n.perceivedWidth=n.width/Ze[n.zoomLevel],n.perceivedHeight=n.height/Ze[n.zoomLevel],n.calculateMvp()},this.getMvp=function(){return n.mvp},this.getZoomLevel=function(){return Ze[n.zoomLevel]},this.calculateMvp=function(){var e=n.position[0]/Ze[n.zoomLevel],t=n.position[1]/Ze[n.zoomLevel];De.a.ortho(n.projection,e,n.perceivedWidth+e,n.perceivedHeight+t,t,n.near,n.far),De.a.multiply(n.mvp,n.projection,n.modelView)},this.updateViewport=function(e,t){n.width=e,n.height=t,n.perceivedWidth=n.width/Ze[n.zoomLevel],n.perceivedHeight=n.height/Ze[n.zoomLevel],n.calculateMvp()},this.width=t,this.height=r,this.zoomLevel=3,this.zoom=0,this.perceivedWidth=this.width,this.perceivedHeight=this.height,this.origin=[0,0],this.clientOrigin=[0,0],this.cameraZ=80,this.position=[0,0,this.cameraZ],this.near=.1,this.far=100,this.projection=De.a.create(),this.modelView=De.a.create(),this.mvp=De.a.create(),De.a.translate(this.modelView,this.modelView,[0,0,-this.cameraZ]),this.calculateMvp()},Ve=[32,32],Xe=new function e(){var t=this;Object(K.a)(this,e),this.hasInitialized=!1,this.init=function(e){t.gl=e,t.gl&&(t.gl.enable(t.gl.BLEND),t.gl.blendFunc(t.gl.SRC_ALPHA,t.gl.ONE_MINUS_SRC_ALPHA),t.shaderProgram=new Ie(t.gl,_e,Ue),t.shaderProgram.use(),t.camera=new Be(t.gl.canvas.width,t.gl.canvas.height),t.shaderProgram.setMat4(Se,t.camera.getMvp()),t.batch=new Fe(t.gl,t.shaderProgram),t.hasInitialized=!0)},this.setClearColor=function(e,r,n,a){t.gl.clearColor(e,r,n,a)},this.updateViewport=function(e,r){t.camera.updateViewport(e,r)},this.render=function(){t.gl.clear(t.gl.COLOR_BUFFER_BIT),t.renderTilemap(),window.requestAnimationFrame(t.render)},this.renderTilemap=function(){if(Le.hasInitialized){t.shaderProgram.use();var e=t.gl.canvas.width,r=t.gl.canvas.height,n=Ee.getState().layers;t.shaderProgram.setMat4(Se,t.camera.getMvp()),t.batch.begin();var a,c=Object(G.a)(n.names);try{for(c.s();!(a=c.n()).done;){var i=a.value,s=n.layers[i];if(s.visible&&s.id>=0)for(var o=0,l=0;l<r;o++,l+=Ve[1])for(var u=0,d=0;d<e;u++,d+=Ve[0]){var h=Le.get(u,o,s.id);-1!=h&&t.batch.emplace(h,[d,l])}}}catch(b){c.e(b)}finally{c.f()}t.batch.flush(),t.batch.render()}}},Ye=[32,32],He=function(){var e=Object(o.c)(),t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current&&(t.current.width=t.current.clientWidth,t.current.height=t.current.clientHeight,Le.hasInitialized||Le.init().then((function(){e(w(null,0,0,Math.floor(t.current.width/Ye[0])+1,Math.floor(t.current.height/Ye[1])+1))})),Xe.hasInitialized||(Xe.init(t.current.getContext("webgl2")),Xe.setClearColor(31/255,41/255,55/255,1),window.requestAnimationFrame(Xe.render)))}),[e]),Object(n.jsx)("canvas",{id:"tilemap-canvas",ref:t,className:"col-span-full row-span-full z-0 w-full h-full"})},We=[32,32],Ge=function(){var e=Object(o.c)(),t=Object(a.useRef)(),r=Object(o.d)((function(e){return{selectedLayer:e.layers.selected,layers:e.layers.layers}})),c=r.selectedLayer,i=r.layers,s=Object(o.d)((function(e){return e.tileset.selectedTile})),l=Object(o.d)((function(e){return e.canvas.selectedTool}));Object(a.useEffect)((function(){var e=t.current;if(e){window.addEventListener("resize",(function(){e&&Xe.updateViewport(e.clientWidth,e.clientHeight)})),t.current.width=e.clientWidth,t.current.height=e.clientHeight;var r=function(e){return e.preventDefault()};return e.addEventListener("wheel",r,{passive:!1}),function(){e.removeEventListener("wheel",r)}}}),[]),Object(a.useEffect)((function(){var t=function(t){" "===t.key&&e(y(A))},r=function(t){" "===t.key&&e(y(C))};return window.addEventListener("keydown",t),window.addEventListener("keyup",r),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",r)}}),[e]);var u=function(e){var t=Xe.camera.getZoomLevel(),r=me(e,[We[0]*t,We[1]*t],Xe.camera.position),n=i[c].id;switch(l){case C:break;case k:null!==s&&void 0!==s&&-1!==s&&Le.set.apply(Le,Object(J.a)(r).concat([s,n]));break;case N:Le.set.apply(Le,Object(J.a)(r).concat([-1,n]));break;case A:if(0==e.clientX||0==e.clientY)break;Xe.camera.moveTo(e.clientX,e.clientY)}};return Object(n.jsx)("canvas",{id:"editor-canvas",ref:t,onWheel:function(e){e.altKey&&Xe.camera.applyZoom(e.deltaY)},onMouseDown:function(e){c&&i[c]&&(!function(e){switch(l){case S:var t=Xe.camera.getZoomLevel(),r=me(e,[We[0]*t,We[1]*t],Xe.camera.position),n=i[c].id;Le.fill.apply(Le,Object(J.a)(r).concat([s,n]));break;case A:Xe.camera.setOrigin(e.clientX,e.clientY);break;case R:e.altKey?Xe.camera.decrementZoom():Xe.camera.incrementZoom()}}(e),u(e))},onDragOver:function(e){c&&i[c]&&u(e)},draggable:"true",className:"col-span-full row-span-full z-10 w-full h-full"})},Ke=function(){return Object(n.jsxs)("div",{className:"col-span-3 flex flex-col",children:[Object(n.jsx)(W,{}),Object(n.jsxs)("section",{className:"grid flex-1 bg-gray-600",children:[Object(n.jsx)(Ge,{}),Object(n.jsx)(He,{})]})]})},qe=r(24),Je=function(e){var t=e.iconPath,r=e.routerPath;return Object(n.jsx)(qe.b,{to:r,className:"w-full",activeClassName:"".concat("bg-gray-800"," ").concat("text-green-400"),children:Object(n.jsx)("button",{className:"w-full py-3 flex justify-center ".concat("hover:bg-gray-800"," ").concat("hover:text-green-300"),"data-tip":!0,"data-for":r,children:Object(n.jsx)(I.a,{path:t,size:1})})})};function Qe(){return(Qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function $e(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},c=Object.keys(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var et=a.createElement("mask",{id:"path-1-outside-1",maskUnits:"userSpaceOnUse",x:.745167,y:.745174,width:271.529,height:271.529,fill:"black"},a.createElement("rect",{fill:"white",x:.745167,y:.745174,width:271.529,height:271.529}),a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M46 136.51L91.2548 91.2548L91.9619 90.5477L136.51 46L181.057 90.5477L181.764 91.2548L227.019 136.51L181.764 181.765L136.51 136.51L91.2548 181.765L46 136.51Z"})),tt=a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M46 136.51L91.2548 91.2548L91.9619 90.5477L136.51 46L181.057 90.5477L181.764 91.2548L227.019 136.51L181.764 181.765L136.51 136.51L91.2548 181.765L46 136.51Z",fill:"#34D399"}),rt=a.createElement("path",{d:"M46 136.51L23.3726 113.882L0.745167 136.51L23.3726 159.137L46 136.51ZM136.51 46L159.137 23.3726L136.51 0.745174L113.882 23.3726L136.51 46ZM227.019 136.51L249.647 159.137L272.274 136.51L249.647 113.882L227.019 136.51ZM181.764 181.765L159.137 204.392L181.764 227.019L204.392 204.392L181.764 181.765ZM136.51 136.51L159.137 113.882L136.51 91.2548L113.882 113.882L136.51 136.51ZM91.2548 181.765L68.6274 204.392L91.2548 227.019L113.882 204.392L91.2548 181.765ZM68.6274 68.6274L23.3726 113.882L68.6274 159.137L113.882 113.882L68.6274 68.6274ZM69.3345 67.9203L68.6274 68.6274L113.882 113.882L114.589 113.175L69.3345 67.9203ZM113.882 23.3726L69.3345 67.9203L114.589 113.175L159.137 68.6274L113.882 23.3726ZM203.685 67.9203L159.137 23.3726L113.882 68.6274L158.43 113.175L203.685 67.9203ZM158.43 113.175L159.137 113.882L204.392 68.6274L203.685 67.9203L158.43 113.175ZM159.137 113.882L204.392 159.137L249.647 113.882L204.392 68.6274L159.137 113.882ZM204.392 113.882L159.137 159.137L204.392 204.392L249.647 159.137L204.392 113.882ZM204.392 159.137L159.137 113.882L113.882 159.137L159.137 204.392L204.392 159.137ZM113.882 204.392L159.137 159.137L113.882 113.882L68.6274 159.137L113.882 204.392ZM23.3726 159.137L68.6274 204.392L113.882 159.137L68.6274 113.882L23.3726 159.137Z",fill:"#0A0913",mask:"url(#path-1-outside-1)"}),nt=a.createElement("rect",{x:91.2548,y:181.765,width:64,height:64,transform:"rotate(-45 91.2548 181.765)",fill:"#FBFDFC",stroke:"#0A0913",strokeWidth:32});function at(e,t){var r=e.title,n=e.titleId,c=$e(e,["title","titleId"]);return a.createElement("svg",Qe({width:"100%",height:"100%",viewBox:"0 0 273 273",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":n},c),r?a.createElement("title",{id:n},r):null,et,tt,rt,nt)}var ct=a.forwardRef(at),it=(r.p,function(){var e=[{path:M,icon:H.r},{path:z,icon:H.k},{path:P,icon:H.q},{path:_,icon:H.b},{path:U,icon:H.a},{path:F,icon:H.i}].map((function(e){return Object(n.jsxs)("div",{className:"flex","data-testid":e.path,children:[Object(n.jsx)(Je,{routerPath:e.path,iconPath:e.icon}),Object(n.jsx)(T.a,{id:e.path,place:"right",effect:"solid",delayShow:600,children:Z.get(e.path)})]},e.path)}));return Object(n.jsxs)("div",{className:"w-10 flex flex-col justify-end bg-almost-black border-r ".concat(X),children:[Object(n.jsx)("div",{className:"flex-1 flex flex-col justify-start",children:Object(n.jsx)("div",{className:"py-3 px-0.5",children:Object(n.jsx)(ct,{})})}),e]})}),st=function(e){var t=e.children,r=e.title;return Object(n.jsxs)("div",{className:"flex-1 flex flex-col text-sm",children:[Object(n.jsx)("h2",{className:"".concat(Y," bg-almost-black border-b ").concat(X," px-2 flex items-center"),children:r}),t]})},ot=function(e){return e.layers},lt=function(e){return function(e){return ot(e)?ot(e).names:[]}(e).map((function(t){return function(e,t){return ot(e)?Object(Q.a)(Object(Q.a)({},ot(e).layers[t]),{},{name:t}):{}}(e,t)}))},ut=function(e){return lt(e).reverse()},dt=r(14),ht=r(45),bt=function(e){var t=e.title,r=e.children,c=Object(a.useState)(!0),i=Object(dt.a)(c,2),s=i[0],o=i[1],l=s?H.l:H.m,u=s?"border-b ".concat(X):"";return Object(n.jsxs)("div",{className:u,children:[Object(n.jsxs)("div",{className:"text-xs flex items-center hover:bg-gray-800 cursor-pointer border-b ".concat(X," ").concat(Y),onDoubleClick:function(e){return o(!s)},children:[Object(n.jsx)(I.a,{path:l,size:1}),Object(n.jsx)("h1",{className:"select-none",children:t})]}),Object(n.jsx)(ht.Collapse,{isOpened:s,children:Object(n.jsx)("div",{className:"text-xs text-gray-300 px-2 py-2",children:r})})]})},ft=r(28),vt=function(e){var t=e.layer,r=e.index,a=e.isSelected,c=Object(o.c)(),i=function(){c(L(t.name))},s=function(){var e;c((e=t.name,{type:g,payload:{name:e}}))},l=t.visible?H.f:H.g,u=a?"bg-gray-700 hover:text-white":"bg-gray-800 hover:bg-gray-900",d=t.visible?"layer-visible":"layer-hidden";return Object(n.jsx)("div",{className:"border-t border-gray-700 first:border-t-0",children:Object(n.jsx)(ft.b,{draggableId:t.name,index:r,children:function(e,r){var a=Object(Q.a)({cursor:"default"},e.draggableProps.style);return Object(n.jsxs)("li",Object(Q.a)(Object(Q.a)(Object(Q.a)({className:"flex items-center select-none ".concat(u),ref:e.innerRef},e.draggableProps),e.dragHandleProps),{},{style:a,"data-testid":d,children:[Object(n.jsx)("span",{className:"flex-1 pl-4 py-1",onClick:i,children:t.name}),Object(n.jsx)("span",{onClick:s,className:"cursor-pointer pr-4 py-1 hover:text-white","data-testid":"hide-layer-button",children:Object(n.jsx)(I.a,{path:l,size:.6})})]}))}})})},xt=function(e){var t=e.selectedLayer,r=Object(o.c)();return Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("div",{className:"flex items-center justify-start mt-1",children:[Object(n.jsx)("button",{onClick:function(){r(w())},"data-testid":"add-layer-button",className:"hover:text-white",children:Object(n.jsx)(I.a,{path:H.p,size:.7})}),Object(n.jsx)("button",{onClick:function(){},className:"hover:text-white",children:Object(n.jsx)(I.a,{path:H.a,size:.6})}),Object(n.jsx)("button",{onClick:function(){r({type:j,payload:{name:t}})},"data-testid":"delete-layer-button",className:"hover:text-white",children:Object(n.jsx)(I.a,{path:H.d,size:.65})})]})})},jt=function(){var e=Object(o.c)(),t=Object(o.d)((function(e){return{selectedLayer:e.layers.selected,layers:ut(e)}})),r=t.selectedLayer,a=t.layers,c=a.map((function(e,t){return Object(n.jsx)(vt,{index:t,layer:e,isSelected:e.name===r},e.name)})),i=a&&a.length?Object(n.jsx)(ft.a,{onDragEnd:function(t){var r,n;e((r=t.draggableId,n=a.length-t.destination.index-1,{type:m,payload:{name:r,to:n}}))},onBeforeDragStart:function(t){e(L(t.draggableId))},children:Object(n.jsx)(ft.c,{droppableId:"layers",children:function(e){return Object(n.jsxs)("ul",Object(Q.a)(Object(Q.a)({},e.droppableProps),{},{ref:e.innerRef,className:"border rounded-sm border-gray-700",children:[c,e.placeholder]}))}})}):Object(n.jsx)("div",{});return Object(n.jsxs)(bt,{title:"Layers",children:[i,Object(n.jsx)(xt,{selectedLayer:r})]})},pt=function(e){var t=e.selectable,r=e.tileSize,c=Object(o.c)(),i=Object(o.d)((function(e){return e.tileset.selectedTileset})),s=Object(a.useState)([-1,-1]),l=Object(dt.a)(s,2),u=l[0],d=l[1],h=Object(a.useState)(0),b=Object(dt.a)(h,2),v=b[0],x=b[1],j=Object(a.useRef)(null),p=Object(a.useRef)(null);Object(a.useEffect)((function(){if(i&&""!==i&&j.current&&p.current){var e=p.current,t=j.current;be(i).then((function(n){var a=new FileReader;a.onload=function(a){var c=new Image;c.onload=function(){e.width=c.width,e.height=c.height,t.width=c.width,t.height=c.height,e.getContext("2d").drawImage(c,0,0),function(e,t){var r=e.getContext("2d");r.strokeStyle="#dddddd",r.lineWidth=1;for(var n=t[0];n<e.height;n+=t[0])r.beginPath(),r.moveTo(0,n+.5),r.lineTo(e.width,n+.5),r.stroke();for(var a=t[1];a<e.width;a+=t[1])r.beginPath(),r.moveTo(a+.5,0),r.lineTo(a+.5,e.height),r.stroke()}(e,r),x(n.tilesetIndex)},c.src=a.target.result},a.readAsDataURL(n.file)}))}}),[i,r]),Object(a.useEffect)((function(){if(j.current){var e=j.current,t=e.getContext("2d");t.fillStyle="rgba(79, 70, 229, 0.4)",t.clearRect(0,0,e.width,e.height),t.fillRect(u[0]*r[0]+1,u[1]*r[1]+1,r[0]-1,r[1]-1)}}),[u,r]);return""===i?Object(n.jsx)("div",{}):Object(n.jsx)(n.Fragment,{children:Object(n.jsx)("div",{className:"max-h-40 max-w-full overflow-scroll border inline-block rounded-sm mt-2",children:Object(n.jsxs)("div",{className:"grid",children:[Object(n.jsx)("canvas",{id:"grid-canvas",onMouseUp:function(e){if(t){var n=me(e,r),a=v+n[1]*Math.floor(e.target.width/r[0])+n[0];c({type:f,payload:{value:a}}),d(n)}},ref:j,className:"col-span-full row-span-full z-10 overflow-hidden"}),Object(n.jsx)("canvas",{id:"tileset-canvas",ref:p,className:"col-span-full row-span-full z-0 overflow-hidden"})]})})})},mt=function(e){var t=e.value,r=e.options,a=e.onChange;return Object(n.jsx)("select",{className:"text-gray-400 w-full px-1 py-1 bg-gray-800 hover:bg-gray-700 hover:text-white border border-gray-700 rounded-sm",value:t,onChange:a,"data-testid":"select-tag",children:r})},gt=function(){var e=Object(o.c)(),t=Object(o.d)((function(e){return e.tileset})),r=t.selectedTileset,c=t.tilesetNames;Object(a.useEffect)((function(){var t=localStorage.getItem(B);t&&""!==t?e(O(t)):localStorage.setItem(B,"")}),[e]);var i,s=[],l=Object(G.a)(c);try{for(l.s();!(i=l.n()).done;){var u=i.value;s.push(Object(n.jsx)("option",{value:u,"data-testid":u,children:u},u))}}catch(d){l.e(d)}finally{l.f()}return c.length>0&&Object(n.jsx)(mt,{value:r,options:s,onChange:function(t){var r=t.target.value;localStorage.setItem(B,r),e(O(r))}})},Ot=function(e){var t=e.text,r=e.onClick;return Object(n.jsx)("div",{className:"cursor-pointer block bg-green-600 hover:bg-green-700 active:bg-green-800 px-1 py-2 flex items-center text-center rounded-sm w-full",onClick:r,children:Object(n.jsx)("p",{className:"flex-1 text-white",children:t})})},yt=function(e){e.title;var t=e.onUpload;return Object(n.jsxs)("div",{children:[Object(n.jsx)("input",{type:"file",name:"tilesetFile",id:"tilesetFile",min:"1",max:"100",value:"",onChange:t,style:{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:"-1"}}),Object(n.jsx)("label",{htmlFor:"tilesetFile",className:"block ",children:Object(n.jsx)(Ot,{text:"Choose a file..."})})]})},wt=r(31),Lt=r.n(wt),Tt=function(e){var t=e.children,r=e.open,a=e.title,c=e.onClose;return Object(n.jsxs)(Lt.a,{isOpen:r,contentLabel:a,onRequestClose:c,style:{overlay:{backgroundColor:"rgba(0,0,0,0.6)",zIndex:"19"},content:{backgroundColor:"rgb(17, 24, 39)",borderRadius:"0.25rem",borderColor:"rgb(75, 85, 99)",color:"rgb(249, 250, 251)",top:"50%",left:"50%",right:"0",bottom:"0",transform:"translate(-50%, -50%)",zIndex:"20",padding:"1rem",height:"max-content",width:"max-content"}},children:[Object(n.jsx)("h1",{children:a}),Object(n.jsx)("div",{className:"text-xs",children:t})]})},Et=function(e){var t=e.open,r=e.onClose,c=Object(a.useState)(32),i=Object(dt.a)(c,2),s=i[0],o=i[1],l=Object(a.useState)(32),u=Object(dt.a)(l,2),d=u[0],h=u[1];return Object(n.jsxs)(Tt,{title:"Tileset Settings",open:t,onClose:r,children:[Object(n.jsxs)("form",{className:"mb-2",children:[Object(n.jsxs)("label",{children:["Tile dimensions (px):",Object(n.jsx)("br",{})]}),Object(n.jsxs)("div",{className:"mt-2",children:[Object(n.jsx)("input",{type:"number",value:s,onChange:function(e){o(e.target.value)},className:"w-14 mr-1"}),Object(n.jsx)("input",{type:"number",value:d,onChange:function(e){h(e.target.value)},className:"w-14 ml-1"})]})]}),Object(n.jsx)(pt,{selectable:!1,tileSize:[parseInt(s),parseInt(d)]}),Object(n.jsxs)("div",{className:"flex mt-2",children:[Object(n.jsx)("span",{className:"w-full mr-1",children:Object(n.jsx)(Ot,{text:"Update",onClick:function(){r&&r()}})}),Object(n.jsx)("span",{className:"w-full ml-1",children:Object(n.jsx)(Ot,{text:"Cancel",onClick:r})})]})]})},It=function(e){var t=e.selectedTileset,r=Object(o.c)(),c=Object(a.useState)(!1),i=Object(dt.a)(c,2),s=i[0],l=i[1];return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{className:"flex items-center justify-start",children:[Object(n.jsx)("button",{onClick:function(){l(!0)},className:"hover:text-white",children:Object(n.jsx)(I.a,{path:H.a,size:.6})}),Object(n.jsx)("button",{onClick:function(){r({type:b,payload:{name:t}})},className:"hover:text-white",children:Object(n.jsx)(I.a,{path:H.d,size:.65})})]}),Object(n.jsx)(Et,{open:s,onClose:function(){l(!1)}})]})},Ct=[32,32],kt=function(){var e=Object(o.c)(),t=(Object(o.d)((function(e){return e.tileset.tilesetNames})),Object(o.d)((function(e){return e.tileset.hasLoadedTextures}))),r=Object(o.d)((function(e){return e.tileset.selectedTileset}));Object(a.useEffect)((function(){he().then((function(t){e({type:u,payload:{names:t}})}))}),[]);var c=function(){var t=Object(oe.a)(se.a.mark((function t(r){return se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r.target.files.length<=0)&&r.target.files[0]){t.next=2;break}return t.abrupt("return");case 2:e((n=r.target.files[0].name,a=r.target.files[0],{type:l,payload:{name:n,data:a}}));case 3:case"end":return t.stop()}var n,a}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(n.jsx)(bt,{title:"Tileset",children:t?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(gt,{}),Object(n.jsx)("div",{className:"mt-2",children:Object(n.jsx)(yt,{title:"Add Tileset",onUpload:function(e){return c(e)}})}),Object(n.jsx)(pt,{selectable:!0,tileSize:Ct}),r&&Object(n.jsx)(It,{selectedTileset:r})]}):Object(n.jsx)("div",{})})},Nt=function(){return Object(n.jsxs)(st,{title:"Edit",children:[Object(n.jsx)(jt,{}),Object(n.jsx)(kt,{})]})};function St(e){return Object(n.jsxs)("div",{children:[Object(n.jsx)("p",{children:Object(n.jsx)("strong",{children:e.title})}),Object(n.jsxs)("span",{children:[e.value,"px"]}),Object(n.jsx)("input",{type:"range",min:"1",max:"100",value:e.value,onChange:e.onChange})]})}var At=function(e){var t=Object(a.useState)(32),r=Object(dt.a)(t,2),c=r[0],i=r[1];return Object(n.jsx)(st,{title:"Map Settings",children:Object(n.jsx)(St,{title:"Tile size",onChange:function(e){return i(e.target.value)},value:c})})},Rt=function(){return Object(n.jsx)(st,{title:"Import",children:Object(n.jsx)("h3",{children:"Import"})})},Mt=function(e){var t=e.format,r=e.onOptionSelected,a=[le,"tmx"].map((function(e){return Object(n.jsx)("option",{value:e,children:e},e)}));return Object(n.jsx)(mt,{value:t,options:a,onChange:r})},zt=function(){var e=Object(a.useState)(le),t=Object(dt.a)(e,2),r=t[0],c=t[1],i=function(){var e=Object(oe.a)(se.a.mark((function e(){var t,n,a,c;return se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le.export(r);case 2:t=e.sent,n="tilemap."+r,a=new Blob([t],{type:"application/json"}),(c=document.createElement("a")).href=URL.createObjectURL(a),c.download=n,c.click();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.jsxs)(st,{title:"Export Map",children:[Object(n.jsx)(Mt,{format:r,onOptionSelected:function(e){c(e.target.value)}}),Object(n.jsx)(Ot,{text:"Export",onClick:i})]})},Pt=function(){return Object(n.jsxs)(st,{title:"Project Settings",children:[Object(n.jsx)("label",{htmlFor:"show-grid",children:"Show grid"}),Object(n.jsx)("input",{type:"checkbox",name:"show-grid"})]})},_t=function(){return Object(n.jsx)(st,{title:"Help"})},Ut=r(8),Ft=function(){return Object(n.jsxs)("aside",{className:"flex flex-row bg-gray-900 border-r border-b ".concat(X),children:[Object(n.jsx)(it,{}),Object(n.jsxs)(Ut.c,{children:[Object(n.jsx)(Ut.a,{path:"/".concat(M),children:Object(n.jsx)(Nt,{})}),Object(n.jsx)(Ut.a,{path:"/".concat(z),children:Object(n.jsx)(At,{})}),Object(n.jsx)(Ut.a,{path:"/".concat(P),children:Object(n.jsx)(Rt,{})}),Object(n.jsx)(Ut.a,{path:"/".concat(_),children:Object(n.jsx)(zt,{})}),Object(n.jsx)(Ut.a,{path:"/".concat(U),children:Object(n.jsx)(Pt,{})}),Object(n.jsx)(Ut.a,{path:"/".concat(F),children:Object(n.jsx)(_t,{})})]})]})},Dt=function(){return Object(n.jsx)("div",{className:"h-screen w-screen flex flex-col bg-gray-900 border-l border-t ".concat(X," text-gray-100"),children:Object(n.jsxs)("main",{className:"flex-1 grid grid-cols-4 grid-rows-1",children:[Object(n.jsx)(qe.a,{children:Object(n.jsx)(Ft,{})}),Object(n.jsx)(Ke,{})]})})};r(77);Lt.a.setAppElement("#root"),s.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(o.a,{store:Ee,children:Object(n.jsx)(Dt,{})})}),document.getElementById("root"))}},[[78,2,3]]]);
//# sourceMappingURL=main.f2160d8f.chunk.js.map