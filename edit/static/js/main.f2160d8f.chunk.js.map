{"version":3,"sources":["redux/actionTypes.js","redux/actions.js","resources/tools.js","resources/tabs.js","resources/tooltips.js","ui/constants.js","ui/canvas/Tool.jsx","resources/testIds.js","resources/styles.js","ui/canvas/Toolbar.jsx","redux/reducers/tileset.js","redux/reducers/canvas.js","redux/reducers/layers.js","redux/reducers/index.js","resources/formats.js","idbTextureStore.js","utils/file.js","utils/tile.js","renderer/TileManager.js","utils/export/exportJson.js","tilemap/index.js","redux/store.js","redux/middlewares.js","renderer/Shader.js","renderer/Texture.js","renderer/TextureManager.js","renderer/constants.js","renderer/Batch2D.js","renderer/Camera.js","renderer/Renderer.js","ui/canvas/WebGLCanvas.jsx","ui/canvas/EditorCanvas.jsx","ui/canvas/Canvas.jsx","ui/sidebar/TabButton.jsx","resources/logo.svg","ui/sidebar/TabSelector.jsx","ui/common/Tab.jsx","redux/selectors.js","ui/common/CollapseTab.jsx","ui/sidebar/tileset/LayerListItem.jsx","ui/sidebar/tileset/LayerListFooter.jsx","ui/sidebar/tileset/LayerList.jsx","ui/sidebar/tileset/TilesetPreview.jsx","ui/common/Select.jsx","ui/sidebar/tileset/TilesetSelector.jsx","ui/common/Button.jsx","ui/common/FileInput.jsx","ui/common/Modal.jsx","ui/sidebar/tileset/TilesetSettingsModal.jsx","ui/sidebar/tileset/TilesetFooter.jsx","ui/sidebar/tileset/TilesetSettings.jsx","ui/sidebar/tileset/Edit.jsx","ui/common/SliderInput.jsx","ui/sidebar/map/MapSettings.jsx","ui/sidebar/import/ImportSettings.jsx","ui/sidebar/export/FormatSelector.jsx","ui/sidebar/export/ExportSettings.jsx","ui/sidebar/project/ProjectSettings.jsx","ui/sidebar/Help.jsx","ui/sidebar/Sidebar.jsx","ui/App.jsx","index.jsx"],"names":["ADD_TILESET","LOAD_EXISTING_TILESETS","COMPLETE_TEXTURE_LOADING","SELECT_TILESET","DELETE_TILESET","SELECT_TILE","SELECT_TOOL","ADD_LAYER","DELETE_LAYER","SELECT_LAYER","MOVE_LAYER","TOGGLE_LAYER_VISIBILITY","selectTileset","name","type","payload","selectTool","tool","addLayer","x","y","width","height","selectLayer","DEFAULT_TOOL","PLACEMENT_TOOL","ERASER_TOOL","FILL_TOOL","PAN_TOOL","MAGNIFY_TOOL","TAB_TILES","TAB_MAP","TAB_IMPORT","TAB_EXPORT","TAB_SETTINGS","TAB_HELP","tooltips","Map","set","tools","tabs","LOCAL_STORAGE_LAST_SELECTED_TILESET","Tool","iconPath","dispatch","useDispatch","selectedTool","useSelector","state","canvas","iconClasses","className","role","data-testid","onClick","data-tip","data-for","path","size","id","place","effect","delayShow","get","dividerBorderColor","titleBarHeight","Toolbar","mdiCursorDefaultOutline","mdiPencil","mdiEraser","mdiPail","mdiHandRight","mdiMagnify","initialState","tilesetNames","selectedTileset","selectedTile","hasLoadedTextures","selected","names","layers","lastIdx","combineReducers","tileset","action","newTilesetNames","filter","n","newSelected","length","idx","Math","max","indexOf","value","visible","newLayers","newIds","to","from","reorderedNames","splice","FORMAT_JSON","textureStore","Store","getTextureNames","a","keys","textureNames","console","error","getTextureData","data","setTextureData","file","tilesetIndex","TileManagerInstance","lastId","addTiles","localStorage","setItem","deleteTextureData","del","getItem","removeItem","hasTexture","textureKeys","includes","loadTilesFromExistingTilesets","tilesets","reduxStore","getImageBitmap","fileData","createImageBitmap","getTilePositionOnClick","e","tileSize","offset","bounds","target","getBoundingClientRect","floor","pageX","left","pageY","top","getTileUV","frame","frameSize","textureSize","frameWidth","frameHeight","hFrames","vFrames","maxFrames","frameX","frameY","topLeftX","topLeftY","textureKey","bitmap","tileIndex","i","j","uv","tiles","tile","this","exportJson","exportObject","getState","JSON","stringify","layerNames","layerName","layer","layerObj","TilemapInstance","layerWidth","layerHeight","layerX","layerY","push","tilesetName","tilesetObj","init","wasm","memory","map","Tilemap","new","hasInitialized","message","add_layer","layerId","fill","targetValue","layer_width","layer_height","layer_x","layer_y","export","format","formats","composeEnhancer","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","rootReducer","applyMiddleware","next","ShaderProgram","gl","vertexSource","fragmentSource","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","info","getShaderInfoLog","use","useProgram","setMat4","uniformName","uniformMatrix4fv","getUniformLocation","setInt","uniform1i","Texture","idbKey","createTexture","bindTexture","TEXTURE_2D","pixel","Uint8Array","texImage2D","RGBA","UNSIGNED_BYTE","then","texParameteri","TEXTURE_WRAP_S","REPEAT","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","bind","TextureManager","add","indexMap","has","delete","UNIFORM_MVP","UNIFORM_SAMPLERS","ATTRIB_POSITION","ATTRIB_TEXTURE_COORD","ATTRIB_TEXTURE_IDX","ATTRIB_COLOR","BATCH_VERTEX_SHADER_SOURCE","BATCH_FRAGMENT_SHADER_SOURCE","Batch2D","shaderProgram","initialize","vertices","Float32Array","maxSprites","indices","indicesSize","Uint16Array","createIndices","VAO","createVertexArray","VBO","createBuffer","EBO","bindVertexArray","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","locPosition","getAttribLocation","vertexAttribPointer","FLOAT","enableVertexAttribArray","locTextureCoord","locTextureIdx","locColor","ELEMENT_ARRAY_BUFFER","STATIC_DRAW","vertexIndex","indexCount","begin","emplace","tileValue","position","color","tileData","r","g","b","textureIdx","textureManager","getIndex","flush","bufferSubData","subarray","render","forEach","texture","activeTexture","TEXTURE0","drawElements","TRIANGLES","UNSIGNED_SHORT","zoomLevels","Camera","setOrigin","origin","clientOrigin","moveTo","cameraZ","calculateMvp","setZoom","zoom","clampZoom","applyZoom","abs","zoomLevel","min","perceivedWidth","perceivedHeight","incrementZoom","decrementZoom","getMvp","mvp","getZoomLevel","computedPositionX","computedPositionY","mat4","ortho","projection","near","far","multiply","modelView","updateViewport","create","translate","RendererInstance","enable","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","camera","batch","setClearColor","clearColor","clear","COLOR_BUFFER_BIT","renderTilemap","requestAnimationFrame","canvasWidth","canvasHeight","layersState","WebGLCanvas","tilesCanvasRef","useRef","useEffect","current","clientWidth","clientHeight","getContext","ref","EditorCanvas","editingCanvasRef","selectedLayer","refElement","addEventListener","cancelWheel","event","preventDefault","passive","removeEventListener","panToolStartHandler","key","panToolEndHandler","handleContinuousTools","undefined","clientX","clientY","onWheel","altKey","deltaY","onMouseDown","handleOneTimeTools","onDragOver","draggable","Canvas","TabButton","routerPath","activeClassName","_extends","Object","assign","arguments","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","maskUnits","fillRule","clipRule","d","mask","transform","stroke","strokeWidth","SvgLogo","_ref","svgRef","title","titleId","props","viewBox","xmlns","ForwardRef","TabSelector","sections","icon","mdiViewModule","mdiMap","mdiUpload","mdiContentSave","mdiCog","mdiHelpCircleOutline","section","Tab","children","getLayersState","getLayers","getLayersNames","getLayerByName","getLayersByAddedTime","reverse","CollapseSection","useState","open","setOpen","mdiMenuDown","mdiMenuRight","sectionClass","onDoubleClick","isOpened","LayerItem","index","isSelected","handleLayerClick","handleEyeClick","mdiEye","mdiEyeOffOutline","selectedClassName","visibilityTestId","draggableId","provided","snapshop","style","cursor","draggableProps","innerRef","dragHandleProps","LayerListFooter","mdiPlaylistPlus","mdiDelete","LayerList","layerComponents","l","LayerListItem","dndArea","onDragEnd","destination","onBeforeDragStart","droppableId","droppableProps","placeholder","TilesetPreview","selectable","setSelectedTile","setTilesetIndex","tilegridCanvasRef","tilesetCanvasRef","tilesetCanvas","tilegridCanvas","reader","FileReader","onload","image","Image","drawImage","tileDimensions","context","strokeStyle","lineWidth","beginPath","lineTo","drawGridLines","src","result","readAsDataURL","fillStyle","clearRect","fillRect","onMouseUp","tilePos","Select","options","onChange","TilesetSelector","lastSelectedTileset","Button","text","FileInput","onUpload","opacity","overflow","zIndex","htmlFor","Modal","onClose","isOpen","contentLabel","onRequestClose","overlay","backgroundColor","content","borderRadius","borderColor","right","bottom","padding","TilesetSettingsModal","tileWidth","setTileWidth","tileHeight","setTileHeight","parseInt","TilesetFooter","showTilesetSettings","setShowTilesetSettings","TilesetManager","textures","onTilesetUpload","files","Edit","TilesetSettings","SliderInput","MapSettings","setTileSize","ImportSettings","FormatSelector","onOptionSelected","formatOptions","ExportSettings","setFormat","handleExport","rawData","filename","blob","Blob","document","createElement","href","URL","createObjectURL","download","click","ProjectSettings","Help","Sidebar","App","ReactModal","setAppElement","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.f2160d8f.chunk.js","sourcesContent":["export const ADD_TILESET = \"[TILESET] Add one\";\nexport const LOAD_EXISTING_TILESETS = \"[TILESET] Load existing textures\";\nexport const COMPLETE_TEXTURE_LOADING = \"[TILESET] Texture loading complete\";\nexport const SELECT_TILESET = \"[TILESET] Select\";\nexport const DELETE_TILESET = \"[TILESET] Delete\";\nexport const SELECT_TILE = \"[TILE] Select\";\n\nexport const SELECT_TOOL = \"[TOOL] Select\";\n\nexport const ADD_LAYER = \"[LAYER] Add one\";\nexport const DELETE_LAYER = \"[LAYER] Delete\";\nexport const SELECT_LAYER = \"[LAYER] Select\";\nexport const MOVE_LAYER = \"[LAYER] Move\";\nexport const TOGGLE_LAYER_VISIBILITY = \"[LAYER] Toggle Visibility\";\n","import {\n  ADD_TILESET,\n  LOAD_EXISTING_TILESETS,\n  COMPLETE_TEXTURE_LOADING,\n  SELECT_TILESET,\n  DELETE_TILESET,\n  SELECT_TILE,\n  SELECT_TOOL,\n  ADD_LAYER,\n  DELETE_LAYER,\n  SELECT_LAYER,\n  MOVE_LAYER,\n  TOGGLE_LAYER_VISIBILITY,\n} from \"redux/actionTypes\";\n\nexport const addTileset = (name, data) => ({\n  type: ADD_TILESET,\n  payload: { name, data },\n});\n\nexport const loadExistingTilesets = (names) => ({\n  type: LOAD_EXISTING_TILESETS,\n  payload: { names },\n});\n\nexport const completeTextureLoading = (names) => ({\n  type: COMPLETE_TEXTURE_LOADING,\n  payload: {},\n});\n\nexport const selectTileset = (name) => ({\n  type: SELECT_TILESET,\n  payload: { name },\n});\n\nexport const deleteTileset = (name) => ({\n  type: DELETE_TILESET,\n  payload: { name },\n});\n\nexport const selectTile = (value) => ({\n  type: SELECT_TILE,\n  payload: { value },\n});\n\nexport const selectTool = (tool) => ({\n  type: SELECT_TOOL,\n  payload: { tool },\n});\n\nexport const addLayer = (name, x, y, width, height) => ({\n  type: ADD_LAYER,\n  payload: { name, x, y, width, height },\n});\n\nexport const deleteLayer = (name) => ({\n  type: DELETE_LAYER,\n  payload: { name },\n});\n\nexport const selectLayer = (name) => ({\n  type: SELECT_LAYER,\n  payload: { name },\n});\n\nexport const moveLayer = (name, to) => ({\n  type: MOVE_LAYER,\n  payload: { name, to },\n});\n\nexport const toggleLayerVisibility = (name) => ({\n  type: TOGGLE_LAYER_VISIBILITY,\n  payload: { name },\n});\n","export const DEFAULT_TOOL = \"DEFAULT_TOOL\";\nexport const PLACEMENT_TOOL = \"PLACEMENT_TOOL\";\nexport const ERASER_TOOL = \"ERASER_TOOL\";\nexport const FILL_TOOL = \"FILL_TOOL\";\nexport const PAN_TOOL = \"PAN_TOOL\";\nexport const MAGNIFY_TOOL = \"MAGNIFY_TOOL\";\n","export const TAB_TILES = \"tiles\";\nexport const TAB_MAP = \"map\";\nexport const TAB_IMPORT = \"import\";\nexport const TAB_EXPORT = \"save\";\nexport const TAB_SETTINGS = \"settings\";\nexport const TAB_HELP = \"help\";\n","import * as tools from \"resources/tools\";\nimport * as tabs from \"resources/tabs\";\n\nconst tooltips = new Map();\n\ntooltips.set(tools.DEFAULT_TOOL, \"default tool\");\ntooltips.set(tools.PLACEMENT_TOOL, \"placement tool\");\ntooltips.set(tools.ERASER_TOOL, \"erase tool\");\ntooltips.set(tools.FILL_TOOL, \"fill tool\");\ntooltips.set(tools.PAN_TOOL, \"pan tool\");\ntooltips.set(tools.MAGNIFY_TOOL, \"zoom\");\n\ntooltips.set(tabs.TAB_TILES, \"tab tiles\");\ntooltips.set(tabs.TAB_MAP, \"tab map\");\ntooltips.set(tabs.TAB_IMPORT, \"tab import\");\ntooltips.set(tabs.TAB_EXPORT, \"tab export\");\ntooltips.set(tabs.TAB_SETTINGS, \"settings tab\");\ntooltips.set(tabs.TAB_HELP, \"help tab\");\n\nexport default tooltips;\n","export const TILEMAP_CANVAS_ID = \"tilemap-canvas\";\nexport const EDITOR_CANVAS_ID = \"editor-canvas\";\nexport const GRID_CANVAS_ID = \"grid-canvas\";\nexport const TILESET_CANVAS_ID = \"tileset-canvas\";\nexport const LOCAL_STORAGE_LAST_SELECTED_TILESET = \"lastSelectedTileset\";\n\nexport const ADD_TILESET_TITLE = \"Add Tileset\";\n\nexport const GRID_COLOR = \"#dddddd\";\nexport const SELECTED_TILE_COLOR_OVERLAY = \"rgba(79, 70, 229, 0.4)\";\n\nexport const TOOLTIP_DELAY = 600;\nexport const TOOLBAR_ICON_SIZE = 0.68;\n","import { connect, useDispatch, useSelector } from \"react-redux\";\nimport { selectTool } from \"redux/actions\";\nimport ReactTooltip from \"react-tooltip\";\nimport Icon from \"@mdi/react\";\nimport tooltips from \"resources/tooltips\";\nimport * as testIds from \"resources/testIds\";\nimport { TOOLTIP_DELAY, TOOLBAR_ICON_SIZE } from \"ui/constants\";\n\nconst Tool = ({ iconPath, tool }) => {\n  const dispatch = useDispatch();\n  const selectedTool = useSelector((state) => state.canvas.selectedTool);\n\n  const handleOnClick = () => {\n    dispatch(selectTool(tool));\n  };\n\n  const iconClasses =\n    tool === selectedTool ? \"text-green-400 hover:text-green-500\" : \"hover:text-green-500 cursor-pointer\";\n  return (\n    <button\n      className=\"px-3 py-2 cursor-default\"\n      role=\"button\"\n      data-testid={tool === selectedTool ? testIds.SELECTED_TOOL : \"\"}\n    >\n      <div className={iconClasses} onClick={handleOnClick} data-tip data-for={tool} data-testid={tool}>\n        <Icon path={iconPath} size={TOOLBAR_ICON_SIZE} />\n      </div>\n      <ReactTooltip id={tool} place=\"bottom\" effect=\"solid\" delayShow={TOOLTIP_DELAY}>\n        {tooltips.get(tool)}\n      </ReactTooltip>\n    </button>\n  );\n};\n\nexport default Tool;\n","export const SELECTED_TOOL = \"selected-tool\";\nexport const SELECT_TAG = \"select-tag\";\nexport const ADD_LAYER_BUTTON = \"add-layer-button\";\nexport const DELETE_LAYER_BUTTON = \"delete-layer-button\";\nexport const HIDE_LAYER_BUTTON = \"hide-layer-button\";\nexport const LAYER_VISIBLE = \"layer-visible\";\nexport const LAYER_HIDDEN = \"layer-hidden\";\n","export const dividerBorderColor = \"border-gray-600\";\nexport const titleBarHeight = \"h-7\";\nexport const toolbarHeight = titleBarHeight;\nexport const accentColor = 'bg-gray-800';\nexport const accentHoverColor = 'hover:bg-gray-800';\nexport const accentTextColor = 'text-green-400';\nexport const accentTextHoverColor = 'hover:text-green-300';\n","import React from \"react\";\nimport Tool from \"ui/canvas/Tool\";\nimport { toolbarColor, dividerBorderColor, toolbarHeight } from \"resources/styles\";\nimport { mdiPencil, mdiEraser, mdiPail, mdiCursorDefaultOutline, mdiHandRight, mdiMagnify } from \"@mdi/js\";\nimport * as tools from \"resources/tools\";\n\nconst Toolbar = () => {\n  return (\n    <nav className={`flex flex-row items-stretch border-b border-r bg-almost-black ${dividerBorderColor} ${toolbarHeight}`}>\n      <div className=\"flex flex-row justify-start items-center flex-grow\">\n        <Tool iconPath={mdiCursorDefaultOutline} tool={tools.DEFAULT_TOOL} />\n        <Tool iconPath={mdiPencil} tool={tools.PLACEMENT_TOOL} />\n        <Tool iconPath={mdiEraser} tool={tools.ERASER_TOOL} />\n        <Tool iconPath={mdiPail} tool={tools.FILL_TOOL} />\n        <Tool iconPath={mdiHandRight} tool={tools.PAN_TOOL} />\n        <Tool iconPath={mdiMagnify} tool={tools.MAGNIFY_TOOL} />\n      </div>\n    </nav>\n  );\n};\n\nexport default Toolbar;\n","import {\n  ADD_TILESET,\n  LOAD_EXISTING_TILESETS,\n  COMPLETE_TEXTURE_LOADING,\n  SELECT_TILESET,\n  DELETE_TILESET,\n  SELECT_TILE,\n} from \"redux/actionTypes\";\n\nconst initialState = {\n  tilesetNames: [],\n  selectedTileset: \"\",\n  selectedTile: -1,\n  hasLoadedTextures: false,\n};\n\nexport default function (state = initialState, action) {\n  switch (action.type) {\n    case LOAD_EXISTING_TILESETS: {\n      const { names } = action.payload;\n\n      return {\n        ...state,\n        tilesetNames: names,\n      };\n    }\n\n    case COMPLETE_TEXTURE_LOADING: {\n      return {\n        ...state,\n        hasLoadedTextures: true,\n      };\n    }\n\n    case ADD_TILESET: {\n      const { name } = action.payload;\n      return {\n        ...state,\n        tilesetNames: [...state.tilesetNames, name],\n        selectedTileset: name,\n      };\n    }\n\n    case SELECT_TILESET: {\n      const { name } = action.payload;\n      return {\n        ...state,\n        selectedTileset: name,\n      };\n    }\n\n    case DELETE_TILESET: {\n      const { name } = action.payload;\n      const newTilesetNames = state.tilesetNames.filter((n) => n !== name);\n\n      let newSelected = state.selectedTileset;\n\n      // If the selected layer is the layer we are deleting and\n      // it is not the last layer, select a new index.\n      if (newSelected === name && newTilesetNames.length > 0) {\n        const idx = Math.max(state.tilesetNames.indexOf(name) - 1, 0);\n        newSelected = newTilesetNames[idx];\n      } else if (newTilesetNames.length == 0) {\n        newSelected = \"\";\n      }\n\n      return {\n        ...state,\n        selectedTileset: newSelected,\n        tilesetNames: newTilesetNames,\n      };\n    }\n\n    case SELECT_TILE: {\n      const { value } = action.payload;\n      return {\n        ...state,\n        selectedTile: value,\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n","import { SELECT_TOOL } from \"redux/actionTypes\";\n\nimport { DEFAULT_TOOL } from \"resources/tools\";\n\nconst initialState = {\n  selectedTool: DEFAULT_TOOL,\n};\n\nexport default function (state = initialState, action) {\n  switch (action.type) {\n    case SELECT_TOOL: {\n      const { tool } = action.payload;\n      return {\n        ...state,\n        selectedTool: tool,\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n","import { ADD_LAYER, DELETE_LAYER, SELECT_LAYER, MOVE_LAYER, TOGGLE_LAYER_VISIBILITY } from \"redux/actionTypes\";\n\nconst initialState = {\n  selected: \"\",\n  names: [],\n  layers: {},\n  lastIdx: 0,\n};\n\nexport default function (state = initialState, action) {\n  switch (action.type) {\n    case ADD_LAYER: {\n      let { name } = action.payload;\n\n      // If name is not provided, add a default one\n      if (!name) {\n        name = `Layer ${state.lastIdx + 1}`;\n      }\n\n      return {\n        ...state,\n        names: [...state.names, name],\n        layers: {\n          ...state.layers,\n          [name]: {\n            id: state.lastIdx,\n            visible: true,\n          },\n        },\n        selected: name,\n        lastIdx: state.lastIdx + 1,\n      };\n    }\n\n    case DELETE_LAYER: {\n      const { name } = action.payload;\n      const { [name]: value, ...newLayers } = state.layers;\n      const newIds = state.names.filter((id) => id !== name);\n\n      let newSelected = state.selected;\n\n      // If the selected layer is the layer we are deleting and\n      // it is not the last layer, select a new index.\n      if (newSelected === name && newIds.length > 0) {\n        const idx = Math.max(state.names.indexOf(name) - 1, 0);\n        newSelected = newIds[idx];\n      } else if (newIds.length === 0) {\n        newSelected = \"\";\n      }\n\n      return {\n        ...state,\n        names: newIds,\n        layers: newLayers,\n        selected: newSelected,\n      };\n    }\n\n    case SELECT_LAYER: {\n      const { name } = action.payload;\n      return {\n        ...state,\n        selected: name,\n      };\n    }\n\n    case MOVE_LAYER: {\n      const { name, to } = action.payload;\n      const from = state.names.indexOf(name);\n      const reorderedNames = state.names;\n\n      // If the layer exists\n      if (from !== -1) {\n        reorderedNames.splice(from, 1);\n        reorderedNames.splice(to, 0, name);\n      }\n\n      return {\n        ...state,\n        names: reorderedNames,\n      };\n    }\n\n    case TOGGLE_LAYER_VISIBILITY: {\n      const { name } = action.payload;\n      return {\n        ...state,\n        layers: {\n          ...state.layers,\n          [name]: {\n            ...state.layers[name],\n            visible: !state.layers[name].visible,\n          },\n        },\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n","import { combineReducers } from \"redux\";\nimport tileset from \"redux/reducers/tileset\";\nimport canvas from \"redux/reducers/canvas\";\nimport layers from \"redux/reducers/layers\";\n\nexport default combineReducers({ tileset, canvas, layers });\n","export const FORMAT_JSON = \"json\";\nexport const FORMAT_TMX = \"tmx\";\n","import { set, get, del, keys, Store } from \"idb-keyval\";\nimport TileManagerInstance from \"renderer/TileManager\";\nimport { selectTileset } from \"redux/actions\";\nimport { LOCAL_STORAGE_LAST_SELECTED_TILESET } from \"ui/constants\";\nimport reduxStore from \"redux/store\";\nimport { completeTextureLoading } from \"redux/actions\";\n\nconst textureStore = new Store(\"textures-store\", \"textures\");\n\nexport const getTextureNames = async () => {\n  try {\n    const textureNames = await keys(textureStore);\n    return textureNames;\n  } catch (err) {\n    console.error(err);\n    return [];\n  }\n};\n\nexport const getTextureData = async (name) => {\n  try {\n    const data = await get(name, textureStore);\n    return data;\n  } catch (err) {\n    console.error(err);\n    return null;\n  }\n};\n\nexport const setTextureData = async (name, data) => {\n  // TODO: If the texture already exists, choose a new name\n  try {\n    await set(name, { file: data, tilesetIndex: TileManagerInstance.lastId }, textureStore);\n    await TileManagerInstance.addTiles(name, [32, 32]);\n    localStorage.setItem(LOCAL_STORAGE_LAST_SELECTED_TILESET, name);\n  } catch (err) {\n    console.error(err);\n  }\n};\n\nexport const deleteTextureData = async (name) => {\n  try {\n    await del(name, textureStore);\n    const lastSelectedTileset = localStorage.getItem(LOCAL_STORAGE_LAST_SELECTED_TILESET);\n    if (lastSelectedTileset === name) {\n      localStorage.removeItem(LOCAL_STORAGE_LAST_SELECTED_TILESET);\n    }\n  } catch (err) {\n    console.error(err);\n  }\n};\n\nexport const hasTexture = async (name) => {\n  try {\n    const textureKeys = await keys(textureStore);\n    return textureKeys.includes(name);\n  } catch (err) {\n    console.error(err);\n    return false;\n  }\n};\n\nexport const loadTilesFromExistingTilesets = async (tilesets) => {\n  // Return if tiles where already loaded\n  if (TileManagerInstance.lastId > 0) {\n    return;\n  }\n  // Create tiles from textures\n  // Respects order of creation\n  // TODO: replace hardcoded 32 x 32 tile size with a user defined one\n  for (const tileset of tilesets) {\n    try {\n      const textureExists = await hasTexture(tileset);\n      if (!textureExists) {\n        continue;\n      }\n\n      const tilesetIndex = await TileManagerInstance.addTiles(tileset, [32, 32]);\n\n      // Update idb texture with the new index\n      const data = await get(tileset, textureStore);\n      data.tilesetIndex = tilesetIndex;\n      await set(tileset, data, textureStore);\n    } catch (err) {\n      console.error(err);\n    }\n  }\n\n  reduxStore.dispatch(completeTextureLoading());\n};\n","import { getTextureData } from \"idbTextureStore\";\n\nexport const fileToBase64 = (file) => {\n  if (!file) {\n    return null;\n  }\n\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = (error) => reject(error);\n    reader.readAsDataURL(file);\n  });\n};\n\nexport const getImageBitmap = async (name) => {\n  try {\n    const fileData = await getTextureData(name);\n    if (!fileData.file) {\n      return null;\n    }\n\n    return createImageBitmap(fileData.file);\n  } catch (err) {\n    console.error(err);\n    return null;\n  }\n};\n\n//export const getFileName = (fullpath) => {\n//return fullpath.split('\\\\').pop().split('/').pop();\n//}\n\n//const base64ToFile = (data) => {\n//const raw = window.atob(data);\n//const rawLength = raw.length;\n//const bytes = new Uint8Array(rawLength);\n\n//for (let i = 0; i < rawLength; i++) {\n//bytes[i] = raw.charCodeAt(i);\n//}\n\n//return bytes;\n//}\n","export const getTilePositionOnClick = (e, tileSize, offset) => {\n  offset = offset || [0.0, 0.0];\n  const bounds = e.target.getBoundingClientRect();\n  const w = Math.floor(e.target.width / tileSize[0]);\n  const x = Math.floor((e.pageX + offset[0] - bounds.left) / tileSize[0]);\n  const y = Math.floor((e.pageY + offset[1] - bounds.top) / tileSize[1]);\n  return [x, y];\n};\n\nexport const getTileUV = (frame, frameSize, textureSize) => {\n  // TODO: Better handling of out of bounds frame sizes\n  if (frameSize[0] >= textureSize[0] || frameSize[1] >= textureSize[1]) {\n    return [\n      [0.0, 0.0],\n      [0.0, 0.0],\n      [0.0, 0.0],\n      [0.0, 0.0],\n    ];\n  }\n\n  const frameWidth = (frameSize[0] * 1.0) / textureSize[0];\n  const frameHeight = (frameSize[1] * 1.0) / textureSize[1];\n  const hFrames = Math.floor(textureSize[0] / frameSize[0]);\n  const vFrames = Math.floor(textureSize[1] / frameSize[1]);\n  const maxFrames = hFrames * vFrames;\n\n  const frameX = Math.floor(frame % hFrames);\n  const frameY = Math.floor((frame % maxFrames) / hFrames);\n  // Multiply the x coord of the frame in the texture atlas by the normalized value of the width one frame.\n  const topLeftX = (frameX * (textureSize[0] / hFrames) * 1.0) / textureSize[0];\n  // Multiply the y coord of the frame in the tile map by the normalized value of the height one frame.\n  // Invert the value as the y axis is upwards for OpenGL\n  const topLeftY = (frameY * (textureSize[1] / vFrames)) / textureSize[1];\n\n  return [\n    [topLeftX, topLeftY], // top-left\n    [topLeftX + frameWidth, topLeftY], // top-right\n    [topLeftX + frameWidth, topLeftY + frameHeight], // bottom-right\n    [topLeftX, topLeftY + frameHeight], // bottom-left\n  ];\n};\n","/**\n * Manges tile data for the rendering process.\n * @module TileManager\n */\n\nimport { getImageBitmap } from \"utils/file\";\nimport { getTileUV } from \"utils/tile\";\n\n/** A class that manages the data for single tiles. */\nclass TileManager {\n  /**\n   * Creates a TileManager.\n   */\n  constructor() {\n    this.tiles = [];\n    this.lastId = 0;\n  }\n\n  /**\n   * Adds tiles to this.tiles from a tileset.\n   *\n   * @param {string} textureKey - Idb key of the texture containing the tiles.\n   * @param {number[]} tileSize - dimensions of the tile in the texture.\n   * @param {number} tileSize[0] - width of the tile.\n   * @param {number} tileSize[1] - height of the tile.\n   *\n   * @returns {number} - The index in this.tiles of the first tile of the provided texture. This allows getting the remaining indices for a specific texture.\n   */\n  addTiles = async (textureKey, tileSize) => {\n    const bitmap = await getImageBitmap(textureKey);\n    const hFrames = Math.floor(bitmap.width / tileSize[0]);\n    const vFrames = Math.floor(bitmap.height / tileSize[1]);\n    const tileIndex = this.lastId;\n\n    for (let i = 0; i < vFrames; i++) {\n      for (let j = 0; j < hFrames; j++) {\n        const idx = i * hFrames + j;\n        const uv = getTileUV(idx, tileSize, [bitmap.width, bitmap.height]);\n        this.tiles[this.lastId] = {\n          size: tileSize,\n          tileset: textureKey,\n          uv: uv,\n        };\n        ++this.lastId;\n      }\n    }\n\n    return tileIndex;\n  };\n\n  /**\n   * Gets tile data for a specific tile.\n   *\n   * @param {number} tile - Index of the tile in this.tiles to access the data object.\n   *\n   * @returns {Object} - Object containing the tile size, the uv coordinates in the texture and the texture key in the idb store.\n   */\n  get = (tile) => {\n    if (tile < 0 || tile >= this.tiles.length) {\n      return null;\n    }\n\n    return this.tiles[tile];\n  };\n}\n\nconst TileManagerInstance = new TileManager();\n\nexport default TileManagerInstance;\n","import TilemapInstance from \"tilemap\";\nimport TileManagerInstance from \"renderer/TileManager\";\nimport reduxStore from \"redux/store\";\nimport { getTextureData } from \"idbTextureStore\";\n\nconst exportJson = async () => {\n  const exportObject = {};\n  exportObject[\"map\"] = {};\n\n  const state = reduxStore.getState();\n\n  // If layers have not been initialized, don't try to touch them abort exporting\n  if (!state.layers || !state.layers.layers) {\n    console.error(\"There are no layers in the current project.\");\n    return JSON.stringify(exportObject);\n  }\n\n  // ========================\n  // Layer\n  // ========================\n  const layerNames = state.layers.names;\n  const layers = state.layers.layers;\n\n  exportObject[\"map\"][\"layers\"] = [];\n\n  for (const layerName of layerNames) {\n    const layer = layers[layerName];\n    const layerWidth = 10;\n    const layerHeight = 10;\n    const layerX = 0;\n    const layerY = 0;\n    const layerObj = {};\n    layerObj[\"name\"] = layerName;\n\n    layerObj[\"width\"] = TilemapInstance.layerWidth(layer.id);\n    layerObj[\"height\"] = TilemapInstance.layerHeight(layer.id);\n    layerObj[\"x\"] = TilemapInstance.layerX(layer.id);\n    layerObj[\"y\"] = TilemapInstance.layerY(layer.id);\n    layerObj[\"data\"] = [];\n\n    for (let y = 0; y < layerHeight; y++) {\n      for (let x = 0; x < layerWidth; x++) {\n        const value = TilemapInstance.get(x, y, layer.id);\n        layerObj[\"data\"].push(value);\n      }\n    }\n\n    exportObject[\"map\"][\"layers\"].push(layerObj);\n  }\n\n  // ========================\n  // Tileset\n  // ========================\n  const tilesetNames = state.tileset.tilesetNames;\n  exportObject[\"tilesets\"] = [];\n\n  for (const tilesetName of tilesetNames) {\n    const tilesetObj = {};\n\n    // Tileset name\n    tilesetObj[\"name\"] = tilesetName;\n\n    // Tile index:\n    // There's an array containing all tiles from all\n    // tilesets packed together. This index is where the\n    // tiles from this particular tileset start.\n    const data = await getTextureData(tilesetName);\n    tilesetObj[\"tileIndex\"] = data.tilesetIndex;\n\n    exportObject[\"tilesets\"].push(tilesetObj);\n  }\n\n  // ========================\n  // Tiles\n  // ========================\n  exportObject[\"tiles\"] = TileManagerInstance.tiles;\n\n  return JSON.stringify(exportObject);\n};\n\nexport default exportJson;\n","import * as formats from 'resources/formats';\nimport { exportJson } from 'utils/export';\n\nclass Tilemap {\n  constructor() {\n    this.hasInitialized = false;\n  }\n\n  init = async (width, height) => {\n    try {\n      this.wasm = await import('./pkg');\n      const { memory } = await import('./pkg/tilemap_bg');\n      this.map = this.wasm.Tilemap.new();\n      this.memory = memory;\n      this.hasInitialized = true;\n    } catch (err) {\n      console.error(`[x] Error loading grid: ${err.message}`);\n    }\n  }\n\n  width = () => {\n    return this.map.width();\n  }\n\n  height = () => {\n    return this.map.height();\n  }\n\n  addLayer = (x, y, width, height) => {\n    // Set default position to (0,0)\n    if (!x || !y) {\n      x = 0;\n      y = 0;\n    }\n\n    // Set default size to the map size\n    if (!width || !height) {\n      width = TilemapInstance.width();\n      height = TilemapInstance.height();\n    }\n\n    this.map.add_layer(x, y, width, height);\n  }\n\n  get = (x, y, layerId) => {\n    return this.map.get(x, y, layerId);\n  }\n\n  set = (x, y, value, layerId) => {\n    this.map.set(x, y, value, layerId);\n  }\n\n  fill = (x, y, targetValue, layerId) => {\n    this.map.fill(x, y, targetValue, layerId);\n  }\n\n  layerWidth = (layerId) => {\n    return this.map.layer_width(layerId);\n  }\n\n  layerHeight = (layerId) => {\n    return this.map.layer_height(layerId);\n  }\n\n  layerX = (layerId) => {\n    return this.map.layer_x(layerId);\n  }\n\n  layerY = (layerId) => {\n    return this.map.layer_y(layerId);\n  }\n\n  export = (format) => {\n    switch (format) {\n      case formats.FORMAT_JSON:\n        return exportJson();\n      default:\n        return null;\n    }\n  }\n}\n\nconst TilemapInstance = new Tilemap();\nexport default TilemapInstance;\n","import { compose, createStore, applyMiddleware } from \"redux\";\nimport rootReducer from \"redux/reducers\";\nimport { tilemapReduxMiddleware, idbReduxMiddleware } from \"redux/middlewares\";\n\n// Remove Redux Devtools in production\nconst composeEnhancer = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst store = createStore(rootReducer, composeEnhancer(applyMiddleware(tilemapReduxMiddleware, idbReduxMiddleware)));\nexport default store;\n","import TilemapInstance from \"tilemap\";\nimport { setTextureData, deleteTextureData, loadTilesFromExistingTilesets } from \"idbTextureStore\";\nimport { ADD_TILESET, DELETE_TILESET, LOAD_EXISTING_TILESETS, ADD_LAYER, DELETE_LAYER } from \"redux/actionTypes\";\n\nexport const idbReduxMiddleware = (store) => (next) => (action) => {\n  switch (action.type) {\n    case ADD_TILESET: {\n      const { name, data } = action.payload || {};\n      setTextureData(name, data);\n      break;\n    }\n\n    case LOAD_EXISTING_TILESETS: {\n      const { names } = action.payload || {};\n      loadTilesFromExistingTilesets(names);\n      break;\n    }\n\n    case DELETE_TILESET: {\n      const { name } = action.payload || {};\n      deleteTextureData(name);\n      break;\n    }\n\n    default:\n      break;\n  }\n\n  return next(action);\n};\n\nexport const tilemapReduxMiddleware = (store) => (next) => (action) => {\n  switch (action.type) {\n    case ADD_LAYER: {\n      let { x, y, width, height } = action.payload || {};\n      TilemapInstance.addLayer(x, y, width, height);\n      break;\n    }\n\n    case DELETE_LAYER: {\n      // TODO: Implement layer deletion\n      break;\n    }\n\n    default:\n      break;\n  }\n\n  return next(action);\n};\n","/**\n * Handles Shader Programs initialization and manipulation.\n * @module Shader\n */\n\n/** A class that handles WebGL shader programs creation and uniform attribution. */\nclass ShaderProgram {\n  /**\n   * Creates a ShaderProgram.\n   *\n   * @param {WebGLContext} gl - WebGL Context to use the WebGL API.\n   * @param {string} vertexSource - vertex shader source to be compiled.\n   * @param {string} fragmentSource - fragment shader source to be compiled.\n   */\n  constructor(gl, vertexSource, fragmentSource) {\n    this.gl = gl;\n    this.vertexSource = vertexSource;\n    this.fragmentSource = fragmentSource;\n    this.init();\n  }\n\n  /**\n   * Compiles and links the Shader program.\n   */\n  init = () => {\n    const vertexShader = this.createShader(this.vertexSource, this.gl.VERTEX_SHADER);\n    const fragmentShader = this.createShader(this.fragmentSource, this.gl.FRAGMENT_SHADER);\n\n    this.id = this.gl.createProgram();\n    this.gl.attachShader(this.id, vertexShader);\n    this.gl.attachShader(this.id, fragmentShader);\n    this.gl.linkProgram(this.id);\n\n    if (!this.gl.getProgramParameter(this.id, this.gl.LINK_STATUS)) {\n      console.error(\"Unable to initialize the shader program: \" + this.gl.getProgramInfoLog(this.id));\n    }\n  };\n\n  /**\n   * Creates a single WebGL shader.\n   *\n   * @param {string} source - source code of the shader.\n   * @param {number} type - either VERTEX_SHADER or FRAGMENT_SHADER.\n   *\n   * @returns {WebGLShader} A WebGL shader.\n   */\n  createShader = (source, type) => {\n    const shader = this.gl.createShader(type);\n    this.gl.shaderSource(shader, source);\n    this.gl.compileShader(shader);\n\n    if (!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\n      const info = this.gl.getShaderInfoLog(shader);\n      console.error(\"Could not compile shader: \" + info);\n    }\n\n    return shader;\n  }\n\n  /**\n   * Uses the shader program.\n   */\n  use = () => {\n    this.gl.useProgram(this.id);\n  };\n\n  /**\n   * Sets a 4x4 matrix to a uniform in the shader.\n   *\n   * @param {string} uniformName - Name of the uniform in the shader.\n   * @param {mat4} value - 4x4 matrix to be set as uniform value.\n   */\n  setMat4 = (uniformName, value) => {\n    this.gl.uniformMatrix4fv(this.gl.getUniformLocation(this.id, uniformName), false, value);\n  };\n\n  /**\n   * Sets a single integer to a uniform in the shader.\n   *\n   * @param {string} uniformName - Name of the uniform in the shader.\n   * @param {number} value - integer to be set as uniform value.\n   */\n  setInt = (uniformName, value) => {\n    this.gl.uniform1i(this.gl.getUniformLocation(this.id, uniformName), value);\n  };\n}\n\nexport default ShaderProgram;\n","/**\n * Handles raw WebGL Textures.\n * @module Texture\n */\n\nimport { getImageBitmap } from \"utils/file\";\nimport { getTileUV } from \"utils/tile\";\n\n/** A class that handles WebGL texture creation and binding. */\nclass Texture {\n  /**\n   * Creates a Texture.\n   *\n   * @param {WebGLContext} gl - WebGL Context to use the WebGL API.\n   * @param {string} idbKey - Key of the file stored in the idb texture store.\n   */\n  constructor(gl, idbKey) {\n    this.idbKey = idbKey;\n    this.id = null;\n    this.width = 0;\n    this.height = 0;\n    this.init(gl);\n  }\n\n  /**\n   * Initializes a Texture with a file present on the idb.\n   *\n   * @param {WebGLContext} gl - WebGL Context to use the WebGL API.\n   */\n  init = (gl) => {\n    this.id = gl.createTexture();\n\n    gl.bindTexture(gl.TEXTURE_2D, this.id);\n\n    // Initializes the texture as a single pixel to avoid\n    // blocking the main thread while the actual file is reached.\n    this.width = 1;\n    this.height = 1;\n    const pixel = new Uint8Array([0, 0, 0, 0]);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, pixel);\n\n    getImageBitmap(this.idbKey).then((bitmap) => {\n      if (!bitmap) {\n        return;\n      }\n\n      this.width = bitmap.width;\n      this.height = bitmap.height;\n\n      gl.bindTexture(gl.TEXTURE_2D, this.id);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, bitmap);\n\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    });\n  };\n\n  /**\n   * Binds the texture.\n   *\n   * @param {WebGLContext} gl - WebGL Context to use the WebGL API.\n   */\n  bind = (gl) => {\n    gl.bindTexture(gl.TEXTURE_2D, this.id);\n  };\n}\n\nexport default Texture;\n","/**\n * Manages multiple WebGL textures loaded with string keys.\n * @module TextureManager\n */\n\nimport Texture from \"renderer/Texture\";\n\n/** A class that holds a Map to WebGL textures. */\nclass TextureManager {\n  /**\n   * Creates a Texture Manager.\n   */\n  constructor() {\n    this.map = new Map();\n    this.indexMap = new Map();\n  }\n\n  /**\n   * Adds a new Texture to the map.\n   *\n   * @param {WebGLContext} gl - WebGL Context to use the WebGL API.\n   * @param {string} name - Key to assign to the Texture.\n   */\n  add = (gl, name) => {\n    this.indexMap.set(name, this.map.size);\n    this.map.set(name, new Texture(gl, name));\n  };\n\n  /**\n   * Gets Texture from the map.\n   *\n   * @param {string} name - Key previously assigned to the Texture.\n   *\n   * @returns {Texture} - If the key exists, Texture assigned to the key.\n   */\n  get(name) {\n    return this.map.get(name);\n  }\n\n  /**\n   * Gets the index of a Texture in the map.\n   *\n   * @param {string} name - Key previously assigned to the Texture.\n   *\n   * @returns {number} - Index of the Texture in the map.\n   */\n  getIndex(name) {\n    return this.indexMap.get(name);\n  }\n\n  /**\n   * Checks if a Texture with a certain name alreay exists on the map.\n   *\n   * @param {string} name - Key previously assigned to the Texture.\n   *\n   * @returns {bool} - True if the map has the key, false otherwise.\n   */\n  has(name) {\n    return this.map.has(name);\n  }\n\n  /**\n   * Removes a Texture from the map.\n   *\n   * @param {string} name - Key previously assigned to the Texture.\n   */\n  remove(name) {\n    this.map.delete(name);\n  }\n}\n\nexport default TextureManager;\n","/**\n * @file Code, uniforms and attributes used in WebGL shader programs.\n */\n\nexport const UNIFORM_PROJECTION = \"uProjectionMatrix\";\nexport const UNIFORM_MVP = \"uMVP\";\nexport const UNIFORM_SAMPLERS = \"uSamplers\";\n\nexport const ATTRIB_POSITION = \"aPosition\";\nexport const ATTRIB_TEXTURE_COORD = \"aTextureCoord\";\nexport const ATTRIB_TEXTURE_IDX = \"aTextureIdx\";\nexport const ATTRIB_COLOR = \"aColor\";\n\nexport const BATCH_VERTEX_SHADER_SOURCE = `#version 300 es\n\n      in vec2 ${ATTRIB_POSITION};\n      in float ${ATTRIB_TEXTURE_IDX};\n      in vec2 ${ATTRIB_TEXTURE_COORD};\n      in vec4 ${ATTRIB_COLOR};\n\n      out vec2 vTextureCoord;\n      out float vTextureIdx;\n      out vec4 vColor;\n\n      uniform mat4 ${UNIFORM_MVP};\n\n      void main() {\n        gl_Position = ${UNIFORM_MVP} * vec4(aPosition, 0.0, 1.0);\n        vTextureCoord = ${ATTRIB_TEXTURE_COORD};\n        vTextureIdx = ${ATTRIB_TEXTURE_IDX};\n        vColor = ${ATTRIB_COLOR};\n      }\n      `;\n\nexport const BATCH_FRAGMENT_SHADER_SOURCE = `#version 300 es\n\n      precision mediump float;\n\n      in vec2 vTextureCoord;\n      in float vTextureIdx;\n      in vec4 vColor;\n\n      out vec4 oColor;\n\n      uniform sampler2D ${UNIFORM_SAMPLERS}[11];\n\n      void main() {\n        vec4 finalColor = vec4(0.0);\n        int tid = int(vTextureIdx + 0.5);\n\n        switch (tid)\n        {\n          case 0:\n            finalColor = texture(${UNIFORM_SAMPLERS}[0], vTextureCoord);\n            break;\n          case 1:\n            finalColor = texture(${UNIFORM_SAMPLERS}[1], vTextureCoord);\n            break;\n          case 2:\n            finalColor = texture(${UNIFORM_SAMPLERS}[2], vTextureCoord);\n            break;\n          case 3:\n            finalColor = texture(${UNIFORM_SAMPLERS}[3], vTextureCoord);\n            break;\n          case 4:\n            finalColor = texture(${UNIFORM_SAMPLERS}[4], vTextureCoord);\n            break;\n          case 5:\n            finalColor = texture(${UNIFORM_SAMPLERS}[5], vTextureCoord);\n            break;\n          case 6:\n            finalColor = texture(${UNIFORM_SAMPLERS}[6], vTextureCoord);\n            break;\n          case 7:\n            finalColor = texture(${UNIFORM_SAMPLERS}[7], vTextureCoord);\n            break;\n          case 8:\n            finalColor = texture(${UNIFORM_SAMPLERS}[8], vTextureCoord);\n            break;\n          case 9:\n            finalColor = texture(${UNIFORM_SAMPLERS}[9], vTextureCoord);\n            break;\n          case 10:\n            finalColor = texture(${UNIFORM_SAMPLERS}[10], vTextureCoord);\n            break;\n        }\n\n        oColor = finalColor;\n      }\n      `;\n","/**\n * Prepares and renders tile batches.\n * @module Batch2D\n */\n\nimport TextureManager from \"renderer/TextureManager\";\nimport TileManagerInstance from \"renderer/TileManager\";\nimport {\n  ATTRIB_POSITION,\n  ATTRIB_TEXTURE_COORD,\n  ATTRIB_TEXTURE_IDX,\n  ATTRIB_COLOR,\n  UNIFORM_SAMPLERS,\n} from \"renderer/constants\";\n\n/**\n * Creates quads indices to use in an Element Array Buffer.\n *\n * @param {number} indicesSize total number of indices to create.\n *\n * @returns Uint16Array array containing indices values.\n */\nconst createIndices = (indicesSize) => {\n  let offset = 0;\n  let indices = new Uint16Array(indicesSize);\n\n  for (let i = 0; i < indicesSize; i += 6) {\n    indices[i] = offset;\n    indices[i + 1] = offset + 1;\n    indices[i + 2] = offset + 2;\n\n    indices[i + 3] = offset;\n    indices[i + 4] = offset + 2;\n    indices[i + 5] = offset + 3;\n\n    offset += 4;\n  }\n\n  return indices;\n};\n\n/** A class to hold tiles' data and rendering them in batches. */\nexport default class Batch2D {\n  /**\n   * Creates a Batch2D.\n   *\n   * @param {WebGLContext} gl - WebGL Context to use the WebGL API.\n   * @param {Shader} shaderProgram - shader program to use with the batch vertices.\n   */\n  constructor(gl, shaderProgram) {\n    this.gl = gl;\n    this.shaderProgram = shaderProgram;\n    this.textureManager = new TextureManager();\n    this.initialize();\n  }\n\n  /**\n   * Initializes WebGL buffers used when rendering.\n   */\n  initialize = () => {\n    const maxSprites = 10000;\n    const floatsPerVertex = 9;\n    const bytesPerVertex = 4 * floatsPerVertex;\n    const floatsPerSprite = floatsPerVertex * 4;\n    const totalFloats = maxSprites * floatsPerSprite;\n    const indicesSize = 6 * maxSprites;\n\n    this.vertices = new Float32Array(totalFloats);\n    this.indices = createIndices(indicesSize);\n\n    this.VAO = this.gl.createVertexArray();\n    this.VBO = this.gl.createBuffer();\n    this.EBO = this.gl.createBuffer();\n\n    this.gl.bindVertexArray(this.VAO);\n\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.VBO);\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.vertices, this.gl.DYNAMIC_DRAW);\n\n    // Position\n    const locPosition = this.gl.getAttribLocation(this.shaderProgram.id, ATTRIB_POSITION);\n    this.gl.vertexAttribPointer(locPosition, 2, this.gl.FLOAT, false, bytesPerVertex, 0);\n    this.gl.enableVertexAttribArray(locPosition);\n\n    // TextureCoord\n    const locTextureCoord = this.gl.getAttribLocation(this.shaderProgram.id, ATTRIB_TEXTURE_COORD);\n    this.gl.vertexAttribPointer(locTextureCoord, 2, this.gl.FLOAT, false, bytesPerVertex, 2 * 4);\n    this.gl.enableVertexAttribArray(locTextureCoord);\n\n    // TextureIdx\n    const locTextureIdx = this.gl.getAttribLocation(this.shaderProgram.id, ATTRIB_TEXTURE_IDX);\n    this.gl.vertexAttribPointer(locTextureIdx, 1, this.gl.FLOAT, false, bytesPerVertex, 4 * 4);\n    this.gl.enableVertexAttribArray(locTextureIdx);\n\n    // Color\n    const locColor = this.gl.getAttribLocation(this.shaderProgram.id, ATTRIB_COLOR);\n    this.gl.vertexAttribPointer(locColor, 4, this.gl.FLOAT, false, bytesPerVertex, 5 * 4);\n    this.gl.enableVertexAttribArray(locColor);\n\n    this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.EBO);\n    this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER, this.indices, this.gl.STATIC_DRAW);\n\n    // Used for emplacing tiles\n    this.vertexIndex = 0;\n\n    // Used for rendering\n    this.indexCount = 0;\n  };\n\n  /**\n   * Begins process of emplacing tile data to the batch.\n   */\n  begin = () => {\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.VBO);\n  };\n\n  /**\n   * Emplaces a single tile to the batch.\n   *\n   * @param {number} tileValue - numeric representation of a particular tile.\n   * @param {number[]} position - world coordinates of the tile.\n   * @param {number} position[0] - world x coordinate of the tile.\n   * @param {number} position[1] - world y coordinate of the tile.\n   * @param {Object} [color] - RGBA color representation for the tile.\n   * @param {number} [color.r] - Red RGBA color part.\n   * @param {number} [color.g] - Green RGBA color part.\n   * @param {number} [color.b] - Blue RGBA color part.\n   * @param {number} [color.a] - Alpha RGBA color part.\n   */\n  emplace = (tileValue, position, color) => {\n    const tileData = TileManagerInstance.get(tileValue);\n    if (!tileData) {\n      console.error(`Could not get tile data for tile ${tileData}`);\n      return;\n    }\n\n    let r = 0.0;\n    let g = 0.0;\n    let b = 0.0;\n    let a = 0.0;\n\n    if (color) {\n      r = color.r;\n      g = color.g;\n      b = color.b;\n      a = color.a;\n    }\n\n    let textureIdx = 0.0;\n\n    if (this.textureManager.has(tileData.tileset)) {\n      textureIdx = this.textureManager.getIndex(tileData.tileset);\n    } else {\n      this.textureManager.add(this.gl, tileData.tileset);\n      textureIdx = this.textureManager.getIndex(tileData.tileset);\n    }\n\n    // Top left\n    this.vertices[this.vertexIndex++] = position[0];\n    this.vertices[this.vertexIndex++] = position[1];\n    this.vertices[this.vertexIndex++] = tileData.uv[0][0];\n    this.vertices[this.vertexIndex++] = tileData.uv[0][1];\n    this.vertices[this.vertexIndex++] = textureIdx;\n    this.vertices[this.vertexIndex++] = r;\n    this.vertices[this.vertexIndex++] = g;\n    this.vertices[this.vertexIndex++] = b;\n    this.vertices[this.vertexIndex++] = a;\n\n    // Top right\n    this.vertices[this.vertexIndex++] = position[0] + tileData.size[0];\n    this.vertices[this.vertexIndex++] = position[1];\n    this.vertices[this.vertexIndex++] = tileData.uv[1][0];\n    this.vertices[this.vertexIndex++] = tileData.uv[1][1];\n    this.vertices[this.vertexIndex++] = textureIdx;\n    this.vertices[this.vertexIndex++] = r;\n    this.vertices[this.vertexIndex++] = g;\n    this.vertices[this.vertexIndex++] = b;\n    this.vertices[this.vertexIndex++] = a;\n\n    // Bottom right\n    this.vertices[this.vertexIndex++] = position[0] + tileData.size[0];\n    this.vertices[this.vertexIndex++] = position[1] + tileData.size[1];\n    this.vertices[this.vertexIndex++] = tileData.uv[2][0];\n    this.vertices[this.vertexIndex++] = tileData.uv[2][1];\n    this.vertices[this.vertexIndex++] = textureIdx;\n    this.vertices[this.vertexIndex++] = r;\n    this.vertices[this.vertexIndex++] = g;\n    this.vertices[this.vertexIndex++] = b;\n    this.vertices[this.vertexIndex++] = a;\n\n    // Bottom left\n    this.vertices[this.vertexIndex++] = position[0];\n    this.vertices[this.vertexIndex++] = position[1] + tileData.size[1];\n    this.vertices[this.vertexIndex++] = tileData.uv[3][0];\n    this.vertices[this.vertexIndex++] = tileData.uv[3][1];\n    this.vertices[this.vertexIndex++] = textureIdx;\n    this.vertices[this.vertexIndex++] = r;\n    this.vertices[this.vertexIndex++] = g;\n    this.vertices[this.vertexIndex++] = b;\n    this.vertices[this.vertexIndex++] = a;\n\n    this.indexCount += 6;\n  };\n\n  /**\n   * Finalizes process of emplacing tile data and write it to the WebGL buffer.\n   */\n  flush = () => {\n    this.gl.bufferSubData(this.gl.ARRAY_BUFFER, 0, this.vertices.subarray(0, this.vertexIndex));\n    this.vertexIndex = 0;\n  };\n\n  /**\n   * Renders the tile batch and activate textures in the shader program.\n   */\n  render = () => {\n    if (this.indexCount === 0) {\n      return;\n    }\n\n    let idx = 0;\n    this.textureManager.map.forEach((texture) => {\n      this.gl.activeTexture(this.gl.TEXTURE0 + idx);\n      texture.bind(this.gl);\n      this.shaderProgram.setInt(`${UNIFORM_SAMPLERS}[${idx}]`, idx);\n      ++idx;\n    });\n\n    this.gl.activeTexture(this.gl.TEXTURE0);\n\n    this.gl.bindVertexArray(this.VAO);\n    this.gl.drawElements(this.gl.TRIANGLES, this.indexCount, this.gl.UNSIGNED_SHORT, 0);\n    this.indexCount = 0;\n  };\n}\n","/**\n * Manages 2D othographic camera operations such as movement and zoom.\n * @module Camera\n */\n\nimport { mat4 } from \"gl-matrix\";\n\nconst ZOOM_MAX = 5.0;\nconst ZOOM_MIN = 0.25;\nconst ZOOM_THRESHOLD = 10;\n\nconst zoomLevels = [0.25, 0.5, 0.75, 1.0, 1.25, 1.5, 1.75];\n\nclass Camera {\n  constructor(width, height) {\n    this.width = width;\n    this.height = height;\n    this.zoomLevel = 3;\n    this.zoom = 0;\n    this.perceivedWidth = this.width;\n    this.perceivedHeight = this.height;\n    this.origin = [0.0, 0.0];\n    this.clientOrigin = [0.0, 0.0];\n    this.cameraZ = 80.0;\n    this.position = [0.0, 0.0, this.cameraZ];\n    this.near = 0.1;\n    this.far = 100.0;\n    this.projection = mat4.create();\n    this.modelView = mat4.create();\n    this.mvp = mat4.create();\n\n    mat4.translate(this.modelView, this.modelView, [0.0, 0.0, -this.cameraZ]);\n    this.calculateMvp();\n  }\n\n  setOrigin = (x, y) => {\n    this.origin = [this.position[0], this.position[1]];\n    this.clientOrigin = [x, y];\n  };\n\n  moveTo = (x, y) => {\n    this.position = [\n      this.origin[0] + (this.clientOrigin[0] - x),\n      this.origin[1] + (this.clientOrigin[1] - y),\n      this.cameraZ,\n    ];\n    this.calculateMvp();\n  };\n\n  setZoom = (zoom) => {\n    // Clamp zoom value\n    this.zoom = this.clampZoom(zoom);\n    this.calculateMvp();\n  };\n\n  applyZoom = (zoom) => {\n    this.zoom += zoom;\n\n    if (Math.abs(this.zoom) < ZOOM_THRESHOLD) {\n      return;\n    }\n\n    if (this.zoom < 0) {\n      this.zoomLevel = Math.max(0, this.zoomLevel - 1);\n    } else if (this.zoom > 0) {\n      this.zoomLevel = Math.min(zoomLevels.length - 1, this.zoomLevel + 1);\n    }\n\n    this.perceivedWidth = this.width / zoomLevels[this.zoomLevel];\n    this.perceivedHeight = this.height / zoomLevels[this.zoomLevel];\n    this.zoom = 0;\n    this.calculateMvp();\n  };\n\n  /**\n   * Increments, if possible, zoom level by 1.\n   */\n  incrementZoom = () => {\n    this.zoomLevel = Math.min(zoomLevels.length - 1, this.zoomLevel + 1);\n    this.perceivedWidth = this.width / zoomLevels[this.zoomLevel];\n    this.perceivedHeight = this.height / zoomLevels[this.zoomLevel];\n    this.calculateMvp();\n  }\n\n  /**\n   * Decrements, if possible, zoom level by 1.\n   */\n  decrementZoom = () => {\n    this.zoomLevel = Math.max(0, this.zoomLevel - 1);\n    this.perceivedWidth = this.width / zoomLevels[this.zoomLevel];\n    this.perceivedHeight = this.height / zoomLevels[this.zoomLevel];\n    this.calculateMvp();\n  }\n\n  getMvp = () => {\n    return this.mvp;\n  };\n\n  getZoomLevel = () => {\n    return zoomLevels[this.zoomLevel];\n  };\n\n  calculateMvp = () => {\n    // TODO: Anchor on center when zooming\n    const computedPositionX = this.position[0] / zoomLevels[this.zoomLevel];\n    const computedPositionY = this.position[1] / zoomLevels[this.zoomLevel];\n\n    mat4.ortho(\n      this.projection,\n      computedPositionX,\n      this.perceivedWidth + computedPositionX,\n      this.perceivedHeight + computedPositionY,\n      computedPositionY,\n      this.near,\n      this.far\n    );\n\n    mat4.multiply(this.mvp, this.projection, this.modelView);\n  };\n\n  /**\n   * Updates viewport given new dimensions.\n   *\n   * @param {number} width - width of the new viewport.\n   * @param {number} height - height of the new viewport.\n   */\n  updateViewport = (width, height) => {\n    this.width = width;\n    this.height = height;\n    this.perceivedWidth = this.width / zoomLevels[this.zoomLevel];\n    this.perceivedHeight = this.height / zoomLevels[this.zoomLevel];\n    this.calculateMvp();\n  }\n}\n\nexport default Camera;\n","/**\n * A WebGL renderer that consumes 2D sprites and renders them using batches.\n * @module Renderer\n */\n\nimport reduxStore from \"redux/store\";\nimport TilemapInstance from \"tilemap\";\nimport ShaderProgram from \"renderer/Shader\";\nimport Batch2D from \"renderer/Batch2D\";\nimport Texture from \"renderer/Texture\";\nimport Camera from \"renderer/Camera\";\nimport { UNIFORM_MVP, BATCH_VERTEX_SHADER_SOURCE, BATCH_FRAGMENT_SHADER_SOURCE } from \"renderer/constants\";\n\n// TODO: Provide a method to change tile size per layer\nconst tileSize = [32, 32];\n\n/** A class that handles WebGL rendering of tiles using a Batch2D. */\nclass Renderer {\n  hasInitialized = false;\n\n  /**\n   * Creates a Renderer.\n   *\n   * @param {WebGLContext} gl - WebGL Context from a canvas.\n   */\n  init = (gl) => {\n    this.gl = gl;\n    if (!this.gl) {\n      return;\n    }\n\n    this.gl.enable(this.gl.BLEND);\n    this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\n\n    this.shaderProgram = new ShaderProgram(this.gl, BATCH_VERTEX_SHADER_SOURCE, BATCH_FRAGMENT_SHADER_SOURCE);\n    this.shaderProgram.use();\n\n    this.camera = new Camera(this.gl.canvas.width, this.gl.canvas.height);\n\n    this.shaderProgram.setMat4(UNIFORM_MVP, this.camera.getMvp());\n\n    this.batch = new Batch2D(this.gl, this.shaderProgram);\n\n    this.hasInitialized = true;\n  };\n\n  /**\n   * Sets a color to clear the screen each frame. In this case, it sets the canvas background color.\n   *\n   * @param {number} r - Red component of the color in the range [0.0, 1.0].\n   * @param {number} g - Green component of the color in the range [0.0, 1.0].\n   * @param {number} b - Blue component of the color in the range [0.0, 1.0].\n   * @param {number} a - Alpha component of the color in the range [0.0, 1.0].\n   */\n  setClearColor = (r, g, b, a) => {\n    this.gl.clearColor(r, g, b, a);\n  };\n\n  /**\n   * Updates the camera viewport.\n   *\n   * @param {number} width - New viewport's width.\n   * @param {number} height - New viewport's height.\n   */\n  updateViewport = (width, height) => {\n    this.camera.updateViewport(width, height);\n  }\n\n  /**\n   * Main render loop.\n   */\n  render = () => {\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n    this.renderTilemap();\n    window.requestAnimationFrame(this.render);\n  };\n\n  /**\n   * Batches tiles and renders tilemap.\n   */\n  renderTilemap = () => {\n    // Abort rendering process if the wasm module hasn't been loaded yet\n    if (!TilemapInstance.hasInitialized) {\n      return;\n    }\n\n    this.shaderProgram.use();\n\n    const canvasWidth = this.gl.canvas.width;\n    const canvasHeight = this.gl.canvas.height;\n    const layersState = reduxStore.getState().layers;\n    this.shaderProgram.setMat4(UNIFORM_MVP, this.camera.getMvp());\n\n    this.batch.begin();\n\n    // Iterates through layer names from the redux reduxStore,\n    // gets the corresponding tiles and renders them in order.\n    for (const layerName of layersState.names) {\n      const layer = layersState.layers[layerName];\n      if (!layer.visible) {\n        continue;\n      }\n\n      if (layer.id >= 0) {\n        for (let i = 0, y = 0; y < canvasHeight; i++, y += tileSize[1]) {\n          for (let j = 0, x = 0; x < canvasWidth; j++, x += tileSize[0]) {\n            const value = TilemapInstance.get(j, i, layer.id);\n\n            if (value != -1) {\n              this.batch.emplace(value, [x, y]);\n            }\n          }\n        }\n      }\n    }\n\n    this.batch.flush();\n    this.batch.render();\n  };\n}\n\nconst RendererInstance = new Renderer();\n\nexport default RendererInstance;\n","import { useEffect, useRef } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { addLayer } from \"redux/actions\";\nimport RendererInstance from \"renderer/Renderer\";\nimport TilemapInstance from \"tilemap\";\nimport { TILEMAP_CANVAS_ID } from \"ui/constants\";\n\n// TODO: Provide a method to change tile size per layer\nconst tileSize = [32, 32];\n\nconst WebGLCanvas = () => {\n  const dispatch = useDispatch();\n  const tilesCanvasRef = useRef();\n\n  useEffect(() => {\n    if (!tilesCanvasRef.current) {\n      return;\n    }\n\n    // Update canvas sizes\n    tilesCanvasRef.current.width = tilesCanvasRef.current.clientWidth;\n    tilesCanvasRef.current.height = tilesCanvasRef.current.clientHeight;\n\n    if (!TilemapInstance.hasInitialized) {\n      // TODO: Remove dispatch from here and add a layer only if there isn't any\n      TilemapInstance.init().then(() => {\n        dispatch(\n          addLayer(\n            null,\n            0,\n            0,\n            Math.floor(tilesCanvasRef.current.width / tileSize[0]) + 1,\n            Math.floor(tilesCanvasRef.current.height / tileSize[1]) + 1\n          )\n        );\n      });\n    }\n\n    if (!RendererInstance.hasInitialized) {\n      RendererInstance.init(tilesCanvasRef.current.getContext(\"webgl2\"));\n      //RendererInstance.setClearColor(55.0 / 255.0, 65.0 / 255.0, 81.0 / 255.0, 1.0);\n      RendererInstance.setClearColor(31.0 / 255.0, 41.0 / 255.0, 55.0 / 255.0, 1.0);\n      window.requestAnimationFrame(RendererInstance.render);\n    }\n  }, [dispatch]);\n\n  return (\n    <canvas id={TILEMAP_CANVAS_ID} ref={tilesCanvasRef} className=\"col-span-full row-span-full z-0 w-full h-full\" />\n  );\n};\n\nexport default WebGLCanvas;\n","import { useEffect, useRef } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { selectTool } from \"redux/actions\";\nimport { getTilePositionOnClick } from \"utils/tile\";\nimport { EDITOR_CANVAS_ID } from \"ui/constants\";\nimport RendererInstance from \"renderer/Renderer\";\nimport TilemapInstance from \"tilemap\";\nimport * as tools from \"resources/tools\";\n\n// TODO: Provide a method to change tile size per layer\nconst tileSize = [32, 32];\n\nconst EditorCanvas = () => {\n  const dispatch = useDispatch();\n  const editingCanvasRef = useRef();\n  const { selectedLayer, layers } = useSelector((state) => ({\n    selectedLayer: state.layers.selected,\n    layers: state.layers.layers,\n  }));\n  const selectedTile = useSelector((state) => state.tileset.selectedTile);\n  const selectedTool = useSelector((state) => state.canvas.selectedTool);\n\n  useEffect(() => {\n    const refElement = editingCanvasRef.current;\n    if (!refElement) {\n      return;\n    }\n\n    // Update viewport on resize\n    window.addEventListener('resize', () => {\n      if (!refElement) {\n        return;\n      }\n\n      RendererInstance.updateViewport(refElement.clientWidth, refElement.clientHeight);\n    });\n\n    editingCanvasRef.current.width = refElement.clientWidth;\n    editingCanvasRef.current.height = refElement.clientHeight;\n\n    // Used to allow preventing default wheel behavior on chrome\n    const cancelWheel = (event) => event.preventDefault();\n    refElement.addEventListener(\"wheel\", cancelWheel, { passive: false });\n    return () => {\n      refElement.removeEventListener(\"wheel\", cancelWheel);\n    };\n  }, []);\n\n  useEffect(() => {\n    const panToolStartHandler = ({ key }) => {\n      if (key === \" \") {\n        dispatch(selectTool(tools.PAN_TOOL));\n      }\n    };\n\n    // TODO: Create a stack of tools to be able to get back\n    // to the previous tool instead of the default one\n    const panToolEndHandler = ({ key }) => {\n      if (key === \" \") {\n        dispatch(selectTool(tools.DEFAULT_TOOL));\n      }\n    };\n\n    window.addEventListener(\"keydown\", panToolStartHandler);\n    window.addEventListener(\"keyup\", panToolEndHandler);\n    return () => {\n      window.removeEventListener(\"keydown\", panToolStartHandler);\n      window.removeEventListener(\"keyup\", panToolEndHandler);\n    };\n  }, [dispatch]);\n\n  const handleOneTimeTools = (e) => {\n    switch (selectedTool) {\n      case tools.FILL_TOOL: {\n        const zoomLevel = RendererInstance.camera.getZoomLevel();\n        const position = getTilePositionOnClick(\n          e,\n          [tileSize[0] * zoomLevel, tileSize[1] * zoomLevel],\n          RendererInstance.camera.position\n        );\n        const layerId = layers[selectedLayer].id;\n\n        TilemapInstance.fill(...position, selectedTile, layerId);\n        break;\n      }\n\n      case tools.PAN_TOOL: {\n        RendererInstance.camera.setOrigin(e.clientX, e.clientY);\n        break;\n      }\n\n      case tools.MAGNIFY_TOOL: {\n        if (e.altKey) {\n          RendererInstance.camera.decrementZoom();\n        }\n        else {\n          RendererInstance.camera.incrementZoom();\n        }\n      }\n\n      default:\n        break;\n    }\n  };\n\n  const handleContinuousTools = (e) => {\n    const zoomLevel = RendererInstance.camera.getZoomLevel();\n    const position = getTilePositionOnClick(\n      e,\n      [tileSize[0] * zoomLevel, tileSize[1] * zoomLevel],\n      RendererInstance.camera.position\n    );\n    const layerId = layers[selectedLayer].id;\n\n    switch (selectedTool) {\n      case tools.DEFAULT_TOOL: {\n        break;\n      }\n\n      case tools.PLACEMENT_TOOL: {\n        if (selectedTile !== null && selectedTile !== undefined && selectedTile !== -1) {\n          TilemapInstance.set(...position, selectedTile, layerId);\n        }\n        break;\n      }\n\n      case tools.ERASER_TOOL: {\n        TilemapInstance.set(...position, -1, layerId);\n        break;\n      }\n\n      case tools.PAN_TOOL: {\n        if (e.clientX == 0 || e.clientY == 0) {\n          break;\n        }\n\n        RendererInstance.camera.moveTo(e.clientX, e.clientY);\n        break;\n      }\n\n      default:\n        break;\n    }\n  };\n\n  const handleMouseDown = (e) => {\n    // Abort handling tool if no layer is selected\n    if (!selectedLayer || !layers[selectedLayer]) {\n      return;\n    }\n\n    handleOneTimeTools(e);\n    handleContinuousTools(e);\n  };\n\n  const handleDrag = (e) => {\n    // Abort handling tool if no layer is selected\n    if (!selectedLayer || !layers[selectedLayer]) {\n      return;\n    }\n\n    handleContinuousTools(e);\n  };\n\n  const handleWheel = (e) => {\n    if (!e.altKey) {\n      return;\n    }\n\n    RendererInstance.camera.applyZoom(e.deltaY);\n  };\n\n  return (\n    <canvas\n      id={EDITOR_CANVAS_ID}\n      ref={editingCanvasRef}\n      onWheel={handleWheel}\n      onMouseDown={handleMouseDown}\n      onDragOver={handleDrag}\n      draggable=\"true\"\n      className=\"col-span-full row-span-full z-10 w-full h-full\"\n    />\n  );\n};\n\nexport default EditorCanvas;\n","import Toolbar from \"ui/canvas/Toolbar\";\nimport WebGLCanvas from \"ui/canvas/WebGLCanvas\";\nimport EditorCanvas from \"ui/canvas/EditorCanvas\";\n\nconst Canvas = () => {\n  return (\n    <div className=\"col-span-3 flex flex-col\">\n      <Toolbar />\n      <section className=\"grid flex-1 bg-gray-600\">\n        <EditorCanvas />\n        <WebGLCanvas />\n      </section>\n    </div>\n  );\n};\n\nexport default Canvas;\n","import { NavLink } from \"react-router-dom\";\nimport Icon from \"@mdi/react\";\nimport { accentColor, accentTextColor, accentHoverColor, accentTextHoverColor } from \"resources/styles\";\n\nconst TabButton = ({ iconPath, routerPath }) => {\n  return (\n    <NavLink to={routerPath} className='w-full' activeClassName={`${accentColor} ${accentTextColor}`}>\n      <button className={`w-full py-3 flex justify-center ${accentHoverColor} ${accentTextHoverColor}`} data-tip data-for={routerPath}>\n        <Icon path={iconPath} size={1.0} />\n      </button>\n    </NavLink>\n  );\n};\n\nexport default TabButton;\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"mask\", {\n  id: \"path-1-outside-1\",\n  maskUnits: \"userSpaceOnUse\",\n  x: 0.745167,\n  y: 0.745174,\n  width: 271.529,\n  height: 271.529,\n  fill: \"black\"\n}, /*#__PURE__*/React.createElement(\"rect\", {\n  fill: \"white\",\n  x: 0.745167,\n  y: 0.745174,\n  width: 271.529,\n  height: 271.529\n}), /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  clipRule: \"evenodd\",\n  d: \"M46 136.51L91.2548 91.2548L91.9619 90.5477L136.51 46L181.057 90.5477L181.764 91.2548L227.019 136.51L181.764 181.765L136.51 136.51L91.2548 181.765L46 136.51Z\"\n}));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  clipRule: \"evenodd\",\n  d: \"M46 136.51L91.2548 91.2548L91.9619 90.5477L136.51 46L181.057 90.5477L181.764 91.2548L227.019 136.51L181.764 181.765L136.51 136.51L91.2548 181.765L46 136.51Z\",\n  fill: \"#34D399\"\n});\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M46 136.51L23.3726 113.882L0.745167 136.51L23.3726 159.137L46 136.51ZM136.51 46L159.137 23.3726L136.51 0.745174L113.882 23.3726L136.51 46ZM227.019 136.51L249.647 159.137L272.274 136.51L249.647 113.882L227.019 136.51ZM181.764 181.765L159.137 204.392L181.764 227.019L204.392 204.392L181.764 181.765ZM136.51 136.51L159.137 113.882L136.51 91.2548L113.882 113.882L136.51 136.51ZM91.2548 181.765L68.6274 204.392L91.2548 227.019L113.882 204.392L91.2548 181.765ZM68.6274 68.6274L23.3726 113.882L68.6274 159.137L113.882 113.882L68.6274 68.6274ZM69.3345 67.9203L68.6274 68.6274L113.882 113.882L114.589 113.175L69.3345 67.9203ZM113.882 23.3726L69.3345 67.9203L114.589 113.175L159.137 68.6274L113.882 23.3726ZM203.685 67.9203L159.137 23.3726L113.882 68.6274L158.43 113.175L203.685 67.9203ZM158.43 113.175L159.137 113.882L204.392 68.6274L203.685 67.9203L158.43 113.175ZM159.137 113.882L204.392 159.137L249.647 113.882L204.392 68.6274L159.137 113.882ZM204.392 113.882L159.137 159.137L204.392 204.392L249.647 159.137L204.392 113.882ZM204.392 159.137L159.137 113.882L113.882 159.137L159.137 204.392L204.392 159.137ZM113.882 204.392L159.137 159.137L113.882 113.882L68.6274 159.137L113.882 204.392ZM23.3726 159.137L68.6274 204.392L113.882 159.137L68.6274 113.882L23.3726 159.137Z\",\n  fill: \"#0A0913\",\n  mask: \"url(#path-1-outside-1)\"\n});\n\nvar _ref5 = /*#__PURE__*/React.createElement(\"rect\", {\n  x: 91.2548,\n  y: 181.765,\n  width: 64,\n  height: 64,\n  transform: \"rotate(-45 91.2548 181.765)\",\n  fill: \"#FBFDFC\",\n  stroke: \"#0A0913\",\n  strokeWidth: 32\n});\n\nfunction SvgLogo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"100%\",\n    height: \"100%\",\n    viewBox: \"0 0 273 273\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2, _ref3, _ref4, _ref5);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgLogo);\nexport default __webpack_public_path__ + \"static/media/logo.6b22daf5.svg\";\nexport { ForwardRef as ReactComponent };","import ReactTooltip from \"react-tooltip\";\nimport TabButton from \"ui/sidebar/TabButton\";\nimport tooltips from \"resources/tooltips\";\nimport * as tabs from \"resources/tabs\";\nimport { tabbarColor, dividerBorderColor } from \"resources/styles\";\nimport { TOOLTIP_DELAY } from \"ui/constants\";\nimport { mdiMap, mdiViewModule, mdiContentSave, mdiUpload, mdiHelpCircleOutline, mdiCog } from \"@mdi/js\";\nimport { ReactComponent as Logo } from 'resources/logo.svg';\n\nconst TabSelector = () => {\n  const sectionsData = [\n    { path: tabs.TAB_TILES, icon: mdiViewModule },\n    { path: tabs.TAB_MAP, icon: mdiMap },\n    { path: tabs.TAB_IMPORT, icon: mdiUpload },\n    { path: tabs.TAB_EXPORT, icon: mdiContentSave },\n    { path: tabs.TAB_SETTINGS, icon: mdiCog },\n    { path: tabs.TAB_HELP, icon: mdiHelpCircleOutline },\n  ];\n\n  const sections = sectionsData.map((section) => (\n    <div key={section.path} className=\"flex\" data-testid={section.path}>\n      <TabButton routerPath={section.path} iconPath={section.icon} />\n      <ReactTooltip id={section.path} place=\"right\" effect=\"solid\" delayShow={TOOLTIP_DELAY}>\n        {tooltips.get(section.path)}\n      </ReactTooltip>\n    </div>\n  ));\n\n  return (\n    <div className={`w-10 flex flex-col justify-end bg-almost-black border-r ${dividerBorderColor}`}>\n      <div className='flex-1 flex flex-col justify-start'>\n        <div className='py-3 px-0.5'>\n          <Logo />\n        </div>\n      </div>\n      {sections}\n    </div>);\n};\n\nexport default TabSelector;\n","import { dividerBorderColor, titleBarHeight } from \"resources/styles.js\";\n\nconst Tab = ({ children, title }) => {\n  return (\n    <div className=\"flex-1 flex flex-col text-sm\">\n      <h2 className={`${titleBarHeight} bg-almost-black border-b ${dividerBorderColor} px-2 flex items-center`}>{title}</h2>\n      {children}\n    </div>\n  );\n};\n\nexport default Tab;\n","export const getLayersState = (state) => state.layers;\n\nexport const getLayersNames = (state) => (getLayersState(state) ? getLayersState(state).names : []);\n\nexport const getLayerByName = (state, name) =>\n  getLayersState(state) ? { ...getLayersState(state).layers[name], name } : {};\n\nexport const getLayers = (state) => getLayersNames(state).map((name) => getLayerByName(state, name));\n\nexport const getLayersByAddedTime = (state) => getLayers(state).reverse();\n\nexport const getVisibleLayers = (state) => {\n  const layersState = getLayersState(state);\n  return layersState.names.filter((name) => layersState.layers[name].visible).reverse();\n};\n","import { useState } from \"react\";\nimport { Collapse } from \"react-collapse\";\nimport Icon from \"@mdi/react\";\nimport { mdiMenuDown, mdiMenuRight } from \"@mdi/js\";\nimport { dividerBorderColor, titleBarHeight } from \"resources/styles.js\";\n\nconst CollapseSection = ({ title, children }) => {\n  const [open, setOpen] = useState(true);\n  const icon = open ? mdiMenuDown : mdiMenuRight;\n  const sectionClass = open ? `border-b ${dividerBorderColor}` : \"\";\n\n  return (\n    <div className={sectionClass}>\n      <div\n        className={`text-xs flex items-center hover:bg-gray-800 cursor-pointer border-b ${dividerBorderColor} ${titleBarHeight}`}\n        onDoubleClick={(e) => setOpen(!open)}\n      >\n        <Icon path={icon} size={1} />\n\n        <h1 className=\"select-none\">{title}</h1>\n      </div>\n\n      <Collapse isOpened={open}>\n        <div className=\"text-xs text-gray-300 px-2 py-2\">{children}</div>\n      </Collapse>\n    </div>\n  );\n};\n\nexport default CollapseSection;\n","import { useDispatch } from \"react-redux\";\nimport { Draggable } from \"react-beautiful-dnd\";\nimport { selectLayer, toggleLayerVisibility } from \"redux/actions\";\nimport { mdiEye, mdiEyeOffOutline } from \"@mdi/js\";\nimport Icon from \"@mdi/react\";\nimport * as testIds from \"resources/testIds\";\n\nconst LayerItem = ({ layer, index, isSelected }) => {\n  const dispatch = useDispatch();\n\n  const handleLayerClick = () => {\n    dispatch(selectLayer(layer.name));\n  };\n\n  const handleEyeClick = () => {\n    dispatch(toggleLayerVisibility(layer.name));\n  };\n\n  const icon = layer.visible ? mdiEye : mdiEyeOffOutline;\n  const selectedClassName = isSelected ? \"bg-gray-700 hover:text-white\" : \"bg-gray-800 hover:bg-gray-900\";\n  const visibilityTestId = layer.visible ? testIds.LAYER_VISIBLE : testIds.LAYER_HIDDEN;\n\n  return (\n    <div className=\"border-t border-gray-700 first:border-t-0\">\n      <Draggable draggableId={layer.name} index={index}>\n        {(provided, snapshop) => {\n          const style = {\n            cursor: \"default\",\n            ...provided.draggableProps.style,\n          };\n\n          return (\n            <li\n              className={`flex items-center select-none ${selectedClassName}`}\n              ref={provided.innerRef}\n              {...provided.draggableProps}\n              {...provided.dragHandleProps}\n              style={style}\n              data-testid={visibilityTestId}\n            >\n              <span className=\"flex-1 pl-4 py-1\" onClick={handleLayerClick}>\n                {layer.name}\n              </span>\n              <span\n                onClick={handleEyeClick}\n                className=\"cursor-pointer pr-4 py-1 hover:text-white\"\n                data-testid={testIds.HIDE_LAYER_BUTTON}\n              >\n                <Icon path={icon} size={0.6} />\n              </span>\n            </li>\n          );\n        }}\n      </Draggable>\n    </div>\n  );\n};\n\nexport default LayerItem;\n","import { useDispatch } from \"react-redux\";\nimport { addLayer, deleteLayer } from \"redux/actions\";\nimport { mdiDelete, mdiPlaylistPlus, mdiCog } from \"@mdi/js\";\nimport Icon from \"@mdi/react\";\nimport * as testIds from \"resources/testIds\";\n\nconst LayerListFooter = ({ selectedLayer }) => {\n  const dispatch = useDispatch();\n\n  const handleAddClick = () => {\n    dispatch(addLayer());\n  };\n\n  const handleSettingsClick = () => {\n\n  };\n\n  const handleDeleteClick = () => {\n    dispatch(deleteLayer(selectedLayer));\n  };\n\n  return (\n    <>\n      <div className=\"flex items-center justify-start mt-1\">\n        <button onClick={handleAddClick} data-testid={testIds.ADD_LAYER_BUTTON} className=\"hover:text-white\">\n          <Icon path={mdiPlaylistPlus} size={0.7} />\n        </button>\n        <button onClick={handleSettingsClick} className=\"hover:text-white\">\n          <Icon path={mdiCog} size={0.6} />\n        </button>\n        <button onClick={handleDeleteClick} data-testid={testIds.DELETE_LAYER_BUTTON} className=\"hover:text-white\">\n          <Icon path={mdiDelete} size={0.65} />\n        </button>\n      </div>\n    </>\n  );\n};\n\nexport default LayerListFooter;\n","import { useSelector, useDispatch } from \"react-redux\";\nimport { getLayersByAddedTime } from \"redux/selectors\";\nimport CollapseSection from \"ui/common/CollapseTab\";\nimport LayerListItem from \"ui/sidebar/tileset/LayerListItem\";\nimport LayerListFooter from \"ui/sidebar/tileset/LayerListFooter\";\nimport { DragDropContext, Droppable } from \"react-beautiful-dnd\";\nimport { selectLayer, moveLayer } from \"redux/actions\";\n\nconst LayerList = () => {\n  const dispatch = useDispatch();\n\n  const { selectedLayer, layers } = useSelector((state) => ({\n    selectedLayer: state.layers.selected,\n    layers: getLayersByAddedTime(state),\n  }));\n\n  const handleLayerBeforeDragStart = (e) => {\n    dispatch(selectLayer(e.draggableId));\n  };\n\n  const handleLayerDragEnd = (e) => {\n    dispatch(moveLayer(e.draggableId, layers.length - e.destination.index - 1));\n  };\n\n  const layerComponents = layers.map((l, i) => (\n    <LayerListItem key={l.name} index={i} layer={l} isSelected={l.name === selectedLayer} />\n  ));\n\n  const dndArea =\n    layers && layers.length ? (\n      <DragDropContext onDragEnd={handleLayerDragEnd} onBeforeDragStart={handleLayerBeforeDragStart}>\n        <Droppable droppableId=\"layers\">\n          {(provided) => (\n            <ul {...provided.droppableProps} ref={provided.innerRef} className=\"border rounded-sm border-gray-700\">\n              {layerComponents}\n              {provided.placeholder}\n            </ul>\n          )}\n        </Droppable>\n      </DragDropContext>\n    ) : (\n      <div />\n    );\n\n  return (\n    <CollapseSection title=\"Layers\">\n      {dndArea}\n      <LayerListFooter selectedLayer={selectedLayer} />\n    </CollapseSection>\n  );\n};\n\nexport default LayerList;\n","import { useEffect, useState, useRef } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { getTextureData, hasTexture } from \"idbTextureStore\";\nimport { selectTile } from \"redux/actions\";\nimport { getTilePositionOnClick } from \"utils/tile\";\nimport { GRID_COLOR, GRID_CANVAS_ID, TILESET_CANVAS_ID, SELECTED_TILE_COLOR_OVERLAY } from \"ui/constants\";\n\nconst drawGridLines = (canvas, tileDimensions) => {\n  const context = canvas.getContext(\"2d\");\n  context.strokeStyle = GRID_COLOR;\n  context.lineWidth = 1;\n\n  // Draw horizontal lines\n  for (let j = tileDimensions[0]; j < canvas.height; j += tileDimensions[0]) {\n    context.beginPath();\n    context.moveTo(0, j + 0.5);\n    context.lineTo(canvas.width, j + 0.5);\n    context.stroke();\n  }\n\n  // Draw vertical lines\n  for (let i = tileDimensions[1]; i < canvas.width; i += tileDimensions[1]) {\n    context.beginPath();\n    context.moveTo(i + 0.5, 0);\n    context.lineTo(i + 0.5, canvas.height);\n    context.stroke();\n  }\n};\n\nconst TilesetPreview = ({ selectable, tileSize }) => {\n  const dispatch = useDispatch();\n  const selectedTileset = useSelector((state) => state.tileset.selectedTileset);\n  const [selectedTile, setSelectedTile] = useState([-1, -1]);\n  const [tilesetIndex, setTilesetIndex] = useState(0);\n  const tilegridCanvasRef = useRef(null);\n  const tilesetCanvasRef = useRef(null);\n\n  // Load a new tileset to the preview\n  useEffect(() => {\n    if (!selectedTileset || selectedTileset === \"\" || !tilegridCanvasRef.current || !tilesetCanvasRef.current) {\n      return;\n    }\n\n    const tilesetCanvas = tilesetCanvasRef.current;\n    const tilegridCanvas = tilegridCanvasRef.current;\n\n    // Add image to canvas\n    getTextureData(selectedTileset).then((data) => {\n      const reader = new FileReader();\n\n      reader.onload = (e) => {\n        const image = new Image();\n        image.onload = () => {\n          tilesetCanvas.width = image.width;\n          tilesetCanvas.height = image.height;\n\n          tilegridCanvas.width = image.width;\n          tilegridCanvas.height = image.height;\n\n          const tilesetContext = tilesetCanvas.getContext(\"2d\");\n          tilesetContext.drawImage(image, 0, 0);\n          drawGridLines(tilesetCanvas, tileSize);\n          setTilesetIndex(data.tilesetIndex);\n        };\n        image.src = e.target.result;\n      };\n      reader.readAsDataURL(data.file);\n    });\n  }, [selectedTileset, tileSize]);\n\n  // Draw highlight on selected tile\n  useEffect(() => {\n    if (!tilegridCanvasRef.current) {\n      return;\n    }\n\n    const canvas = tilegridCanvasRef.current;\n    const context = canvas.getContext(\"2d\");\n    // Draw square on selected tile\n    context.fillStyle = SELECTED_TILE_COLOR_OVERLAY;\n    context.clearRect(0, 0, canvas.width, canvas.height);\n    context.fillRect(\n      selectedTile[0] * tileSize[0] + 1,\n      selectedTile[1] * tileSize[1] + 1,\n      tileSize[0] - 1,\n      tileSize[1] - 1\n    );\n  }, [selectedTile, tileSize]);\n\n  const onSelectTile = (e) => {\n    if (!selectable) {\n      return;\n    }\n\n    const tilePos = getTilePositionOnClick(e, tileSize);\n    const tileIndex = tilesetIndex + tilePos[1] * Math.floor(e.target.width / tileSize[0]) + tilePos[0];\n    dispatch(selectTile(tileIndex));\n    setSelectedTile(tilePos);\n  };\n\n  const tilesetPreview =\n    selectedTileset === \"\" ? (\n      <div />\n    ) : (\n      <>\n        <div className=\"max-h-40 max-w-full overflow-scroll border inline-block rounded-sm mt-2\">\n          <div className=\"grid\">\n            <canvas\n              id={GRID_CANVAS_ID}\n              onMouseUp={onSelectTile}\n              ref={tilegridCanvasRef}\n              className=\"col-span-full row-span-full z-10 overflow-hidden\"\n            />\n            <canvas\n              id={TILESET_CANVAS_ID}\n              ref={tilesetCanvasRef}\n              className=\"col-span-full row-span-full z-0 overflow-hidden\"\n            />\n          </div>\n        </div>\n      </>\n    );\n\n  return tilesetPreview;\n};\n\nexport default TilesetPreview;\n","import { SELECT_TAG } from \"resources/testIds\";\n\nconst Select = ({ value, options, onChange }) => {\n  return (\n    <select\n      className=\"text-gray-400 w-full px-1 py-1 bg-gray-800 hover:bg-gray-700 hover:text-white border border-gray-700 rounded-sm\"\n      value={value}\n      onChange={onChange}\n      data-testid={SELECT_TAG}\n    >\n      {options}\n    </select>\n  );\n};\n\nexport default Select;\n","import { useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { selectTileset } from \"redux/actions\";\nimport { LOCAL_STORAGE_LAST_SELECTED_TILESET } from \"ui/constants\";\nimport Select from \"ui/common/Select\";\n\nconst TilesetSelector = () => {\n  const dispatch = useDispatch();\n  const { selectedTileset, tilesetNames } = useSelector((state) => state.tileset);\n\n  // Get last tileset used from localStorage\n  useEffect(() => {\n    const lastSelectedTileset = localStorage.getItem(LOCAL_STORAGE_LAST_SELECTED_TILESET);\n\n    // TODO: Check if tileset exists\n    if (lastSelectedTileset && lastSelectedTileset !== \"\") {\n      dispatch(selectTileset(lastSelectedTileset));\n    } else {\n      localStorage.setItem(LOCAL_STORAGE_LAST_SELECTED_TILESET, \"\");\n    }\n  }, [dispatch]);\n\n  const onOptionSelected = (e) => {\n    const name = e.target.value;\n    localStorage.setItem(LOCAL_STORAGE_LAST_SELECTED_TILESET, name);\n    dispatch(selectTileset(name));\n  };\n\n  const options = [];\n  for (const value of tilesetNames) {\n    options.push(\n      <option value={value} key={value} data-testid={value}>\n        {value}\n      </option>\n    );\n  }\n\n  return tilesetNames.length > 0 && <Select value={selectedTileset} options={options} onChange={onOptionSelected} />;\n};\n\nexport default TilesetSelector;\n","const Button = ({ text, onClick }) => {\n  return (\n    <div\n      className=\"cursor-pointer block bg-green-600 hover:bg-green-700 active:bg-green-800 px-1 py-2 flex items-center text-center rounded-sm w-full\"\n      onClick={onClick}\n    >\n      <p className=\"flex-1 text-white\">{text}</p>\n    </div>\n  );\n};\n\nexport default Button;\n","import Button from \"ui/common/Button\";\n\nconst FileInput = ({ title, onUpload }) => {\n  return (\n    <div>\n      <input\n        type=\"file\"\n        name=\"tilesetFile\"\n        id=\"tilesetFile\"\n        min=\"1\"\n        max=\"100\"\n        value=\"\"\n        onChange={onUpload}\n        style={{ width: \"0.1px\", height: \"0.1px\", opacity: 0, overflow: \"hidden\", position: \"absolute\", zIndex: \"-1\" }}\n      />\n      <label htmlFor=\"tilesetFile\" className=\"block \">\n        <Button text=\"Choose a file...\" />\n      </label>\n    </div>\n  );\n};\n\nexport default FileInput;\n","import { useState, useEffect } from 'react';\nimport ReactModal from 'react-modal';\n\nconst Modal = ({ children, open, title, onClose }) => {\n  return (\n    <ReactModal\n      isOpen={open}\n      contentLabel={title}\n      onRequestClose={onClose}\n      style={{\n        overlay: {\n          backgroundColor: 'rgba(0,0,0,0.6)',\n          zIndex: '19',\n        },\n\n        content: {\n          backgroundColor: 'rgb(17, 24, 39)',\n          borderRadius: '0.25rem',\n          borderColor: 'rgb(75, 85, 99)',\n          color: 'rgb(249, 250, 251)',\n          top: '50%',\n          left: '50%',\n          right: '0',\n          bottom: '0',\n          transform: 'translate(-50%, -50%)',\n          zIndex: '20',\n          padding: '1rem',\n          height: 'max-content',\n          width: 'max-content',\n        }\n      }}\n    >\n      <h1>{title}</h1>\n      <div className='text-xs'>\n      {children}\n      </div>\n    </ReactModal>\n  );\n}\n\nexport default Modal;\n","import { useState } from 'react';\nimport Modal from 'ui/common/Modal';\nimport Button from 'ui/common/Button';\nimport TilesetPreview from 'ui/sidebar/tileset/TilesetPreview';\n\nconst TilesetSettingsModal = ({ open, onClose }) => {\n  const [tileWidth, setTileWidth] = useState(32);\n  const [tileHeight, setTileHeight] = useState(32);\n\n  const changeGridWidth = (e) => {\n    setTileWidth(e.target.value);\n  }\n\n  const changeGridHeight = (e) => {\n    setTileHeight(e.target.value);\n  }\n\n  const updateTileset = () => {\n    // TODO: Update tileset dimensions\n    if (onClose) {\n      onClose();\n    }\n  }\n\n  return (\n    <Modal title='Tileset Settings' open={open} onClose={onClose}>\n      <form className='mb-2'>\n        <label>\n          Tile dimensions (px):<br />\n        </label>\n        <div className='mt-2'>\n          <input type='number' value={tileWidth} onChange={changeGridWidth} className='w-14 mr-1' />\n          <input type='number' value={tileHeight} onChange={changeGridHeight} className='w-14 ml-1' />\n        </div>\n      </form>\n\n      <TilesetPreview\n        selectable={false}\n        tileSize={[parseInt(tileWidth), parseInt(tileHeight)]}\n      />\n\n      <div className='flex mt-2'>\n        <span className='w-full mr-1'>\n          <Button text='Update' onClick={updateTileset} />\n        </span>\n        <span className='w-full ml-1'>\n          <Button text='Cancel' onClick={onClose} />\n        </span>\n      </div>\n    </Modal>\n  );\n};\n\nexport default TilesetSettingsModal;\n\n","import { useState } from 'react';\nimport { useDispatch } from \"react-redux\";\nimport { deleteTileset } from \"redux/actions\";\nimport { mdiDelete, mdiCog } from \"@mdi/js\";\nimport TilesetSettingsModal from 'ui/sidebar/tileset/TilesetSettingsModal';\nimport Icon from \"@mdi/react\";\nimport * as testIds from \"resources/testIds\";\n\nconst TilesetFooter = ({ selectedTileset }) => {\n  const dispatch = useDispatch();\n  const [showTilesetSettings, setShowTilesetSettings] = useState(false);\n\n  const handleSettingsClick = () => {\n    setShowTilesetSettings(true);\n  };\n\n  const handleSettingsClose = () => {\n    setShowTilesetSettings(false);\n  }\n\n  const handleDeleteClick = () => {\n    dispatch(deleteTileset(selectedTileset));\n  };\n\n  return (\n    <>\n      <div className=\"flex items-center justify-start\">\n        <button onClick={handleSettingsClick} className=\"hover:text-white\">\n          <Icon path={mdiCog} size={0.6} />\n        </button>\n        <button onClick={handleDeleteClick} className=\"hover:text-white\">\n          <Icon path={mdiDelete} size={0.65} />\n        </button>\n      </div>\n\n      <TilesetSettingsModal open={showTilesetSettings} onClose={handleSettingsClose} />\n    </>\n  );\n};\n\nexport default TilesetFooter;\n","import { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { addTileset, loadExistingTilesets } from \"redux/actions\";\nimport { setTextureData, getTextureNames, hasTexture } from \"idbTextureStore\";\nimport LayerList from \"ui/sidebar/tileset/LayerList\";\nimport TilesetPreview from \"ui/sidebar/tileset/TilesetPreview\";\nimport TilesetSelector from \"ui/sidebar/tileset/TilesetSelector\";\nimport TileManagerInstance from \"renderer/TileManager\";\nimport CollapseSection from \"ui/common/CollapseTab\";\nimport FileInput from \"ui/common/FileInput\";\nimport TilesetFooter from \"ui/sidebar/tileset/TilesetFooter\";\nimport { ADD_TILESET_TITLE } from \"ui/constants\";\n\nconst tileSize = [32, 32];\n\nconst TilesetManager = () => {\n  const dispatch = useDispatch();\n  const tilesetNames = useSelector((state) => state.tileset.tilesetNames);\n  const hasLoadedTextures = useSelector((state) => state.tileset.hasLoadedTextures);\n  const selectedTileset = useSelector((state) => state.tileset.selectedTileset);\n\n  // Load existing tilesets\n  useEffect(() => {\n    getTextureNames().then((textures) => {\n      dispatch(loadExistingTilesets(textures));\n    }); // eslint-disable-next-line\n  }, []);\n\n  const onTilesetUpload = async (event) => {\n    // Return if file is invalid\n    if (event.target.files.length <= 0 || !event.target.files[0]) {\n      return;\n    }\n\n    dispatch(addTileset(event.target.files[0].name, event.target.files[0]));\n  };\n\n  return (\n    <CollapseSection title=\"Tileset\">\n      {hasLoadedTextures ? (\n        <>\n          <TilesetSelector />\n          <div className=\"mt-2\">\n            <FileInput title={ADD_TILESET_TITLE} onUpload={(e) => onTilesetUpload(e)} />\n          </div>\n          <TilesetPreview\n            selectable={true}\n            tileSize={tileSize}\n          />\n          {selectedTileset && <TilesetFooter selectedTileset={selectedTileset} />}\n        </>\n      ) : (\n        <div />\n      )}\n    </CollapseSection>\n  );\n};\n\nexport default TilesetManager;\n","import Tab from \"ui/common/Tab\";\nimport LayerList from \"ui/sidebar/tileset/LayerList\";\nimport TilesetSettings from \"ui/sidebar/tileset/TilesetSettings\";\n\nconst Edit = () => {\n  return (\n    <Tab title=\"Edit\">\n      <LayerList />\n      <TilesetSettings />\n    </Tab>\n  );\n};\n\nexport default Edit;\n","export default function SliderInput(props) {\n  return (\n    <div>\n      <p>\n        <strong>{props.title}</strong>\n      </p>\n      <span>{props.value}px</span>\n      <input type=\"range\" min=\"1\" max=\"100\" value={props.value} onChange={props.onChange} />\n    </div>\n  );\n}\n","import { useState } from \"react\";\nimport Tab from \"ui/common/Tab\";\nimport Slider from \"ui/common/SliderInput\";\n\nconst MapSettings = (props) => {\n  const [tileSize, setTileSize] = useState(32);\n\n  return (\n    <Tab title=\"Map Settings\">\n      <Slider title=\"Tile size\" onChange={(e) => setTileSize(e.target.value)} value={tileSize} />\n    </Tab>\n  );\n};\n\nexport default MapSettings;\n","import Tab from \"ui/common/Tab\";\n\nconst ImportSettings = () => {\n  return (\n    <Tab title=\"Import\">\n      <h3>Import</h3>\n    </Tab>\n  );\n};\n\nexport default ImportSettings;\n","import * as formats from \"resources/formats\";\nimport Select from \"ui/common/Select\";\n\nconst FormatSelector = ({ format, onOptionSelected }) => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const formatsArray = [formats.FORMAT_JSON, formats.FORMAT_TMX];\n\n  // ====================================\n  // Render\n  // ====================================\n  const formatOptions = formatsArray.map((format) => (\n    <option key={format} value={format}>\n      {format}\n    </option>\n  ));\n\n  return <Select value={format} options={formatOptions} onChange={onOptionSelected} />;\n};\n\nexport default FormatSelector;\n","import { useState } from \"react\";\nimport Tab from \"ui/common/Tab\";\nimport * as formats from \"resources/formats\";\nimport TilemapInstance from \"tilemap\";\nimport FormatSelector from \"ui/sidebar/export/FormatSelector\";\nimport Button from \"ui/common/Button\";\n\nconst ExportSettings = () => {\n  const [format, setFormat] = useState(formats.FORMAT_JSON);\n\n  const onOptionSelected = (e) => {\n    setFormat(e.target.value);\n  };\n\n  const handleExport = async () => {\n    const rawData = await TilemapInstance.export(format);\n    const filename = \"tilemap.\" + format;\n    const blob = new Blob([rawData], { type: \"application/json\" });\n    const a = document.createElement(\"a\");\n\n    a.href = URL.createObjectURL(blob);\n    a.download = filename;\n    a.click();\n  };\n\n  return (\n    <Tab title=\"Export Map\">\n      <FormatSelector format={format} onOptionSelected={onOptionSelected} />\n      <Button text=\"Export\" onClick={handleExport} />\n    </Tab>\n  );\n};\n\nexport default ExportSettings;\n","import Tab from \"ui/common/Tab\";\n\nconst ProjectSettings = () => {\n  return (\n    <Tab title=\"Project Settings\">\n      <label htmlFor=\"show-grid\">Show grid</label>\n      <input type=\"checkbox\" name=\"show-grid\" />\n    </Tab>\n  );\n};\n\nexport default ProjectSettings;\n","import Tab from \"ui/common/Tab\";\n\nconst Help = () => {\n  return <Tab title=\"Help\"></Tab>;\n};\n\nexport default Help;\n","import TabSelector from \"ui/sidebar/TabSelector\";\nimport Edit from \"ui/sidebar/tileset/Edit\";\nimport MapSettings from \"ui/sidebar/map/MapSettings\";\nimport ImportSettings from \"ui/sidebar/import/ImportSettings\";\nimport ExportSettings from \"ui/sidebar/export/ExportSettings\";\nimport ProjectSettings from \"ui/sidebar/project/ProjectSettings\";\nimport Help from \"ui/sidebar/Help\";\nimport { Switch, Route } from \"react-router-dom\";\nimport { dividerBorderColor } from \"resources/styles\";\nimport * as tabs from \"resources/tabs\";\n\nconst Sidebar = () => {\n  return (\n    <aside className={`flex flex-row bg-gray-900 border-r border-b ${dividerBorderColor}`}>\n      <TabSelector />\n      <Switch>\n        <Route path={`/${tabs.TAB_TILES}`}>\n          <Edit />\n        </Route>\n\n        <Route path={`/${tabs.TAB_MAP}`}>\n          <MapSettings />\n        </Route>\n\n        <Route path={`/${tabs.TAB_IMPORT}`}>\n          <ImportSettings />\n        </Route>\n\n        <Route path={`/${tabs.TAB_EXPORT}`}>\n          <ExportSettings />\n        </Route>\n\n        <Route path={`/${tabs.TAB_SETTINGS}`}>\n          <ProjectSettings />\n        </Route>\n\n        <Route path={`/${tabs.TAB_HELP}`}>\n          <Help />\n        </Route>\n      </Switch>\n    </aside>\n  );\n};\n\nexport default Sidebar;\n","import Canvas from \"ui/canvas/Canvas\";\nimport Sidebar from \"ui/sidebar/Sidebar\";\nimport { HashRouter } from \"react-router-dom\";\nimport { dividerBorderColor } from \"resources/styles\";\n\nconst App = () => {\n  return (\n    <div\n      className={`h-screen w-screen flex flex-col bg-gray-900 border-l border-t ${dividerBorderColor} text-gray-100`}\n    >\n      <main className=\"flex-1 grid grid-cols-4 grid-rows-1\">\n        <HashRouter>\n          <Sidebar />\n        </HashRouter>\n        <Canvas />\n      </main>\n    </div>\n  );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport App from \"ui/App\";\nimport store from \"redux/store\";\nimport ReactModal from 'react-modal';\nimport \"index.css\";\n\n// Set app element in order to hide it\n// when a modal is open.\nReactModal.setAppElement('#root');\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}