{"version":3,"sources":["redux/actionTypes.js","redux/actions.js","resources/tools.js","resources/tabs.js","resources/tooltips.js","ui/constants.js","ui/canvas/Tool.js","resources/testIds.js","resources/styles.js","ui/canvas/Toolbar.js","redux/reducers/tileset.js","redux/reducers/canvas.js","redux/reducers/layers.js","redux/reducers/index.js","resources/formats.js","idbTextureStore.js","utils/file.js","utils/tile.js","renderer/TileManager.js","utils/export/exportJson.js","tilemap/index.js","redux/store.js","redux/middlewares.js","renderer/Shader.js","renderer/Texture.js","renderer/TextureManager.js","renderer/constants.js","renderer/Batch2D.js","renderer/Camera.js","renderer/Renderer.js","ui/canvas/WebGLCanvas.js","ui/canvas/EditorCanvas.js","ui/canvas/Canvas.js","ui/sidebar/TabButton.js","resources/logo.svg","ui/sidebar/TabSelector.js","ui/common/Tab.js","redux/selectors.js","ui/common/CollapseTab.js","ui/sidebar/tileset/LayerListItem.js","ui/sidebar/tileset/LayerListFooter.js","ui/sidebar/tileset/LayerList.js","ui/sidebar/tileset/TilesetFooter.js","ui/sidebar/tileset/TilesetPreview.js","ui/common/Select.js","ui/sidebar/tileset/TilesetSelector.js","ui/common/Button.js","ui/common/FileInput.js","ui/sidebar/tileset/TilesetSettings.js","ui/sidebar/tileset/Edit.js","ui/common/SliderInput.js","ui/sidebar/map/MapSettings.js","ui/sidebar/import/ImportSettings.js","ui/sidebar/export/FormatSelector.js","ui/sidebar/export/ExportSettings.js","ui/sidebar/project/ProjectSettings.js","ui/sidebar/Help.js","ui/sidebar/Sidebar.js","ui/App.js","index.js"],"names":["ADD_TILESET","LOAD_EXISTING_TILESETS","COMPLETE_TEXTURE_LOADING","SELECT_TILESET","DELETE_TILESET","SELECT_TILE","SELECT_TOOL","ADD_LAYER","DELETE_LAYER","SELECT_LAYER","MOVE_LAYER","TOGGLE_LAYER_VISIBILITY","selectTileset","name","type","payload","selectTool","tool","addLayer","x","y","width","height","selectLayer","DEFAULT_TOOL","PLACEMENT_TOOL","FILL_TOOL","MOVE_TOOL","PAN_TOOL","TAB_TILES","TAB_MAP","TAB_IMPORT","TAB_EXPORT","TAB_SETTINGS","TAB_HELP","tooltips","Map","set","tools","tabs","LOCAL_STORAGE_LAST_SELECTED_TILESET","Tool","iconPath","dispatch","useDispatch","selectedTool","useSelector","state","canvas","iconClasses","className","role","data-testid","onClick","data-tip","data-for","path","size","id","place","effect","delayShow","get","dividerBorderColor","titleBarHeight","Toolbar","mdiCursorDefaultOutline","mdiPencil","mdiPail","mdiCursorMove","initialState","tilesetNames","selectedTileset","selectedTile","hasLoadedTextures","selected","names","layers","lastIdx","combineReducers","tileset","action","newTilesetNames","filter","n","newSelected","length","idx","Math","max","indexOf","value","visible","newLayers","newIds","to","from","reorderedNames","splice","FORMAT_JSON","textureStore","Store","getTextureNames","a","keys","textureNames","console","error","getTextureData","data","setTextureData","file","tilesetIndex","TileManagerInstance","lastId","addTilesFromTileset","localStorage","setItem","deleteTextureData","del","getItem","removeItem","hasTexture","textureKeys","includes","loadTilesFromExistingTilesets","tilesets","reduxStore","getImageBitmap","fileData","createImageBitmap","getTilePositionOnClick","e","tileSize","offset","bounds","target","getBoundingClientRect","floor","clientX","left","clientY","top","getTileUV","frame","frameSize","textureSize","frameWidth","frameHeight","hFrames","vFrames","maxFrames","frameX","frameY","topLeftX","topLeftY","texture","bitmap","tileIndex","i","j","uv","tiles","tile","this","exportJson","exportObject","getState","JSON","stringify","layerNames","layerName","layer","layerObj","TilemapInstance","layerWidth","layerHeight","layerX","layerY","push","tilesetName","tilesetObj","init","wasm","memory","map","Tilemap","new","hasInitialized","message","add_layer","layerId","fill","targetValue","layer_width","layer_height","layer_x","layer_y","export","format","formats","composeEnhancer","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","rootReducer","applyMiddleware","next","createShader","gl","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","info","getShaderInfoLog","ShaderProgram","vertexSource","fragmentSource","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","use","useProgram","setMat4","uniformName","uniformMatrix4fv","getUniformLocation","setInt","uniform1i","Texture","create","createTexture","bindTexture","TEXTURE_2D","pixel","Uint8Array","texImage2D","RGBA","UNSIGNED_BYTE","then","texParameteri","TEXTURE_WRAP_S","REPEAT","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","bind","getUV","TextureManager","add","indexMap","has","delete","UNIFORM_MVP","UNIFORM_SAMPLERS","ATTRIB_POSITION","ATTRIB_TEXTURE_COORD","ATTRIB_TEXTURE_IDX","ATTRIB_COLOR","BATCH_VERTEX_SHADER_SOURCE","BATCH_FRAGMENT_SHADER_SOURCE","Batch2D","shaderProgram","vertices","Float32Array","maxSprites","indices","indicesSize","Uint16Array","createIndices","VAO","createVertexArray","VBO","createBuffer","EBO","bindVertexArray","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","locPosition","getAttribLocation","vertexAttribPointer","FLOAT","enableVertexAttribArray","locTextureCoord","locTextureIdx","locColor","ELEMENT_ARRAY_BUFFER","STATIC_DRAW","vertexIndex","indexCount","begin","emplace","tileValue","position","color","tileData","r","g","b","textureIdx","textureManager","getIndex","flush","bufferSubData","subarray","render","forEach","activeTexture","TEXTURE0","drawElements","TRIANGLES","UNSIGNED_SHORT","textures","zoomLevels","Camera","setOrigin","origin","clientOrigin","moveTo","cameraZ","calculateMvp","setZoom","zoom","clampZoom","applyZoom","abs","zoomLevel","min","perceivedWidth","perceivedHeight","getMvp","mvp","getZoomLevel","computedPositionX","computedPositionY","mat4","ortho","projection","near","far","multiply","modelView","translate","RendererInstance","enable","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","camera","batch","setClearColor","clearColor","clear","COLOR_BUFFER_BIT","renderGrid","requestAnimationFrame","canvasWidth","canvasHeight","layersState","WebGLCanvas","tilesCanvasRef","useRef","useEffect","current","clientWidth","clientHeight","getContext","ref","EditorCanvas","editingCanvasRef","selectedLayer","refElement","cancelWheel","event","preventDefault","addEventListener","passive","removeEventListener","panToolStartHandler","key","panToolEndHandler","handleContinuousTools","undefined","onWheel","altKey","deltaY","onMouseDown","handleOneTimeTools","onDrag","draggable","Canvas","TabButton","routerPath","activeClassName","_extends","Object","assign","arguments","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","maskUnits","fillRule","clipRule","d","mask","transform","stroke","strokeWidth","SvgLogo","_ref","svgRef","title","titleId","props","viewBox","xmlns","ForwardRef","TabSelector","sections","icon","mdiViewModule","mdiMap","mdiUpload","mdiContentSave","mdiCog","mdiHelpCircleOutline","section","Tab","children","getLayersState","getLayers","getLayersNames","getLayerByName","getLayersByAddedTime","reverse","CollapseSection","useState","open","setOpen","mdiMenuDown","mdiMenuRight","sectionClass","onDoubleClick","isOpened","LayerItem","index","isSelected","handleLayerClick","handleEyeClick","mdiEye","mdiEyeOffOutline","selectedClassName","visibilityTestId","draggableId","provided","snapshop","style","cursor","draggableProps","innerRef","dragHandleProps","LayerListFooter","mdiPlaylistPlus","mdiDelete","LayerList","layerComponents","l","LayerListItem","dndArea","onDragEnd","destination","onBeforeDragStart","droppableId","droppableProps","placeholder","TilesetFooter","TilesetPreview","setSelectedTile","setTilesetIndex","tilegridCanvasRef","tilesetCanvasRef","tilesetCanvas","tilegridCanvas","reader","FileReader","onload","image","Image","drawImage","tileDimensions","context","strokeStyle","lineWidth","beginPath","lineTo","drawGridLines","src","result","readAsDataURL","fillStyle","clearRect","fillRect","onMouseUp","tilePos","Select","options","onChange","TilesetSelector","lastSelectedTileset","Button","text","FileInput","onUpload","opacity","overflow","zIndex","htmlFor","TilesetManager","onTilesetUpload","files","Edit","TilesetSettings","SliderInput","MapSettings","setTileSize","ImportSettings","FormatSelector","onOptionSelected","formatOptions","ExportSettings","setFormat","handleExport","rawData","filename","blob","Blob","document","createElement","href","URL","createObjectURL","download","click","ProjectSettings","Help","Sidebar","App","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.fce8654e.chunk.js","sourcesContent":["export const ADD_TILESET = \"[TILESET] Add one\";\nexport const LOAD_EXISTING_TILESETS = \"[TILESET] Load existing textures\";\nexport const COMPLETE_TEXTURE_LOADING = \"[TILESET] Texture loading complete\";\nexport const SELECT_TILESET = \"[TILESET] Select\";\nexport const DELETE_TILESET = \"[TILESET] Delete\";\nexport const SELECT_TILE = \"[TILE] Select\";\n\nexport const SELECT_TOOL = \"[TOOL] Select\";\n\nexport const ADD_LAYER = \"[LAYER] Add one\";\nexport const DELETE_LAYER = \"[LAYER] Delete\";\nexport const SELECT_LAYER = \"[LAYER] Select\";\nexport const MOVE_LAYER = \"[LAYER] Move\";\nexport const TOGGLE_LAYER_VISIBILITY = \"[LAYER] Toggle Visibility\";\n","import {\n  ADD_TILESET,\n  LOAD_EXISTING_TILESETS,\n  COMPLETE_TEXTURE_LOADING,\n  SELECT_TILESET,\n  DELETE_TILESET,\n  SELECT_TILE,\n  SELECT_TOOL,\n  ADD_LAYER,\n  DELETE_LAYER,\n  SELECT_LAYER,\n  MOVE_LAYER,\n  TOGGLE_LAYER_VISIBILITY,\n} from \"redux/actionTypes\";\n\nexport const addTileset = (name, data) => ({\n  type: ADD_TILESET,\n  payload: { name, data },\n});\n\nexport const loadExistingTilesets = (names) => ({\n  type: LOAD_EXISTING_TILESETS,\n  payload: { names },\n});\n\nexport const completeTextureLoading = (names) => ({\n  type: COMPLETE_TEXTURE_LOADING,\n  payload: {},\n});\n\nexport const selectTileset = (name) => ({\n  type: SELECT_TILESET,\n  payload: { name },\n});\n\nexport const deleteTileset = (name) => ({\n  type: DELETE_TILESET,\n  payload: { name },\n});\n\nexport const selectTile = (value) => ({\n  type: SELECT_TILE,\n  payload: { value },\n});\n\nexport const selectTool = (tool) => ({\n  type: SELECT_TOOL,\n  payload: { tool },\n});\n\nexport const addLayer = (name, x, y, width, height) => ({\n  type: ADD_LAYER,\n  payload: { name, x, y, width, height },\n});\n\nexport const deleteLayer = (name) => ({\n  type: DELETE_LAYER,\n  payload: { name },\n});\n\nexport const selectLayer = (name) => ({\n  type: SELECT_LAYER,\n  payload: { name },\n});\n\nexport const moveLayer = (name, to) => ({\n  type: MOVE_LAYER,\n  payload: { name, to },\n});\n\nexport const toggleLayerVisibility = (name) => ({\n  type: TOGGLE_LAYER_VISIBILITY,\n  payload: { name },\n});\n","export const DEFAULT_TOOL = \"DEFAULT_TOOL\";\nexport const PLACEMENT_TOOL = \"PLACEMENT_TOOL\";\nexport const FILL_TOOL = \"FILL_TOOL\";\nexport const MOVE_TOOL = \"MOVE_TOOL\";\nexport const PAN_TOOL = \"PAN_TOOL\";\n","export const TAB_TILES = \"tiles\";\nexport const TAB_MAP = \"map\";\nexport const TAB_IMPORT = \"import\";\nexport const TAB_EXPORT = \"save\";\nexport const TAB_SETTINGS = \"settings\";\nexport const TAB_HELP = \"help\";\n","import * as tools from \"resources/tools\";\nimport * as tabs from \"resources/tabs\";\n\nconst tooltips = new Map();\n\ntooltips.set(tools.DEFAULT_TOOL, \"default tool\");\ntooltips.set(tools.PLACEMENT_TOOL, \"placement tool\");\ntooltips.set(tools.FILL_TOOL, \"fill tool\");\ntooltips.set(tools.MOVE_TOOL, \"move tool\");\n\ntooltips.set(tabs.TAB_TILES, \"tab tiles\");\ntooltips.set(tabs.TAB_MAP, \"tab map\");\ntooltips.set(tabs.TAB_IMPORT, \"tab import\");\ntooltips.set(tabs.TAB_EXPORT, \"tab export\");\ntooltips.set(tabs.TAB_SETTINGS, \"settings tab\");\ntooltips.set(tabs.TAB_HELP, \"help tab\");\n\nexport default tooltips;\n","export const TILEMAP_CANVAS_ID = \"tilemap-canvas\";\nexport const EDITOR_CANVAS_ID = \"editor-canvas\";\nexport const GRID_CANVAS_ID = \"grid-canvas\";\nexport const TILESET_CANVAS_ID = \"tileset-canvas\";\nexport const LOCAL_STORAGE_LAST_SELECTED_TILESET = \"lastSelectedTileset\";\n\nexport const ADD_TILESET_TITLE = \"Add Tileset\";\n\nexport const GRID_COLOR = \"#dddddd\";\nexport const SELECTED_TILE_COLOR_OVERLAY = \"rgba(79, 70, 229, 0.4)\";\n\nexport const TOOLTIP_DELAY = 600;\nexport const TOOLBAR_ICON_SIZE = 0.68;\n","import { connect, useDispatch, useSelector } from \"react-redux\";\nimport { selectTool } from \"redux/actions\";\nimport ReactTooltip from \"react-tooltip\";\nimport Icon from \"@mdi/react\";\nimport tooltips from \"resources/tooltips\";\nimport * as testIds from \"resources/testIds\";\nimport { TOOLTIP_DELAY, TOOLBAR_ICON_SIZE } from \"ui/constants\";\n\nconst Tool = ({ iconPath, tool }) => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const dispatch = useDispatch();\n  const selectedTool = useSelector((state) => state.canvas.selectedTool);\n\n  // ====================================\n  // Logic\n  // ====================================\n  const handleOnClick = () => {\n    dispatch(selectTool(tool));\n  };\n\n  // ====================================\n  // Render\n  // ====================================\n  const iconClasses =\n    tool === selectedTool ? \"text-indigo-400 hover:text-indigo-500\" : \"hover:text-indigo-500 cursor-pointer\";\n  return (\n    <button\n      className=\"px-4 py-2 cursor-default\"\n      role=\"button\"\n      data-testid={tool === selectedTool ? testIds.SELECTED_TOOL : \"\"}\n    >\n      <div className={iconClasses} onClick={handleOnClick} data-tip data-for={tool} data-testid={tool}>\n        <Icon path={iconPath} size={TOOLBAR_ICON_SIZE} />\n      </div>\n      <ReactTooltip id={tool} place=\"bottom\" effect=\"solid\" delayShow={TOOLTIP_DELAY}>\n        {tooltips.get(tool)}\n      </ReactTooltip>\n    </button>\n  );\n};\n\nexport default Tool;\n","export const SELECTED_TOOL = \"selected-tool\";\nexport const SELECT_TAG = \"select-tag\";\nexport const ADD_LAYER_BUTTON = \"add-layer-button\";\nexport const DELETE_LAYER_BUTTON = \"delete-layer-button\";\nexport const HIDE_LAYER_BUTTON = \"hide-layer-button\";\nexport const LAYER_VISIBLE = \"layer-visible\";\nexport const LAYER_HIDDEN = \"layer-hidden\";\n","export const dividerBorderColor = \"border-gray-600\";\nexport const titleBarHeight = \"h-7\";\nexport const toolbarHeight = titleBarHeight;\n","import React from \"react\";\nimport Tool from \"ui/canvas/Tool\";\nimport { dividerBorderColor, toolbarHeight } from \"resources/styles\";\nimport { mdiPencil, mdiPail, mdiSelect, mdiCursorDefaultOutline, mdiCursorMove } from \"@mdi/js\";\nimport * as tools from \"resources/tools\";\n\nconst Toolbar = () => {\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <nav className={`flex flex-row items-stretch bg-black border-b border-r ${dividerBorderColor} ${toolbarHeight}`}>\n      <div className=\"flex flex-row justify-start items-center flex-grow\">\n        <Tool iconPath={mdiCursorDefaultOutline} tool={tools.DEFAULT_TOOL} />\n        <Tool iconPath={mdiPencil} tool={tools.PLACEMENT_TOOL} />\n        <Tool iconPath={mdiPail} tool={tools.FILL_TOOL} />\n        <Tool iconPath={mdiCursorMove} tool={tools.MOVE_TOOL} />\n      </div>\n    </nav>\n  );\n};\n\nexport default Toolbar;\n","import {\n  ADD_TILESET,\n  LOAD_EXISTING_TILESETS,\n  COMPLETE_TEXTURE_LOADING,\n  SELECT_TILESET,\n  DELETE_TILESET,\n  SELECT_TILE,\n} from \"redux/actionTypes\";\n\nconst initialState = {\n  tilesetNames: [],\n  selectedTileset: \"\",\n  selectedTile: -1,\n  hasLoadedTextures: false,\n};\n\nexport default function (state = initialState, action) {\n  switch (action.type) {\n    case LOAD_EXISTING_TILESETS: {\n      const { names } = action.payload;\n\n      return {\n        ...state,\n        tilesetNames: names,\n      };\n    }\n\n    case COMPLETE_TEXTURE_LOADING: {\n      return {\n        ...state,\n        hasLoadedTextures: true,\n      };\n    }\n\n    case ADD_TILESET: {\n      const { name } = action.payload;\n      return {\n        ...state,\n        tilesetNames: [...state.tilesetNames, name],\n        selectedTileset: name,\n      };\n    }\n\n    case SELECT_TILESET: {\n      const { name } = action.payload;\n      return {\n        ...state,\n        selectedTileset: name,\n      };\n    }\n\n    case DELETE_TILESET: {\n      const { name } = action.payload;\n      const newTilesetNames = state.tilesetNames.filter((n) => n !== name);\n\n      let newSelected = state.selectedTileset;\n\n      // If the selected layer is the layer we are deleting and\n      // it is not the last layer, select a new index.\n      if (newSelected === name && newTilesetNames.length > 0) {\n        const idx = Math.max(state.tilesetNames.indexOf(name) - 1, 0);\n        newSelected = newTilesetNames[idx];\n      } else if (newTilesetNames.length == 0) {\n        newSelected = \"\";\n      }\n\n      return {\n        ...state,\n        selectedTileset: newSelected,\n        tilesetNames: newTilesetNames,\n      };\n    }\n\n    case SELECT_TILE: {\n      const { value } = action.payload;\n      return {\n        ...state,\n        selectedTile: value,\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n","import { SELECT_TOOL } from \"redux/actionTypes\";\n\nimport { DEFAULT_TOOL } from \"resources/tools\";\n\nconst initialState = {\n  selectedTool: DEFAULT_TOOL,\n};\n\nexport default function (state = initialState, action) {\n  switch (action.type) {\n    case SELECT_TOOL: {\n      const { tool } = action.payload;\n      return {\n        ...state,\n        selectedTool: tool,\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n","import { ADD_LAYER, DELETE_LAYER, SELECT_LAYER, MOVE_LAYER, TOGGLE_LAYER_VISIBILITY } from \"redux/actionTypes\";\n\nconst initialState = {\n  selected: \"\",\n  names: [],\n  layers: {},\n  lastIdx: 0,\n};\n\nexport default function (state = initialState, action) {\n  switch (action.type) {\n    case ADD_LAYER: {\n      let { name } = action.payload;\n\n      // If name is not provided, add a default one\n      if (!name) {\n        name = `Layer ${state.lastIdx + 1}`;\n      }\n\n      return {\n        ...state,\n        names: [...state.names, name],\n        layers: {\n          ...state.layers,\n          [name]: {\n            id: state.lastIdx,\n            visible: true,\n          },\n        },\n        selected: name,\n        lastIdx: state.lastIdx + 1,\n      };\n    }\n\n    case DELETE_LAYER: {\n      const { name } = action.payload;\n      const { [name]: value, ...newLayers } = state.layers;\n      const newIds = state.names.filter((id) => id !== name);\n\n      let newSelected = state.selected;\n\n      // If the selected layer is the layer we are deleting and\n      // it is not the last layer, select a new index.\n      if (newSelected === name && newIds.length > 0) {\n        const idx = Math.max(state.names.indexOf(name) - 1, 0);\n        newSelected = newIds[idx];\n      } else if (newIds.length === 0) {\n        newSelected = \"\";\n      }\n\n      return {\n        ...state,\n        names: newIds,\n        layers: newLayers,\n        selected: newSelected,\n      };\n    }\n\n    case SELECT_LAYER: {\n      const { name } = action.payload;\n      return {\n        ...state,\n        selected: name,\n      };\n    }\n\n    case MOVE_LAYER: {\n      const { name, to } = action.payload;\n      const from = state.names.indexOf(name);\n      const reorderedNames = state.names;\n\n      // If the layer exists\n      if (from !== -1) {\n        reorderedNames.splice(from, 1);\n        reorderedNames.splice(to, 0, name);\n      }\n\n      return {\n        ...state,\n        names: reorderedNames,\n      };\n    }\n\n    case TOGGLE_LAYER_VISIBILITY: {\n      const { name } = action.payload;\n      return {\n        ...state,\n        layers: {\n          ...state.layers,\n          [name]: {\n            ...state.layers[name],\n            visible: !state.layers[name].visible,\n          },\n        },\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n","import { combineReducers } from \"redux\";\nimport tileset from \"redux/reducers/tileset\";\nimport canvas from \"redux/reducers/canvas\";\nimport layers from \"redux/reducers/layers\";\n\nexport default combineReducers({ tileset, canvas, layers });\n","export const FORMAT_JSON = \"json\";\nexport const FORMAT_TMX = \"tmx\";\n","import { set, get, del, keys, Store } from \"idb-keyval\";\nimport TileManagerInstance from \"renderer/TileManager\";\nimport { selectTileset } from \"redux/actions\";\nimport { LOCAL_STORAGE_LAST_SELECTED_TILESET } from \"ui/constants\";\nimport reduxStore from \"redux/store\";\nimport { completeTextureLoading } from \"redux/actions\";\n\nconst textureStore = new Store(\"textures-store\", \"textures\");\n\n// Gets all texture names available\nexport const getTextureNames = async () => {\n  try {\n    const textureNames = await keys(textureStore);\n    return textureNames;\n  } catch (err) {\n    console.error(err);\n    return [];\n  }\n};\n\nexport const getTextureData = async (name) => {\n  try {\n    const data = await get(name, textureStore);\n    return data;\n  } catch (err) {\n    console.error(err);\n    return null;\n  }\n};\n\nexport const setTextureData = async (name, data) => {\n  // TODO: If the texture already exists, choose a new name\n  try {\n    await set(name, { file: data, tilesetIndex: TileManagerInstance.lastId }, textureStore);\n    await TileManagerInstance.addTilesFromTileset(name, [32, 32]);\n    localStorage.setItem(LOCAL_STORAGE_LAST_SELECTED_TILESET, name);\n  } catch (err) {\n    console.error(err);\n  }\n};\n\nexport const deleteTextureData = async (name) => {\n  try {\n    await del(name, textureStore);\n    const lastSelectedTileset = localStorage.getItem(LOCAL_STORAGE_LAST_SELECTED_TILESET);\n    if (lastSelectedTileset === name) {\n      localStorage.removeItem(LOCAL_STORAGE_LAST_SELECTED_TILESET);\n    }\n  } catch (err) {\n    console.error(err);\n  }\n};\n\nexport const hasTexture = async (name) => {\n  try {\n    const textureKeys = await keys(textureStore);\n    return textureKeys.includes(name);\n  } catch (err) {\n    console.error(err);\n    return false;\n  }\n};\n\nexport const loadTilesFromExistingTilesets = async (tilesets) => {\n  // Return if tiles where already loaded\n  if (TileManagerInstance.lastId > 0) {\n    return;\n  }\n  // Create tiles from textures\n  // Respects order of creation\n  // TODO: replace hardcoded 32 x 32 tile size with a user defined one\n  for (const tileset of tilesets) {\n    try {\n      const textureExists = await hasTexture(tileset);\n      if (!textureExists) {\n        continue;\n      }\n\n      const tilesetIndex = await TileManagerInstance.addTilesFromTileset(tileset, [32, 32]);\n\n      // Update idb texture with the new index\n      const data = await get(tileset, textureStore);\n      data.tilesetIndex = tilesetIndex;\n      await set(tileset, data, textureStore);\n    } catch (err) {\n      console.error(err);\n    }\n  }\n\n  reduxStore.dispatch(completeTextureLoading());\n};\n","import { getTextureData } from \"idbTextureStore\";\n\nexport const fileToBase64 = (file) => {\n  if (!file) {\n    return null;\n  }\n\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = (error) => reject(error);\n    reader.readAsDataURL(file);\n  });\n};\n\nexport const getImageBitmap = async (name) => {\n  try {\n    const fileData = await getTextureData(name);\n    if (!fileData.file) {\n      return null;\n    }\n\n    return createImageBitmap(fileData.file);\n  } catch (err) {\n    console.error(err);\n    return null;\n  }\n};\n\n//export const getFileName = (fullpath) => {\n//return fullpath.split('\\\\').pop().split('/').pop();\n//}\n\n//const base64ToFile = (data) => {\n//const raw = window.atob(data);\n//const rawLength = raw.length;\n//const bytes = new Uint8Array(rawLength);\n\n//for (let i = 0; i < rawLength; i++) {\n//bytes[i] = raw.charCodeAt(i);\n//}\n\n//return bytes;\n//}\n","export const getTilePositionOnClick = (e, tileSize, offset) => {\n  offset = offset || [0.0, 0.0];\n  const bounds = e.target.getBoundingClientRect();\n  const w = Math.floor(e.target.width / tileSize[0]);\n  const x = Math.floor((e.clientX + offset[0] - bounds.left) / tileSize[0]);\n  const y = Math.floor((e.clientY + offset[1] - bounds.top) / tileSize[1]);\n  return [x, y];\n};\n\nexport const getTileUV = (frame, frameSize, textureSize) => {\n  // TODO: Better handling of out of bounds frame sizes\n  if (frameSize[0] >= textureSize[0] || frameSize[1] >= textureSize[1]) {\n    return [\n      [0.0, 0.0],\n      [0.0, 0.0],\n      [0.0, 0.0],\n      [0.0, 0.0],\n    ];\n  }\n\n  const frameWidth = (frameSize[0] * 1.0) / textureSize[0];\n  const frameHeight = (frameSize[1] * 1.0) / textureSize[1];\n  const hFrames = Math.floor(textureSize[0] / frameSize[0]);\n  const vFrames = Math.floor(textureSize[1] / frameSize[1]);\n  const maxFrames = hFrames * vFrames;\n\n  const frameX = Math.floor(frame % hFrames);\n  const frameY = Math.floor((frame % maxFrames) / hFrames);\n  // Multiply the x coord of the frame in the texture atlas by the normalized value of the width one frame.\n  const topLeftX = (frameX * (textureSize[0] / hFrames) * 1.0) / textureSize[0];\n  // Multiply the y coord of the frame in the tile map by the normalized value of the height one frame.\n  // Invert the value as the y axis is upwards for OpenGL\n  const topLeftY = (frameY * (textureSize[1] / vFrames)) / textureSize[1];\n\n  return [\n    [topLeftX, topLeftY], // top-left\n    [topLeftX + frameWidth, topLeftY], // top-right\n    [topLeftX + frameWidth, topLeftY + frameHeight], // bottom-right\n    [topLeftX, topLeftY + frameHeight], // bottom-left\n  ];\n};\n","import { getImageBitmap } from \"utils/file\";\nimport { getTileUV } from \"utils/tile\";\n\nclass TileManager {\n  constructor() {\n    this.tiles = [];\n    this.lastId = 0;\n  }\n\n  // Add tiles to local tileset and returns the tile index\n  addTilesFromTileset = async (texture, tileSize) => {\n    const bitmap = await getImageBitmap(texture);\n    const hFrames = Math.floor(bitmap.width / tileSize[0]);\n    const vFrames = Math.floor(bitmap.height / tileSize[1]);\n    const tileIndex = this.lastId;\n\n    for (let i = 0; i < vFrames; i++) {\n      for (let j = 0; j < hFrames; j++) {\n        const idx = i * hFrames + j;\n        const uv = getTileUV(idx, tileSize, [bitmap.width, bitmap.height]);\n        this.tiles[this.lastId] = {\n          size: tileSize,\n          tileset: texture,\n          uv: uv,\n        };\n        ++this.lastId;\n      }\n    }\n\n    return tileIndex;\n  };\n\n  get = (tile) => {\n    // Bound checking\n    if (tile < 0 || tile >= this.tiles.length) {\n      return null;\n    }\n\n    return this.tiles[tile];\n  };\n}\n\nconst TileManagerInstance = new TileManager();\n\nexport default TileManagerInstance;\n","import TilemapInstance from \"tilemap\";\nimport TileManagerInstance from \"renderer/TileManager\";\nimport reduxStore from \"redux/store\";\nimport { getTextureData } from \"idbTextureStore\";\n\nconst exportJson = async () => {\n  const exportObject = {};\n  exportObject[\"map\"] = {};\n\n  const state = reduxStore.getState();\n\n  // If layers have not been initialized, don't try to touch them abort exporting\n  if (!state.layers || !state.layers.layers) {\n    console.error(\"There are no layers in the current project.\");\n    return JSON.stringify(exportObject);\n  }\n\n  // ========================\n  // Layer\n  // ========================\n  const layerNames = state.layers.names;\n  const layers = state.layers.layers;\n\n  exportObject[\"map\"][\"layers\"] = [];\n\n  for (const layerName of layerNames) {\n    const layer = layers[layerName];\n    const layerWidth = 10;\n    const layerHeight = 10;\n    const layerX = 0;\n    const layerY = 0;\n    const layerObj = {};\n    layerObj[\"name\"] = layerName;\n\n    layerObj[\"width\"] = TilemapInstance.layerWidth(layer.id);\n    layerObj[\"height\"] = TilemapInstance.layerHeight(layer.id);\n    layerObj[\"x\"] = TilemapInstance.layerX(layer.id);\n    layerObj[\"y\"] = TilemapInstance.layerY(layer.id);\n    layerObj[\"data\"] = [];\n\n    for (let y = 0; y < layerHeight; y++) {\n      for (let x = 0; x < layerWidth; x++) {\n        const value = TilemapInstance.get(x, y, layer.id);\n        layerObj[\"data\"].push(value);\n      }\n    }\n\n    exportObject[\"map\"][\"layers\"].push(layerObj);\n  }\n\n  // ========================\n  // Tileset\n  // ========================\n  const tilesetNames = state.tileset.tilesetNames;\n  exportObject[\"tilesets\"] = [];\n\n  for (const tilesetName of tilesetNames) {\n    const tilesetObj = {};\n\n    // Tileset name\n    tilesetObj[\"name\"] = tilesetName;\n\n    // Tile index:\n    // There's an array containing all tiles from all\n    // tilesets packed together. This index is where the\n    // tiles from this particular tileset start.\n    const data = await getTextureData(tilesetName);\n    tilesetObj[\"tileIndex\"] = data.tilesetIndex;\n\n    exportObject[\"tilesets\"].push(tilesetObj);\n  }\n\n  // ========================\n  // Tiles\n  // ========================\n  exportObject[\"tiles\"] = TileManagerInstance.tiles;\n\n  return JSON.stringify(exportObject);\n};\n\nexport default exportJson;\n","import * as formats from 'resources/formats';\nimport { exportJson } from 'utils/export';\n\nclass Tilemap {\n  constructor() {\n    this.hasInitialized = false;\n  }\n\n  init = async (width, height) => {\n    try {\n      this.wasm = await import('./pkg');\n      const { memory } = await import('./pkg/tilemap_bg');\n      this.map = this.wasm.Tilemap.new();\n      this.memory = memory;\n      this.hasInitialized = true;\n    } catch (err) {\n      console.error(`[x] Error loading grid: ${err.message}`);\n    }\n  }\n\n  width = () => {\n    return this.map.width();\n  }\n\n  height = () => {\n    return this.map.height();\n  }\n\n  addLayer = (x, y, width, height) => {\n    // Set default position to (0,0)\n    if (!x || !y) {\n      x = 0;\n      y = 0;\n    }\n\n    // Set default size to the map size\n    if (!width || !height) {\n      width = TilemapInstance.width();\n      height = TilemapInstance.height();\n    }\n\n    this.map.add_layer(x, y, width, height);\n  }\n\n  get = (x, y, layerId) => {\n    return this.map.get(x, y, layerId);\n  }\n\n  set = (x, y, value, layerId) => {\n    this.map.set(x, y, value, layerId);\n  }\n\n  fill = (x, y, targetValue, layerId) => {\n    this.map.fill(x, y, targetValue, layerId);\n  }\n\n  layerWidth = (layerId) => {\n    return this.map.layer_width(layerId);\n  }\n\n  layerHeight = (layerId) => {\n    return this.map.layer_height(layerId);\n  }\n\n  layerX = (layerId) => {\n    return this.map.layer_x(layerId);\n  }\n\n  layerY = (layerId) => {\n    return this.map.layer_y(layerId);\n  }\n\n  export = (format) => {\n    switch (format) {\n      case formats.FORMAT_JSON:\n        return exportJson();\n      default:\n        return null;\n    }\n  }\n}\n\nconst TilemapInstance = new Tilemap();\nexport default TilemapInstance;\n","import { compose, createStore, applyMiddleware } from \"redux\";\nimport rootReducer from \"redux/reducers\";\nimport { tilemapReduxMiddleware, idbReduxMiddleware } from \"redux/middlewares\";\n\n// Remove Redux Devtools in production\nconst composeEnhancer = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst store = createStore(rootReducer, composeEnhancer(applyMiddleware(tilemapReduxMiddleware, idbReduxMiddleware)));\nexport default store;\n","import TilemapInstance from \"tilemap\";\nimport { setTextureData, deleteTextureData, loadTilesFromExistingTilesets } from \"idbTextureStore\";\nimport { ADD_TILESET, DELETE_TILESET, LOAD_EXISTING_TILESETS, ADD_LAYER, DELETE_LAYER } from \"redux/actionTypes\";\n\nexport const idbReduxMiddleware = (store) => (next) => (action) => {\n  switch (action.type) {\n    case ADD_TILESET: {\n      const { name, data } = action.payload || {};\n      setTextureData(name, data);\n      break;\n    }\n\n    case LOAD_EXISTING_TILESETS: {\n      const { names } = action.payload || {};\n      loadTilesFromExistingTilesets(names);\n      break;\n    }\n\n    case DELETE_TILESET: {\n      const { name } = action.payload || {};\n      deleteTextureData(name);\n      break;\n    }\n\n    default:\n      break;\n  }\n\n  return next(action);\n};\n\nexport const tilemapReduxMiddleware = (store) => (next) => (action) => {\n  switch (action.type) {\n    case ADD_LAYER: {\n      let { x, y, width, height } = action.payload || {};\n      TilemapInstance.addLayer(x, y, width, height);\n      break;\n    }\n\n    case DELETE_LAYER: {\n      // TODO: Implement layer deletion\n      break;\n    }\n\n    default:\n      break;\n  }\n\n  return next(action);\n};\n","function createShader(gl, source, type) {\n  const shader = gl.createShader(type);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    const info = gl.getShaderInfoLog(shader);\n    console.error(\"Could not compile shader: \" + info);\n  }\n\n  return shader;\n}\n\nclass ShaderProgram {\n  constructor(gl, vertexSource, fragmentSource) {\n    this.gl = gl;\n    this.vertexSource = vertexSource;\n    this.fragmentSource = fragmentSource;\n    this.init();\n  }\n\n  init = () => {\n    const vertexShader = createShader(this.gl, this.vertexSource, this.gl.VERTEX_SHADER);\n    const fragmentShader = createShader(this.gl, this.fragmentSource, this.gl.FRAGMENT_SHADER);\n\n    this.id = this.gl.createProgram();\n    this.gl.attachShader(this.id, vertexShader);\n    this.gl.attachShader(this.id, fragmentShader);\n    this.gl.linkProgram(this.id);\n\n    if (!this.gl.getProgramParameter(this.id, this.gl.LINK_STATUS)) {\n      console.error(\"Unable to initialize the shader program: \" + this.gl.getProgramInfoLog(this.id));\n      return null;\n    }\n  };\n\n  use = () => {\n    this.gl.useProgram(this.id);\n  };\n\n  setMat4 = (uniformName, value) => {\n    this.gl.uniformMatrix4fv(this.gl.getUniformLocation(this.id, uniformName), false, value);\n  };\n\n  setInt = (uniformName, value) => {\n    this.gl.uniform1i(this.gl.getUniformLocation(this.id, uniformName), value);\n  };\n}\n\nexport default ShaderProgram;\n","import { getImageBitmap } from \"utils/file\";\nimport { getTileUV } from \"utils/tile\";\n\nclass Texture {\n  constructor(gl, name) {\n    this.name = name;\n    this.create(gl);\n  }\n\n  create = (gl) => {\n    this.id = gl.createTexture();\n\n    gl.bindTexture(gl.TEXTURE_2D, this.id);\n\n    this.width = 1;\n    this.height = 1;\n    const pixel = new Uint8Array([0, 0, 0, 0]);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, pixel);\n\n    getImageBitmap(this.name).then((bitmap) => {\n      if (!bitmap) {\n        return;\n      }\n\n      this.width = bitmap.width;\n      this.height = bitmap.height;\n\n      gl.bindTexture(gl.TEXTURE_2D, this.id);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, bitmap);\n\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    });\n  };\n\n  bind = (gl) => {\n    gl.bindTexture(gl.TEXTURE_2D, this.id);\n  };\n\n  getUV = (frame, frameSize) => {\n    return getTileUV(frame, frameSize, [this.width, this.height]);\n    //// If the texture has not been initialized yet\n    //if (this.width == 1 && this.height == 1) {\n    //return [\n    //[0.0, 0.0],\n    //[0.0, 0.0],\n    //[0.0, 0.0],\n    //[0.0, 0.0],\n    //];\n    //}\n\n    //const frameWidth  = (frameSize[0] * 1.0) / this.width;\n    //const frameHeight = (frameSize[1] * 1.0) / this.height;\n    //const hFrames = Math.floor(this.width / frameSize[0]);\n    //const vFrames = Math.floor(this.height / frameSize[1]);\n    //const maxFrames = hFrames * vFrames;\n\n    //const frameX = Math.floor(frame % hFrames);\n    //const frameY = Math.floor((frame % maxFrames) / hFrames);\n    //// Multiply the x coord of the frame in the texture atlas by the normalized value of the width one frame.\n    //const topLeftX = frameX * (this.width / hFrames) * 1.0 / this.width;\n    //// Multiply the y coord of the frame in the tile map by the normalized value of the height one frame.\n    //// Invert the value as the y axis is upwards for OpenGL\n    //const topLeftY = frameY * (this.height / vFrames) / this.height;\n\n    //return [\n    //[topLeftX, topLeftY],\n    //[topLeftX + frameWidth, topLeftY],\n    //[topLeftX + frameWidth, topLeftY + frameHeight],\n    //[topLeftX, topLeftY + frameHeight],\n    //];\n  };\n}\n\nexport default Texture;\n","import Texture from \"renderer/Texture\";\n\nclass TextureManager {\n  constructor() {\n    this.map = new Map();\n    this.indexMap = new Map();\n  }\n\n  add = (gl, name) => {\n    this.indexMap.set(name, this.map.size);\n    this.map.set(name, new Texture(gl, name));\n  };\n\n  get(name) {\n    return this.map.get(name);\n  }\n\n  getIndex(name) {\n    return this.indexMap.get(name);\n  }\n\n  has(name) {\n    return this.map.has(name);\n  }\n\n  remove(name) {\n    this.map.delete(name);\n  }\n}\n\nexport default TextureManager;\n","export const UNIFORM_PROJECTION = \"uProjectionMatrix\";\nexport const UNIFORM_MVP = \"uMVP\";\nexport const UNIFORM_SAMPLERS = \"uSamplers\";\n\nexport const ATTRIB_POSITION = \"aPosition\";\nexport const ATTRIB_TEXTURE_COORD = \"aTextureCoord\";\nexport const ATTRIB_TEXTURE_IDX = \"aTextureIdx\";\nexport const ATTRIB_COLOR = \"aColor\";\n\nexport const BATCH_VERTEX_SHADER_SOURCE = `#version 300 es\n\n      in vec2 ${ATTRIB_POSITION};\n      in float ${ATTRIB_TEXTURE_IDX};\n      in vec2 ${ATTRIB_TEXTURE_COORD};\n      in vec4 ${ATTRIB_COLOR};\n\n      out vec2 vTextureCoord;\n      out float vTextureIdx;\n      out vec4 vColor;\n\n      uniform mat4 ${UNIFORM_MVP};\n\n      void main() {\n        gl_Position = ${UNIFORM_MVP} * vec4(aPosition, 0.0, 1.0);\n        vTextureCoord = ${ATTRIB_TEXTURE_COORD};\n        vTextureIdx = ${ATTRIB_TEXTURE_IDX};\n        vColor = ${ATTRIB_COLOR};\n      }\n      `;\n\nexport const BATCH_FRAGMENT_SHADER_SOURCE = `#version 300 es\n\n      precision mediump float;\n\n      in vec2 vTextureCoord;\n      in float vTextureIdx;\n      in vec4 vColor;\n\n      out vec4 oColor;\n\n      uniform sampler2D ${UNIFORM_SAMPLERS}[11];\n\n      void main() {\n        vec4 finalColor = vec4(0.0);\n        int tid = int(vTextureIdx + 0.5);\n\n        switch (tid)\n        {\n          case 0:\n            finalColor = texture(${UNIFORM_SAMPLERS}[0], vTextureCoord);\n            break;\n          case 1:\n            finalColor = texture(${UNIFORM_SAMPLERS}[1], vTextureCoord);\n            break;\n          case 2:\n            finalColor = texture(${UNIFORM_SAMPLERS}[2], vTextureCoord);\n            break;\n          case 3:\n            finalColor = texture(${UNIFORM_SAMPLERS}[3], vTextureCoord);\n            break;\n          case 4:\n            finalColor = texture(${UNIFORM_SAMPLERS}[4], vTextureCoord);\n            break;\n          case 5:\n            finalColor = texture(${UNIFORM_SAMPLERS}[5], vTextureCoord);\n            break;\n          case 6:\n            finalColor = texture(${UNIFORM_SAMPLERS}[6], vTextureCoord);\n            break;\n          case 7:\n            finalColor = texture(${UNIFORM_SAMPLERS}[7], vTextureCoord);\n            break;\n          case 8:\n            finalColor = texture(${UNIFORM_SAMPLERS}[8], vTextureCoord);\n            break;\n          case 9:\n            finalColor = texture(${UNIFORM_SAMPLERS}[9], vTextureCoord);\n            break;\n          case 10:\n            finalColor = texture(${UNIFORM_SAMPLERS}[10], vTextureCoord);\n            break;\n        }\n\n        oColor = finalColor;\n      }\n      `;\n","import TextureManager from \"renderer/TextureManager\";\nimport TileManagerInstance from \"renderer/TileManager\";\nimport {\n  ATTRIB_POSITION,\n  ATTRIB_TEXTURE_COORD,\n  ATTRIB_TEXTURE_IDX,\n  ATTRIB_COLOR,\n  UNIFORM_SAMPLERS,\n} from \"renderer/constants\";\n\nconst createIndices = (indicesSize) => {\n  let offset = 0;\n  let indices = new Uint16Array(indicesSize);\n\n  for (let i = 0; i < indicesSize; i += 6) {\n    indices[i] = offset;\n    indices[i + 1] = offset + 1;\n    indices[i + 2] = offset + 2;\n\n    indices[i + 3] = offset;\n    indices[i + 4] = offset + 2;\n    indices[i + 5] = offset + 3;\n\n    offset += 4;\n  }\n\n  return indices;\n};\n\nexport default class Batch2D {\n  constructor(gl, shaderProgram) {\n    this.gl = gl;\n    this.shaderProgram = shaderProgram;\n    this.textures = [];\n    this.textureManager = new TextureManager();\n    this.create();\n  }\n\n  create = () => {\n    const maxSprites = 10000;\n    const floatsPerVertex = 9;\n    const bytesPerVertex = 4 * floatsPerVertex;\n    const floatsPerSprite = floatsPerVertex * 4;\n    const totalFloats = maxSprites * floatsPerSprite;\n    const indicesSize = 6 * maxSprites;\n\n    this.vertices = new Float32Array(totalFloats);\n    this.indices = createIndices(indicesSize);\n\n    this.VAO = this.gl.createVertexArray();\n    this.VBO = this.gl.createBuffer();\n    this.EBO = this.gl.createBuffer();\n\n    this.gl.bindVertexArray(this.VAO);\n\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.VBO);\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.vertices, this.gl.DYNAMIC_DRAW);\n\n    // Position\n    const locPosition = this.gl.getAttribLocation(this.shaderProgram.id, ATTRIB_POSITION);\n    this.gl.vertexAttribPointer(locPosition, 2, this.gl.FLOAT, false, bytesPerVertex, 0);\n    this.gl.enableVertexAttribArray(locPosition);\n\n    // TextureCoord\n    const locTextureCoord = this.gl.getAttribLocation(this.shaderProgram.id, ATTRIB_TEXTURE_COORD);\n    this.gl.vertexAttribPointer(locTextureCoord, 2, this.gl.FLOAT, false, bytesPerVertex, 2 * 4);\n    this.gl.enableVertexAttribArray(locTextureCoord);\n\n    // TextureIdx\n    const locTextureIdx = this.gl.getAttribLocation(this.shaderProgram.id, ATTRIB_TEXTURE_IDX);\n    this.gl.vertexAttribPointer(locTextureIdx, 1, this.gl.FLOAT, false, bytesPerVertex, 4 * 4);\n    this.gl.enableVertexAttribArray(locTextureIdx);\n\n    // Color\n    const locColor = this.gl.getAttribLocation(this.shaderProgram.id, ATTRIB_COLOR);\n    this.gl.vertexAttribPointer(locColor, 4, this.gl.FLOAT, false, bytesPerVertex, 5 * 4);\n    this.gl.enableVertexAttribArray(locColor);\n\n    this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.EBO);\n    this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER, this.indices, this.gl.STATIC_DRAW);\n\n    // Used for emplacing tiles\n    this.vertexIndex = 0;\n\n    // Used for rendering\n    this.indexCount = 0;\n  };\n\n  begin = () => {\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.VBO);\n  };\n\n  emplace = (tileValue, position, color) => {\n    const tileData = TileManagerInstance.get(tileValue);\n    if (!tileData) {\n      console.error(`Could not get tile data for tile ${tileData}`);\n      return;\n    }\n\n    let r = 0.0;\n    let g = 0.0;\n    let b = 0.0;\n    let a = 0.0;\n\n    if (color) {\n      r = color.r;\n      g = color.g;\n      b = color.b;\n      a = color.a;\n    }\n\n    let textureIdx = 0.0;\n\n    if (this.textureManager.has(tileData.tileset)) {\n      textureIdx = this.textureManager.getIndex(tileData.tileset);\n    } else {\n      this.textureManager.add(this.gl, tileData.tileset);\n      textureIdx = this.textureManager.getIndex(tileData.tileset);\n    }\n\n    // Top left\n    this.vertices[this.vertexIndex++] = position[0];\n    this.vertices[this.vertexIndex++] = position[1];\n    this.vertices[this.vertexIndex++] = tileData.uv[0][0];\n    this.vertices[this.vertexIndex++] = tileData.uv[0][1];\n    this.vertices[this.vertexIndex++] = textureIdx;\n    this.vertices[this.vertexIndex++] = r;\n    this.vertices[this.vertexIndex++] = g;\n    this.vertices[this.vertexIndex++] = b;\n    this.vertices[this.vertexIndex++] = a;\n\n    // Top right\n    this.vertices[this.vertexIndex++] = position[0] + tileData.size[0];\n    this.vertices[this.vertexIndex++] = position[1];\n    this.vertices[this.vertexIndex++] = tileData.uv[1][0];\n    this.vertices[this.vertexIndex++] = tileData.uv[1][1];\n    this.vertices[this.vertexIndex++] = textureIdx;\n    this.vertices[this.vertexIndex++] = r;\n    this.vertices[this.vertexIndex++] = g;\n    this.vertices[this.vertexIndex++] = b;\n    this.vertices[this.vertexIndex++] = a;\n\n    // Bottom right\n    this.vertices[this.vertexIndex++] = position[0] + tileData.size[0];\n    this.vertices[this.vertexIndex++] = position[1] + tileData.size[1];\n    this.vertices[this.vertexIndex++] = tileData.uv[2][0];\n    this.vertices[this.vertexIndex++] = tileData.uv[2][1];\n    this.vertices[this.vertexIndex++] = textureIdx;\n    this.vertices[this.vertexIndex++] = r;\n    this.vertices[this.vertexIndex++] = g;\n    this.vertices[this.vertexIndex++] = b;\n    this.vertices[this.vertexIndex++] = a;\n\n    // Bottom left\n    this.vertices[this.vertexIndex++] = position[0];\n    this.vertices[this.vertexIndex++] = position[1] + tileData.size[1];\n    this.vertices[this.vertexIndex++] = tileData.uv[3][0];\n    this.vertices[this.vertexIndex++] = tileData.uv[3][1];\n    this.vertices[this.vertexIndex++] = textureIdx;\n    this.vertices[this.vertexIndex++] = r;\n    this.vertices[this.vertexIndex++] = g;\n    this.vertices[this.vertexIndex++] = b;\n    this.vertices[this.vertexIndex++] = a;\n\n    this.indexCount += 6;\n  };\n\n  flush = () => {\n    this.gl.bufferSubData(this.gl.ARRAY_BUFFER, 0, this.vertices.subarray(0, this.vertexIndex));\n    this.vertexIndex = 0;\n  };\n\n  render = (shader) => {\n    if (this.indexCount === 0) {\n      return;\n    }\n\n    let idx = 0;\n    this.textureManager.map.forEach((texture) => {\n      this.gl.activeTexture(this.gl.TEXTURE0 + idx);\n      texture.bind(this.gl);\n      this.shaderProgram.setInt(`${UNIFORM_SAMPLERS}[${idx}]`, idx);\n      ++idx;\n    });\n\n    this.gl.activeTexture(this.gl.TEXTURE0);\n\n    this.gl.bindVertexArray(this.VAO);\n    this.gl.drawElements(this.gl.TRIANGLES, this.indexCount, this.gl.UNSIGNED_SHORT, 0);\n    this.indexCount = 0;\n  };\n}\n","import { mat4 } from \"gl-matrix\";\n\nconst ZOOM_MAX = 5.0;\nconst ZOOM_MIN = 0.25;\nconst ZOOM_THRESHOLD = 10;\n\nconst zoomLevels = [0.25, 0.5, 0.75, 1.0, 1.25, 1.5, 1.75];\n\nclass Camera {\n  constructor(width, height) {\n    this.width = width;\n    this.height = height;\n    this.zoomLevel = 3;\n    this.zoom = 0;\n    this.perceivedWidth = this.width;\n    this.perceivedHeight = this.height;\n    this.origin = [0.0, 0.0];\n    this.clientOrigin = [0.0, 0.0];\n    this.cameraZ = 80.0;\n    this.position = [0.0, 0.0, this.cameraZ];\n    this.near = 0.1;\n    this.far = 100.0;\n    this.projection = mat4.create();\n    this.modelView = mat4.create();\n    this.mvp = mat4.create();\n\n    mat4.translate(this.modelView, this.modelView, [0.0, 0.0, -this.cameraZ]);\n    this.calculateMvp();\n  }\n\n  setOrigin = (x, y) => {\n    this.origin = [this.position[0], this.position[1]];\n    this.clientOrigin = [x, y];\n  };\n\n  moveTo = (x, y) => {\n    this.position = [\n      this.origin[0] + (this.clientOrigin[0] - x),\n      this.origin[1] + (this.clientOrigin[1] - y),\n      this.cameraZ,\n    ];\n    this.calculateMvp();\n  };\n\n  setZoom = (zoom) => {\n    // Clamp zoom value\n    this.zoom = this.clampZoom(zoom);\n    this.calculateMvp();\n  };\n\n  applyZoom = (zoom) => {\n    this.zoom += zoom;\n\n    if (Math.abs(this.zoom) < ZOOM_THRESHOLD) {\n      return;\n    }\n\n    if (this.zoom < 0) {\n      this.zoomLevel = Math.max(0, this.zoomLevel - 1);\n    } else if (this.zoom > 0) {\n      this.zoomLevel = Math.min(zoomLevels.length - 1, this.zoomLevel + 1);\n    }\n\n    this.perceivedWidth = this.width / zoomLevels[this.zoomLevel];\n    this.perceivedHeight = this.height / zoomLevels[this.zoomLevel];\n    this.zoom = 0;\n    this.calculateMvp();\n  };\n\n  getMvp = () => {\n    return this.mvp;\n  };\n\n  getZoomLevel = () => {\n    return zoomLevels[this.zoomLevel];\n  };\n\n  calculateMvp = () => {\n    // TODO: Anchor on center when zooming\n    const computedPositionX = this.position[0] / zoomLevels[this.zoomLevel];\n    const computedPositionY = this.position[1] / zoomLevels[this.zoomLevel];\n\n    mat4.ortho(\n      this.projection,\n      computedPositionX,\n      this.perceivedWidth + computedPositionX,\n      this.perceivedHeight + computedPositionY,\n      computedPositionY,\n      this.near,\n      this.far\n    );\n\n    //mat4.ortho(this.projection,\n    //(this.width - this.perceivedWidth) + this.position[0] / zoomLevels[this.zoomLevel],\n    //this.perceivedWidth + this.position[0] / zoomLevels[this.zoomLevel],\n    //this.perceivedHeight + this.position[1] / zoomLevels[this.zoomLevel],\n    //(this.height - this.perceivedHeight) + this.position[1] / zoomLevels[this.zoomLevel],\n    //this.near,\n    //this.far);\n\n    mat4.multiply(this.mvp, this.projection, this.modelView);\n  };\n}\n\nexport default Camera;\n","import store from \"redux/store\";\nimport TilemapInstance from \"tilemap\";\nimport ShaderProgram from \"renderer/Shader\";\nimport Batch2D from \"renderer/Batch2D\";\nimport Texture from \"renderer/Texture\";\nimport Camera from \"renderer/Camera\";\nimport { UNIFORM_MVP, BATCH_VERTEX_SHADER_SOURCE, BATCH_FRAGMENT_SHADER_SOURCE } from \"renderer/constants\";\n\n// TODO: Provide a method to change tile size per layer\nconst tileSize = [32, 32];\n\nclass Renderer {\n  hasInitialized = false;\n\n  init = (gl) => {\n    this.gl = gl;\n    if (!this.gl) {\n      return;\n    }\n\n    this.gl.enable(this.gl.BLEND);\n    this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\n\n    this.shaderProgram = new ShaderProgram(this.gl, BATCH_VERTEX_SHADER_SOURCE, BATCH_FRAGMENT_SHADER_SOURCE);\n    this.shaderProgram.use();\n\n    this.camera = new Camera(this.gl.canvas.width, this.gl.canvas.height);\n    //this.camera.setPosition(100, 100);\n\n    this.shaderProgram.setMat4(UNIFORM_MVP, this.camera.getMvp());\n\n    this.batch = new Batch2D(this.gl, this.shaderProgram);\n    this.hasInitialized = true;\n  };\n\n  setClearColor = (r, g, b, a) => {\n    this.gl.clearColor(r, g, b, a);\n  };\n\n  //updateViewport = (width, height) => {\n  //this.gl.viewport(0, 0, width, height);\n  //const projectionMatrix = mat4.create();\n  //mat4.ortho(projectionMatrix, 0, width, height, 0, 0.1, 100.0);\n  //this.shaderProgram.use();\n  //this.shaderProgram.setMat4(UNIFORM_PROJECTION, projectionMatrix);\n  //}\n\n  render = () => {\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n    this.renderGrid();\n    window.requestAnimationFrame(this.render);\n  };\n\n  renderGrid = () => {\n    // Return early if the wasm module hasn't loaded yet\n    if (!TilemapInstance.hasInitialized) {\n      return;\n    }\n\n    this.shaderProgram.use();\n\n    // TODO: Get offset and zoom from camera\n    // to get the actual tiles to render from rust\n    const canvasWidth = this.gl.canvas.width;\n    const canvasHeight = this.gl.canvas.height;\n    const layersState = store.getState().layers;\n    this.shaderProgram.setMat4(UNIFORM_MVP, this.camera.getMvp());\n\n    this.batch.begin();\n\n    for (const layerName of layersState.names) {\n      const layer = layersState.layers[layerName];\n      if (!layer.visible) {\n        continue;\n      }\n\n      if (layer.id >= 0) {\n        for (let i = 0, y = 0; y < canvasHeight; i++, y += tileSize[1]) {\n          for (let j = 0, x = 0; x < canvasWidth; j++, x += tileSize[0]) {\n            const value = TilemapInstance.get(j, i, layer.id);\n\n            if (value != -1) {\n              this.batch.emplace(value, [x, y]);\n            }\n          }\n        }\n      }\n    }\n\n    this.batch.flush();\n    this.batch.render(this.shaderProgram);\n  };\n}\n\nconst RendererInstance = new Renderer();\n\nexport default RendererInstance;\n","import { useEffect, useRef } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { addLayer } from \"redux/actions\";\nimport RendererInstance from \"renderer/Renderer\";\nimport TilemapInstance from \"tilemap\";\nimport { TILEMAP_CANVAS_ID } from \"ui/constants\";\n\n// TODO: Provide a method to change tile size per layer\nconst tileSize = [32, 32];\n\nconst WebGLCanvas = () => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const dispatch = useDispatch();\n  const tilesCanvasRef = useRef();\n\n  // ====================================\n  // Logic\n  // ====================================\n  useEffect(() => {\n    if (!tilesCanvasRef.current) {\n      return;\n    }\n\n    // Update canvas sizes\n    tilesCanvasRef.current.width = tilesCanvasRef.current.clientWidth;\n    tilesCanvasRef.current.height = tilesCanvasRef.current.clientHeight;\n\n    if (!TilemapInstance.hasInitialized) {\n      // TODO: Remove dispatch from here and add a layer only if there isn't any\n      TilemapInstance.init().then(() => {\n        dispatch(\n          addLayer(\n            null,\n            0,\n            0,\n            Math.floor(tilesCanvasRef.current.width / tileSize[0]) + 1,\n            Math.floor(tilesCanvasRef.current.height / tileSize[1]) + 1\n          )\n        );\n      });\n    }\n\n    if (!RendererInstance.hasInitialized) {\n      RendererInstance.init(tilesCanvasRef.current.getContext(\"webgl2\"));\n      //RendererInstance.setClearColor(55.0 / 255.0, 65.0 / 255.0, 81.0 / 255.0, 1.0);\n      RendererInstance.setClearColor(31.0 / 255.0, 41.0 / 255.0, 55.0 / 255.0, 1.0);\n      window.requestAnimationFrame(RendererInstance.render);\n    }\n  }, [dispatch]);\n\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <canvas id={TILEMAP_CANVAS_ID} ref={tilesCanvasRef} className=\"col-span-full row-span-full z-0 w-full h-full\" />\n  );\n};\n\nexport default WebGLCanvas;\n","import { useEffect, useRef } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { selectTool } from \"redux/actions\";\nimport { getTilePositionOnClick } from \"utils/tile\";\nimport { EDITOR_CANVAS_ID } from \"ui/constants\";\nimport RendererInstance from \"renderer/Renderer\";\nimport TilemapInstance from \"tilemap\";\nimport * as tools from \"resources/tools\";\n\n// TODO: Provide a method to change tile size per layer\nconst tileSize = [32, 32];\n\nconst EditorCanvas = () => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const dispatch = useDispatch();\n  const editingCanvasRef = useRef();\n  const { selectedLayer, layers } = useSelector((state) => ({\n    selectedLayer: state.layers.selected,\n    layers: state.layers.layers,\n  }));\n  const selectedTile = useSelector((state) => state.tileset.selectedTile);\n  const selectedTool = useSelector((state) => state.canvas.selectedTool);\n\n  // ====================================\n  // Logic\n  // ====================================\n  useEffect(() => {\n    const refElement = editingCanvasRef.current;\n    if (!refElement) {\n      return;\n    }\n\n    editingCanvasRef.current.width = refElement.clientWidth;\n    editingCanvasRef.current.height = refElement.clientHeight;\n\n    // Used to allow preventing default wheel behavior on chrome\n    const cancelWheel = (event) => event.preventDefault();\n    refElement.addEventListener(\"wheel\", cancelWheel, { passive: false });\n    return () => {\n      refElement.removeEventListener(\"wheel\", cancelWheel);\n    };\n  }, []);\n\n  useEffect(() => {\n    const panToolStartHandler = ({ key }) => {\n      if (key === \" \") {\n        dispatch(selectTool(tools.PAN_TOOL));\n      }\n    };\n\n    // TODO: Create a stack of tools to be able to get back\n    // to the previous tool instead of the default one\n    const panToolEndHandler = ({ key }) => {\n      if (key === \" \") {\n        dispatch(selectTool(tools.DEFAULT_TOOL));\n      }\n    };\n\n    window.addEventListener(\"keydown\", panToolStartHandler);\n    window.addEventListener(\"keyup\", panToolEndHandler);\n    return () => {\n      window.removeEventListener(\"keydown\", panToolStartHandler);\n      window.removeEventListener(\"keyup\", panToolEndHandler);\n    };\n  }, [dispatch]);\n\n  const handleOneTimeTools = (e) => {\n    switch (selectedTool) {\n      case tools.FILL_TOOL: {\n        const zoomLevel = RendererInstance.camera.getZoomLevel();\n        const position = getTilePositionOnClick(\n          e,\n          [tileSize[0] * zoomLevel, tileSize[1] * zoomLevel],\n          RendererInstance.camera.position\n        );\n        const layerId = layers[selectedLayer].id;\n\n        TilemapInstance.fill(...position, selectedTile, layerId);\n        break;\n      }\n\n      case tools.PAN_TOOL: {\n        RendererInstance.camera.setOrigin(e.clientX, e.clientY);\n        break;\n      }\n\n      default:\n        break;\n    }\n  };\n\n  const handleContinuousTools = (e) => {\n    const zoomLevel = RendererInstance.camera.getZoomLevel();\n    const position = getTilePositionOnClick(\n      e,\n      [tileSize[0] * zoomLevel, tileSize[1] * zoomLevel],\n      RendererInstance.camera.position\n    );\n    const layerId = layers[selectedLayer].id;\n\n    switch (selectedTool) {\n      case tools.DEFAULT_TOOL: {\n        break;\n      }\n\n      case tools.PLACEMENT_TOOL: {\n        if (selectedTile !== null && selectedTile !== undefined && selectedTile !== -1) {\n          TilemapInstance.set(...position, selectedTile, layerId);\n        }\n        break;\n      }\n\n      case tools.PAN_TOOL: {\n        if (e.clientX == 0 || e.clientY == 0) {\n          break;\n        }\n\n        RendererInstance.camera.moveTo(e.clientX, e.clientY);\n        break;\n      }\n\n      default:\n        break;\n    }\n  };\n\n  const handleMouseDown = (e) => {\n    handleOneTimeTools(e);\n    handleContinuousTools(e);\n  };\n\n  const handleDrag = (e) => {\n    handleContinuousTools(e);\n  };\n\n  const handleWheel = (e) => {\n    if (!e.altKey) {\n      return;\n    }\n\n    RendererInstance.camera.applyZoom(e.deltaY);\n  };\n\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <canvas\n      id={EDITOR_CANVAS_ID}\n      ref={editingCanvasRef}\n      onWheel={handleWheel}\n      onMouseDown={handleMouseDown}\n      onDrag={handleContinuousTools}\n      draggable=\"true\"\n      className=\"col-span-full row-span-full z-10 w-full h-full\"\n    />\n  );\n};\n\nexport default EditorCanvas;\n","import Toolbar from \"ui/canvas/Toolbar\";\nimport WebGLCanvas from \"ui/canvas/WebGLCanvas\";\nimport EditorCanvas from \"ui/canvas/EditorCanvas\";\n\nconst Canvas = () => {\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <div className=\"col-span-3 flex flex-col\">\n      <Toolbar />\n      <section className=\"grid flex-1 bg-gray-600\">\n        <EditorCanvas />\n        <WebGLCanvas />\n      </section>\n    </div>\n  );\n};\n\nexport default Canvas;\n","import { NavLink } from \"react-router-dom\";\nimport Icon from \"@mdi/react\";\n\nconst TabButton = ({ iconPath, routerPath }) => {\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <NavLink to={routerPath} activeClassName=\"text-indigo-200 bg-indigo-900\">\n      <button className=\"px-2 py-3 hover:text-indigo-400 hover:bg-indigo-900\" data-tip data-for={routerPath}>\n        <Icon path={iconPath} size={1.2} />\n      </button>\n    </NavLink>\n  );\n};\n\nexport default TabButton;\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"mask\", {\n  id: \"path-1-outside-1\",\n  maskUnits: \"userSpaceOnUse\",\n  x: 0.745167,\n  y: 0.745174,\n  width: 271.529,\n  height: 271.529,\n  fill: \"black\"\n}, /*#__PURE__*/React.createElement(\"rect\", {\n  fill: \"white\",\n  x: 0.745167,\n  y: 0.745174,\n  width: 271.529,\n  height: 271.529\n}), /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  clipRule: \"evenodd\",\n  d: \"M46 136.51L91.2548 91.2548L91.9619 90.5477L136.51 46L181.057 90.5477L181.764 91.2548L227.019 136.51L181.764 181.765L136.51 136.51L91.2548 181.765L46 136.51Z\"\n}));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  clipRule: \"evenodd\",\n  d: \"M46 136.51L91.2548 91.2548L91.9619 90.5477L136.51 46L181.057 90.5477L181.764 91.2548L227.019 136.51L181.764 181.765L136.51 136.51L91.2548 181.765L46 136.51Z\",\n  fill: \"#48CAAB\"\n});\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M46 136.51L23.3726 113.882L0.745167 136.51L23.3726 159.137L46 136.51ZM136.51 46L159.137 23.3726L136.51 0.745174L113.882 23.3726L136.51 46ZM227.019 136.51L249.647 159.137L272.274 136.51L249.647 113.882L227.019 136.51ZM181.764 181.765L159.137 204.392L181.764 227.019L204.392 204.392L181.764 181.765ZM136.51 136.51L159.137 113.882L136.51 91.2548L113.882 113.882L136.51 136.51ZM91.2548 181.765L68.6274 204.392L91.2548 227.019L113.882 204.392L91.2548 181.765ZM68.6274 68.6274L23.3726 113.882L68.6274 159.137L113.882 113.882L68.6274 68.6274ZM69.3345 67.9203L68.6274 68.6274L113.882 113.882L114.589 113.175L69.3345 67.9203ZM113.882 23.3726L69.3345 67.9203L114.589 113.175L159.137 68.6274L113.882 23.3726ZM203.685 67.9203L159.137 23.3726L113.882 68.6274L158.43 113.175L203.685 67.9203ZM158.43 113.175L159.137 113.882L204.392 68.6274L203.685 67.9203L158.43 113.175ZM159.137 113.882L204.392 159.137L249.647 113.882L204.392 68.6274L159.137 113.882ZM204.392 113.882L159.137 159.137L204.392 204.392L249.647 159.137L204.392 113.882ZM204.392 159.137L159.137 113.882L113.882 159.137L159.137 204.392L204.392 159.137ZM113.882 204.392L159.137 159.137L113.882 113.882L68.6274 159.137L113.882 204.392ZM23.3726 159.137L68.6274 204.392L113.882 159.137L68.6274 113.882L23.3726 159.137Z\",\n  fill: \"#111827\",\n  mask: \"url(#path-1-outside-1)\"\n});\n\nvar _ref5 = /*#__PURE__*/React.createElement(\"rect\", {\n  x: 91.2548,\n  y: 181.764,\n  width: 64,\n  height: 64,\n  transform: \"rotate(-45 91.2548 181.764)\",\n  fill: \"#FBFDFC\",\n  stroke: \"#111827\",\n  strokeWidth: 32\n});\n\nfunction SvgLogo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 273 250\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2, _ref3, _ref4, _ref5);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgLogo);\nexport default __webpack_public_path__ + \"static/media/logo.a0456237.svg\";\nexport { ForwardRef as ReactComponent };","import ReactTooltip from \"react-tooltip\";\nimport TabButton from \"ui/sidebar/TabButton\";\nimport tooltips from \"resources/tooltips\";\nimport * as tabs from \"resources/tabs\";\nimport { dividerBorderColor } from \"resources/styles\";\nimport { TOOLTIP_DELAY } from \"ui/constants\";\nimport { mdiMap, mdiViewModule, mdiContentSave, mdiUpload, mdiHelpCircleOutline, mdiCog } from \"@mdi/js\";\nimport { ReactComponent as Logo } from 'resources/logo.svg';\n\nconst TabSelector = () => {\n  // ====================================\n  // Render\n  // ====================================\n  const sectionsData = [\n    { path: tabs.TAB_TILES, icon: mdiViewModule },\n    { path: tabs.TAB_MAP, icon: mdiMap },\n    { path: tabs.TAB_IMPORT, icon: mdiUpload },\n    { path: tabs.TAB_EXPORT, icon: mdiContentSave },\n    { path: tabs.TAB_SETTINGS, icon: mdiCog },\n    { path: tabs.TAB_HELP, icon: mdiHelpCircleOutline },\n  ];\n\n  const sections = sectionsData.map((section) => (\n    <div key={section.path} className=\"flex\" data-testid={section.path}>\n      <TabButton routerPath={section.path} iconPath={section.icon} />\n      <ReactTooltip id={section.path} place=\"right\" effect=\"solid\" delayShow={TOOLTIP_DELAY}>\n        {tooltips.get(section.path)}\n      </ReactTooltip>\n    </div>\n  ));\n\n  return (\n    <div className={`flex flex-col justify-end bg-black border-r ${dividerBorderColor}`}>\n      <div className='w-full flex-1'>\n        <div className='w-full px-2 py-4'>\n          <Logo />\n        </div>\n      </div>\n      {sections}\n    </div>);\n};\n\nexport default TabSelector;\n","import { dividerBorderColor, titleBarHeight } from \"resources/styles.js\";\n\nconst Tab = ({ children, title }) => {\n  return (\n    <div className=\"flex-1 flex flex-col text-sm\">\n      <h2 className={`${titleBarHeight} bg-black border-b ${dividerBorderColor} px-2 flex items-center`}>{title}</h2>\n      {children}\n    </div>\n  );\n};\n\nexport default Tab;\n","export const getLayersState = (state) => state.layers;\n\nexport const getLayersNames = (state) => (getLayersState(state) ? getLayersState(state).names : []);\n\nexport const getLayerByName = (state, name) =>\n  getLayersState(state) ? { ...getLayersState(state).layers[name], name } : {};\n\nexport const getLayers = (state) => getLayersNames(state).map((name) => getLayerByName(state, name));\n\nexport const getLayersByAddedTime = (state) => getLayers(state).reverse();\n\nexport const getVisibleLayers = (state) => {\n  const layersState = getLayersState(state);\n  return layersState.names.filter((name) => layersState.layers[name].visible).reverse();\n};\n","import { useState } from \"react\";\nimport { Collapse } from \"react-collapse\";\nimport Icon from \"@mdi/react\";\nimport { mdiMenuDown, mdiMenuRight } from \"@mdi/js\";\nimport { dividerBorderColor, titleBarHeight } from \"resources/styles.js\";\n\nconst CollapseSection = ({ title, children }) => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const [open, setOpen] = useState(true);\n  const icon = open ? mdiMenuDown : mdiMenuRight;\n  const sectionClass = open ? `border-b ${dividerBorderColor}` : \"\";\n\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <div className={sectionClass}>\n      <div\n        className={`text-xs flex items-center hover:bg-gray-800 cursor-pointer border-b ${dividerBorderColor} ${titleBarHeight}`}\n        onDoubleClick={(e) => setOpen(!open)}\n      >\n        <Icon path={icon} size={1} />\n\n        <h1 className=\"select-none\">{title}</h1>\n      </div>\n\n      <Collapse isOpened={open}>\n        <div className=\"text-xs text-gray-300 px-2 py-2\">{children}</div>\n      </Collapse>\n    </div>\n  );\n};\n\nexport default CollapseSection;\n","import { useDispatch } from \"react-redux\";\nimport { Draggable } from \"react-beautiful-dnd\";\nimport { selectLayer, toggleLayerVisibility } from \"redux/actions\";\nimport { mdiEye, mdiEyeOffOutline } from \"@mdi/js\";\nimport Icon from \"@mdi/react\";\nimport * as testIds from \"resources/testIds\";\n\nconst LayerItem = ({ layer, index, isSelected }) => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const dispatch = useDispatch();\n\n  // ====================================\n  // Logic\n  // ====================================\n  const handleLayerClick = () => {\n    dispatch(selectLayer(layer.name));\n  };\n\n  const handleEyeClick = () => {\n    dispatch(toggleLayerVisibility(layer.name));\n  };\n\n  // ====================================\n  // Render\n  // ====================================\n  const icon = layer.visible ? mdiEye : mdiEyeOffOutline;\n  const selectedClassName = isSelected ? \"bg-gray-700 hover:text-white\" : \"bg-gray-800 hover:bg-gray-900\";\n  const visibilityTestId = layer.visible ? testIds.LAYER_VISIBLE : testIds.LAYER_HIDDEN;\n\n  return (\n    <div className=\"border-t border-gray-700 first:border-t-0\">\n      <Draggable draggableId={layer.name} index={index}>\n        {(provided, snapshop) => {\n          const style = {\n            cursor: \"default\",\n            ...provided.draggableProps.style,\n          };\n\n          return (\n            <li\n              className={`flex items-center select-none ${selectedClassName}`}\n              ref={provided.innerRef}\n              {...provided.draggableProps}\n              {...provided.dragHandleProps}\n              style={style}\n              data-testid={visibilityTestId}\n            >\n              <span className=\"flex-1 pl-4 py-1\" onClick={handleLayerClick}>\n                {layer.name}\n              </span>\n              <span\n                onClick={handleEyeClick}\n                className=\"cursor-pointer pr-4 py-1 hover:text-white\"\n                data-testid={testIds.HIDE_LAYER_BUTTON}\n              >\n                <Icon path={icon} size={0.6} />\n              </span>\n            </li>\n          );\n        }}\n      </Draggable>\n    </div>\n  );\n};\n\nexport default LayerItem;\n","import { useDispatch } from \"react-redux\";\nimport { addLayer, deleteLayer } from \"redux/actions\";\nimport { mdiDelete, mdiPlaylistPlus } from \"@mdi/js\";\nimport Icon from \"@mdi/react\";\nimport * as testIds from \"resources/testIds\";\n\nconst LayerListFooter = ({ selectedLayer }) => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const dispatch = useDispatch();\n\n  // ====================================\n  // Logic\n  // ====================================\n  const handleAddClick = () => {\n    dispatch(addLayer());\n  };\n\n  const handleDeleteClick = () => {\n    dispatch(deleteLayer(selectedLayer));\n  };\n\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <div className=\"flex items-center justify-start mt-1\">\n      <button onClick={handleAddClick} data-testid={testIds.ADD_LAYER_BUTTON} className=\"hover:text-white\">\n        <Icon path={mdiPlaylistPlus} size={0.7} />\n      </button>\n      <button onClick={handleDeleteClick} data-testid={testIds.DELETE_LAYER_BUTTON} className=\"hover:text-white\">\n        <Icon path={mdiDelete} size={0.65} />\n      </button>\n    </div>\n  );\n};\n\nexport default LayerListFooter;\n","import { useSelector, useDispatch } from \"react-redux\";\nimport { getLayersByAddedTime } from \"redux/selectors\";\nimport CollapseSection from \"ui/common/CollapseTab\";\nimport LayerListItem from \"ui/sidebar/tileset/LayerListItem\";\nimport LayerListFooter from \"ui/sidebar/tileset/LayerListFooter\";\nimport { DragDropContext, Droppable } from \"react-beautiful-dnd\";\nimport { selectLayer, moveLayer } from \"redux/actions\";\n\nconst LayerList = () => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const dispatch = useDispatch();\n\n  // ====================================\n  // Logic\n  // ====================================\n  const { selectedLayer, layers } = useSelector((state) => ({\n    selectedLayer: state.layers.selected,\n    layers: getLayersByAddedTime(state),\n  }));\n\n  const handleLayerBeforeDragStart = (e) => {\n    dispatch(selectLayer(e.draggableId));\n  };\n\n  const handleLayerDragEnd = (e) => {\n    dispatch(moveLayer(e.draggableId, layers.length - e.destination.index - 1));\n  };\n\n  // ====================================\n  // Render\n  // ====================================\n  const layerComponents = layers.map((l, i) => (\n    <LayerListItem key={l.name} index={i} layer={l} isSelected={l.name === selectedLayer} />\n  ));\n\n  const dndArea =\n    layers && layers.length ? (\n      <DragDropContext onDragEnd={handleLayerDragEnd} onBeforeDragStart={handleLayerBeforeDragStart}>\n        <Droppable droppableId=\"layers\">\n          {(provided) => (\n            <ul {...provided.droppableProps} ref={provided.innerRef} className=\"border rounded-sm border-gray-700\">\n              {layerComponents}\n              {provided.placeholder}\n            </ul>\n          )}\n        </Droppable>\n      </DragDropContext>\n    ) : (\n      <div />\n    );\n\n  return (\n    <CollapseSection title=\"Layers\">\n      {dndArea}\n      <LayerListFooter selectedLayer={selectedLayer} />\n    </CollapseSection>\n  );\n};\n\nexport default LayerList;\n","import { useDispatch } from \"react-redux\";\nimport { deleteTileset } from \"redux/actions\";\nimport { mdiDelete, mdiCog } from \"@mdi/js\";\nimport Icon from \"@mdi/react\";\nimport * as testIds from \"resources/testIds\";\n\nconst TilesetFooter = ({ selectedTileset }) => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const dispatch = useDispatch();\n\n  // ====================================\n  // Logic\n  // ====================================\n  const handleSettingsClick = () => {};\n\n  const handleDeleteClick = () => {\n    dispatch(deleteTileset(selectedTileset));\n  };\n\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <div className=\"flex items-center justify-start\">\n      <button onClick={handleSettingsClick} className=\"hover:text-white\">\n        <Icon path={mdiCog} size={0.6} />\n      </button>\n      <button onClick={handleDeleteClick} className=\"hover:text-white\">\n        <Icon path={mdiDelete} size={0.65} />\n      </button>\n    </div>\n  );\n};\n\nexport default TilesetFooter;\n","import { useEffect, useState, useRef } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { getTextureData, hasTexture } from \"idbTextureStore\";\nimport { selectTile } from \"redux/actions\";\nimport { getTilePositionOnClick } from \"utils/tile\";\nimport TilesetFooter from \"ui/sidebar/tileset/TilesetFooter\";\nimport { GRID_COLOR, GRID_CANVAS_ID, TILESET_CANVAS_ID, SELECTED_TILE_COLOR_OVERLAY } from \"ui/constants\";\n\nconst tileSize = [32, 32];\n\nconst drawGridLines = (canvas, tileDimensions) => {\n  const context = canvas.getContext(\"2d\");\n  context.strokeStyle = GRID_COLOR;\n  context.lineWidth = 1;\n\n  // Draw horizontal lines\n  for (let j = tileDimensions[0]; j < canvas.height; j += tileDimensions[0]) {\n    context.beginPath();\n    context.moveTo(0, j + 0.5);\n    context.lineTo(canvas.width, j + 0.5);\n    context.stroke();\n  }\n\n  // Draw vertical lines\n  for (let i = tileDimensions[1]; i < canvas.width; i += tileDimensions[1]) {\n    context.beginPath();\n    context.moveTo(i + 0.5, 0);\n    context.lineTo(i + 0.5, canvas.height);\n    context.stroke();\n  }\n};\n\nconst TilesetPreview = () => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const dispatch = useDispatch();\n  const selectedTileset = useSelector((state) => state.tileset.selectedTileset);\n  const [selectedTile, setSelectedTile] = useState([-1, -1]);\n  const [tilesetIndex, setTilesetIndex] = useState(0);\n  const tilegridCanvasRef = useRef(null);\n  const tilesetCanvasRef = useRef(null);\n\n  // ====================================\n  // Logic\n  // ====================================\n  // Load a new tileset to the preview\n  useEffect(() => {\n    if (!selectedTileset || selectedTileset === \"\" || !tilegridCanvasRef.current || !tilesetCanvasRef.current) {\n      return;\n    }\n\n    const tilesetCanvas = tilesetCanvasRef.current;\n    const tilegridCanvas = tilegridCanvasRef.current;\n\n    // Add image to canvas\n    getTextureData(selectedTileset).then((data) => {\n      const reader = new FileReader();\n\n      reader.onload = (e) => {\n        const image = new Image();\n        image.onload = () => {\n          tilesetCanvas.width = image.width;\n          tilesetCanvas.height = image.height;\n\n          tilegridCanvas.width = image.width;\n          tilegridCanvas.height = image.height;\n\n          const tilesetContext = tilesetCanvas.getContext(\"2d\");\n          tilesetContext.drawImage(image, 0, 0);\n          drawGridLines(tilesetCanvas, tileSize);\n          setTilesetIndex(data.tilesetIndex);\n        };\n        image.src = e.target.result;\n      };\n      reader.readAsDataURL(data.file);\n    });\n  }, [selectedTileset]);\n\n  // Draw highlight on selected tile\n  useEffect(() => {\n    if (!tilegridCanvasRef.current) {\n      return;\n    }\n\n    const canvas = tilegridCanvasRef.current;\n    const context = canvas.getContext(\"2d\");\n    // Draw square on selected tile\n    context.fillStyle = SELECTED_TILE_COLOR_OVERLAY;\n    context.clearRect(0, 0, canvas.width, canvas.height);\n    context.fillRect(\n      selectedTile[0] * tileSize[0] + 1,\n      selectedTile[1] * tileSize[1] + 1,\n      tileSize[0] - 1,\n      tileSize[1] - 1\n    );\n  }, [selectedTile]);\n\n  const onSelectTile = (e) => {\n    const tilePos = getTilePositionOnClick(e, tileSize);\n    const tileIndex = tilesetIndex + tilePos[1] * Math.floor(e.target.width / tileSize[0]) + tilePos[0];\n    dispatch(selectTile(tileIndex));\n    setSelectedTile(tilePos);\n  };\n\n  // ====================================\n  // Render\n  // ====================================\n  const tilesetPreview =\n    selectedTileset === \"\" ? (\n      <div />\n    ) : (\n      <>\n        <div className=\"max-h-40 max-w-full overflow-scroll border inline-block rounded-sm mt-2\">\n          <div className=\"grid\">\n            <canvas\n              id={GRID_CANVAS_ID}\n              onMouseUp={onSelectTile}\n              ref={tilegridCanvasRef}\n              className=\"col-span-full row-span-full z-10 overflow-hidden\"\n            />\n            <canvas\n              id={TILESET_CANVAS_ID}\n              ref={tilesetCanvasRef}\n              className=\"col-span-full row-span-full z-0 overflow-hidden\"\n            />\n          </div>\n        </div>\n        <TilesetFooter selectedTileset={selectedTileset} />\n      </>\n    );\n\n  return tilesetPreview;\n};\n\nexport default TilesetPreview;\n","import { SELECT_TAG } from \"resources/testIds\";\n\nconst Select = ({ value, options, onChange }) => {\n  return (\n    <select\n      className=\"text-gray-400 w-full px-1 py-1 bg-gray-800 hover:bg-gray-700 hover:text-white border border-gray-700 rounded-sm\"\n      value={value}\n      onChange={onChange}\n      data-testid={SELECT_TAG}\n    >\n      {options}\n    </select>\n  );\n};\n\nexport default Select;\n","import { useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { selectTileset } from \"redux/actions\";\nimport { LOCAL_STORAGE_LAST_SELECTED_TILESET } from \"ui/constants\";\nimport Select from \"ui/common/Select\";\n\nconst TilesetSelector = () => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const dispatch = useDispatch();\n  const { selectedTileset, tilesetNames } = useSelector((state) => state.tileset);\n\n  // ====================================\n  // Logic\n  // ====================================\n  // Get last tileset used from localStorage\n  useEffect(() => {\n    const lastSelectedTileset = localStorage.getItem(LOCAL_STORAGE_LAST_SELECTED_TILESET);\n\n    // TODO: Check if tileset exists\n    if (lastSelectedTileset && lastSelectedTileset !== \"\") {\n      dispatch(selectTileset(lastSelectedTileset));\n    } else {\n      localStorage.setItem(LOCAL_STORAGE_LAST_SELECTED_TILESET, \"\");\n    }\n  }, [dispatch]);\n\n  const onOptionSelected = (e) => {\n    const name = e.target.value;\n    localStorage.setItem(LOCAL_STORAGE_LAST_SELECTED_TILESET, name);\n    dispatch(selectTileset(name));\n  };\n\n  // ====================================\n  // Render\n  // ====================================\n  const options = [];\n  for (const value of tilesetNames) {\n    options.push(\n      <option value={value} key={value} data-testid={value}>\n        {value}\n      </option>\n    );\n  }\n\n  return tilesetNames.length > 0 && <Select value={selectedTileset} options={options} onChange={onOptionSelected} />;\n};\n\nexport default TilesetSelector;\n","const Button = ({ text, onClick }) => {\n  return (\n    <div\n      className=\"cursor-pointer block bg-indigo-700 hover:bg-indigo-800 active:bg-indigo-900 px-1 py-2 flex items-center text-center rounded-sm w-full\"\n      onClick={onClick}\n    >\n      <p className=\"flex-1 text-white\">{text}</p>\n    </div>\n  );\n};\n\nexport default Button;\n","import Button from \"ui/common/Button\";\n\nconst FileInput = ({ title, onUpload }) => {\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <div>\n      <input\n        type=\"file\"\n        name=\"tilesetFile\"\n        id=\"tilesetFile\"\n        min=\"1\"\n        max=\"100\"\n        value=\"\"\n        onChange={onUpload}\n        style={{ width: \"0.1px\", height: \"0.1px\", opacity: 0, overflow: \"hidden\", position: \"absolute\", zIndex: \"-1\" }}\n      />\n      <label htmlFor=\"tilesetFile\" className=\"block \">\n        <Button text=\"Choose a file...\" />\n      </label>\n    </div>\n  );\n};\n\nexport default FileInput;\n","import { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { addTileset, loadExistingTilesets } from \"redux/actions\";\nimport { setTextureData, getTextureNames, hasTexture } from \"idbTextureStore\";\nimport LayerList from \"ui/sidebar/tileset/LayerList\";\nimport TilesetPreview from \"ui/sidebar/tileset/TilesetPreview\";\nimport TilesetSelector from \"ui/sidebar/tileset/TilesetSelector\";\nimport TileManagerInstance from \"renderer/TileManager\";\nimport CollapseSection from \"ui/common/CollapseTab\";\nimport FileInput from \"ui/common/FileInput\";\nimport { ADD_TILESET_TITLE } from \"ui/constants\";\n\nconst TilesetManager = () => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const dispatch = useDispatch();\n  const tilesetNames = useSelector((state) => state.tileset.tilesetNames);\n  const hasLoadedTextures = useSelector((state) => state.tileset.hasLoadedTextures);\n\n  // ====================================\n  // Logic\n  // ====================================\n  // Load existing tilesets\n  useEffect(() => {\n    getTextureNames().then((textures) => {\n      dispatch(loadExistingTilesets(textures));\n    }); // eslint-disable-next-line\n  }, []);\n\n  const onTilesetUpload = async (event) => {\n    // Return if file is invalid\n    if (event.target.files.length <= 0 || !event.target.files[0]) {\n      return;\n    }\n\n    dispatch(addTileset(event.target.files[0].name, event.target.files[0]));\n  };\n\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <CollapseSection title=\"Tileset\">\n      {hasLoadedTextures ? (\n        <>\n          <TilesetSelector />\n          <div className=\"mt-2\">\n            <FileInput title={ADD_TILESET_TITLE} onUpload={(e) => onTilesetUpload(e)} />\n          </div>\n          <TilesetPreview />\n        </>\n      ) : (\n        <div />\n      )}\n    </CollapseSection>\n  );\n};\n\nexport default TilesetManager;\n","import Tab from \"ui/common/Tab\";\nimport LayerList from \"ui/sidebar/tileset/LayerList\";\nimport TilesetSettings from \"ui/sidebar/tileset/TilesetSettings\";\n\nconst Edit = () => {\n  return (\n    <Tab title=\"Edit\">\n      <LayerList />\n      <TilesetSettings />\n    </Tab>\n  );\n};\n\nexport default Edit;\n","export default function SliderInput(props) {\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <div>\n      <p>\n        <strong>{props.title}</strong>\n      </p>\n      <span>{props.value}px</span>\n      <input type=\"range\" min=\"1\" max=\"100\" value={props.value} onChange={props.onChange} />\n    </div>\n  );\n}\n","import { useState } from \"react\";\nimport Tab from \"ui/common/Tab\";\nimport Slider from \"ui/common/SliderInput\";\n\nconst MapSettings = (props) => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const [tileSize, setTileSize] = useState(32);\n\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <Tab title=\"Map Settings\">\n      <Slider title=\"Tile size\" onChange={(e) => setTileSize(e.target.value)} value={tileSize} />\n    </Tab>\n  );\n};\n\nexport default MapSettings;\n","import Tab from \"ui/common/Tab\";\n\nconst ImportSettings = () => {\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <Tab title=\"Import\">\n      <h3>Import</h3>\n    </Tab>\n  );\n};\n\nexport default ImportSettings;\n","import * as formats from \"resources/formats\";\nimport Select from \"ui/common/Select\";\n\nconst FormatSelector = ({ format, onOptionSelected }) => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const formatsArray = [formats.FORMAT_JSON, formats.FORMAT_TMX];\n\n  // ====================================\n  // Render\n  // ====================================\n  const formatOptions = formatsArray.map((format) => (\n    <option key={format} value={format}>\n      {format}\n    </option>\n  ));\n\n  return <Select value={format} options={formatOptions} onChange={onOptionSelected} />;\n};\n\nexport default FormatSelector;\n","import { useState } from \"react\";\nimport Tab from \"ui/common/Tab\";\nimport * as formats from \"resources/formats\";\nimport TilemapInstance from \"tilemap\";\nimport FormatSelector from \"ui/sidebar/export/FormatSelector\";\nimport Button from \"ui/common/Button\";\n\nconst ExportSettings = () => {\n  // ====================================\n  // Initialize\n  // ====================================\n  const [format, setFormat] = useState(formats.FORMAT_JSON);\n\n  // ====================================\n  // Logic\n  // ====================================\n  const onOptionSelected = (e) => {\n    setFormat(e.target.value);\n  };\n\n  const handleExport = async () => {\n    const rawData = await TilemapInstance.export(format);\n    const filename = \"tilemap.\" + format;\n    const blob = new Blob([rawData], { type: \"application/json\" });\n    const a = document.createElement(\"a\");\n\n    a.href = URL.createObjectURL(blob);\n    a.download = filename;\n    a.click();\n  };\n\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <Tab title=\"Export Map\">\n      <FormatSelector format={format} onOptionSelected={onOptionSelected} />\n      <Button text=\"Export\" onClick={handleExport} />\n    </Tab>\n  );\n};\n\nexport default ExportSettings;\n","import Tab from \"ui/common/Tab\";\n\nconst ProjectSettings = () => {\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <Tab title=\"Project Settings\">\n      <label htmlFor=\"show-grid\">Show grid</label>\n      <input type=\"checkbox\" name=\"show-grid\" />\n    </Tab>\n  );\n};\n\nexport default ProjectSettings;\n","import Tab from \"ui/common/Tab\";\n\nconst Help = () => {\n  // ====================================\n  // Render\n  // ====================================\n  return <Tab title=\"Help\"></Tab>;\n};\n\nexport default Help;\n","import TabSelector from \"ui/sidebar/TabSelector\";\nimport Edit from \"ui/sidebar/tileset/Edit\";\nimport MapSettings from \"ui/sidebar/map/MapSettings\";\nimport ImportSettings from \"ui/sidebar/import/ImportSettings\";\nimport ExportSettings from \"ui/sidebar/export/ExportSettings\";\nimport ProjectSettings from \"ui/sidebar/project/ProjectSettings\";\nimport Help from \"ui/sidebar/Help\";\nimport { Switch, Route } from \"react-router-dom\";\nimport { dividerBorderColor } from \"resources/styles\";\nimport * as tabs from \"resources/tabs\";\n\nconst Sidebar = () => {\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <aside className={`flex flex-row bg-gray-900 border-r border-b ${dividerBorderColor}`}>\n      <TabSelector />\n      <Switch>\n        <Route path={`/${tabs.TAB_TILES}`}>\n          <Edit />\n        </Route>\n\n        <Route path={`/${tabs.TAB_MAP}`}>\n          <MapSettings />\n        </Route>\n\n        <Route path={`/${tabs.TAB_IMPORT}`}>\n          <ImportSettings />\n        </Route>\n\n        <Route path={`/${tabs.TAB_EXPORT}`}>\n          <ExportSettings />\n        </Route>\n\n        <Route path={`/${tabs.TAB_SETTINGS}`}>\n          <ProjectSettings />\n        </Route>\n\n        <Route path={`/${tabs.TAB_HELP}`}>\n          <Help />\n        </Route>\n      </Switch>\n    </aside>\n  );\n};\n\nexport default Sidebar;\n","import Canvas from \"ui/canvas/Canvas\";\nimport Sidebar from \"ui/sidebar/Sidebar\";\nimport { HashRouter } from \"react-router-dom\";\nimport { dividerBorderColor } from \"resources/styles\";\n\nconst App = () => {\n  // ====================================\n  // Render\n  // ====================================\n  return (\n    <div\n      className={`h-screen w-screen flex flex-col text-gray-50 bg-gray-900 border-l border-t ${dividerBorderColor} text-gray-100`}\n    >\n      <main className=\"flex-1 grid grid-cols-4\">\n        <HashRouter>\n          <Sidebar />\n        </HashRouter>\n        <Canvas />\n      </main>\n    </div>\n  );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport App from \"ui/App\";\nimport store from \"redux/store\";\n\nimport \"index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}